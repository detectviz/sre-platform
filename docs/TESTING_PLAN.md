# SRE 平台 - 最終驗收測試計畫 (Final Acceptance Test Plan)

## 1. 總覽 (Overview)
本文件旨在定義 SRE 平台在完成所有主要功能開發（Agent A-F 的任務）後的最終全面測試流程。此計畫的目的是確保平台的功能完整性、效能穩定性、使用者體驗一致性及架構穩健性，以達到可交付的標準。

---

## 2. 環境與資料準備 (Environment & Data Preparation)

### 2.1. 環境啟動
- **前置條件**: 確保本機 Docker 環境已正確安裝與配置。
- **步驟**:
  1. 執行 `make start` 或 `docker-compose up -d` 指令。
  2. 確認 Mock Server 容器正常運行於 `http://localhost:8080`。
  3. 確認 Frontend 服務正常運行於 `http://localhost:5174`。
- **驗證**: 瀏覽器開啟前端網址，應能成功看到登入頁面。

### 2.2. 測試資料準備
- **目的**: 在 `mock-server/db.json` 中準備豐富且多樣化的測試資料，以模擬真實世界的複雜場景。
- **資料集要求**:
  - **Events**:
    - 至少 500+ 筆事件資料。
    - 包含所有嚴重等級 (`CRITICAL`, `WARNING`, `INFO`) 和狀態 (`FIRING`, `ACKNOWLEDGED`, `RESOLVED`)。
    - 包含至少 5 組「告警風暴」事件（`storm_group` 欄位相同）。
    - 事件的 `tags` 需涵蓋多種 `environment` 和 `service`。
  - **Resources**:
    - 至少 200+ 筆資源資料。
    - 涵蓋所有資源類型 (`DATABASE`, `SERVICE`, `CACHE`, `LOAD_BALANCER` 等)。
    - 資源需與事件和資源群組關聯。
  - **Users / Teams / Roles**:
    - 至少 10+ 位使用者、5+ 個團隊、5+ 種角色，並建立彼此間的關聯。
  - **其他**: `incident_rules`, `recurring_silence_rules`, `notification_channels` 等都需要有至少 5-10 筆初始資料。

---

## 3. 功能測試 (Functional Testing)
此階段旨在驗證所有功能模組是否符合 `pages.md` 和 `TODO.md` 中的規格。

### 3.1. 端對端SRE工作流程測試
- **場景**: 模擬一位 SRE 工程師的日常事件處理流程。
  1. **[發現]** 一個 `CRITICAL` 等級的資料庫 CPU 過高事件 (`evt_db_cpu`) 出現在「事件列表」中。
  2. **[分析]** 點擊該事件，打開「事件詳情」彈窗。
     - **[驗證]** 確認「基本資訊」頁籤顯示的摘要、資源、標籤等資訊正確。
     - **[驗證]** 切換到「處理歷史」頁籤，能看到事件觸發的系統日誌。
     - **[驗證]** 切換到「關聯事件」頁籤，能看到其他相關的告警。
     - **[驗證]** 點擊「AI 分析」按鈕，能看到 AI 提供的可能原因與建議。
  3. **[行動]** 在「事件詳情」彈窗中，點擊「標記已確認」按鈕，將事件狀態更新為 `ACKNOWLEDGED`。
  4. **[降噪]** 由於正在進行手動修復，點擊「建立靜音」按鈕。
     - **[驗證]** `CreateSilenceModal` 成功彈出，並預填了事件的匹配標籤。
     - **[驗證]** 選擇「1 小時」時長，並填寫「原因」後，點擊「建立靜音」。
     - **[驗證]** API 呼叫成功，且事件列表中的該事件狀態變為 `SILENCED`。
  5. **[追溯]** 導航至「靜音規則」頁面，應能看到剛剛建立的一次性靜音規則。
  6. **[審計]** 導航至「審計日誌」頁面，應能找到剛才「確認事件」和「建立靜音」的操作紀錄。

### 3.2. 各模組功能驗證
- **Agent A (設計系統)**:
  - **[TC-A1]**: 隨機抽查 10 個頁面/彈窗，確認玻璃效果、深色主題、字體、間距等視覺元素與 `prototype.html` 一致。
- **Agent B (事件管理)**:
  - **[TC-B1]**: 測試事件列表的篩選（按嚴重性、狀態）和搜尋功能。
  - **[TC-B2]**: 完整測試「事件規則」的建立、編輯、暫停、刪除流程。
- **Agent C (資源與儀表板)**:
  - **[TC-C1]**: 測試資源列表的篩選和搜尋。
  - **[TC-C2]**: 測試資源群組的建立與成員管理。
  - **[TC-C3]**: 測試拓撲視圖的節點和連線是否正確呈現。
- **Agent D (身份管理)**:
  - **[TC-D1]**: 測試邀請新人員、編輯人員角色/團隊、刪除人員的完整流程。
  - **[TC-D2]**: 測試角色的建立（包含權限勾選）和指派。
- **Agent E (通知管理)**:
  - **[TC-E1]**: 測試通知策略的建立、編輯、刪除流程。
  - **[TC-E2]**: 測試通知管道的「發送測試」功能是否正常。

---

## 4. 非功能性測試 (Non-Functional Testing)

### 4.1. 效能測試
- **[NFT-P1]**: **API 回應時間**: 使用瀏覽器開發者工具，測量主要列表頁面（事件、資源）的 API 回應時間，應小於 200ms。
- **[NFT-P2]**: **頁面載入速度**: 首次載入事件列表頁面的 LCP (Largest Contentful Paint) 時間應小於 1.5s。
- **[NFT-P3]**: **前端篩選效能**: 在有 500+ 筆事件的列表中，進行客戶端篩選或搜尋，UI 回應應無明顯延遲。

### 4.2. 壓力測試
- **[NFT-S1]**: **大量資料渲染**: 驗證當事件列表有 2000+ 筆資料時，頁面滾動是否流暢，瀏覽器記憶體佔用是否在合理範圍。

### 4.3. 使用者體驗驗證
- **[NFT-U1]**: **介面一致性**: 檢查所有頁面的 `PageHeader`、表格工具列、按鈕樣式和位置是否一致。
- **[NFT-U2]**: **響應式設計**: 縮放瀏覽器視窗，檢查佈局是否能合理適應，無跑版或元素重疊問題。
- **[NFT-U3]**: **錯誤處理**: 刻意觸發 API 錯誤（如中斷 Mock Server），檢查前端是否能優雅地顯示錯誤提示，而非白畫面。

---

## 5. 成功標準 (Success Criteria)
- **功能**: 100% 的功能測試案例 (TC) 皆通過。
- **效能**: 95% 的效能測試案例 (NFT-P) 皆達到目標。
- **品質**: 無 P0 (阻斷性) 或 P1 (嚴重) 等級的 Bug。
- **體驗**: UI/UX 驗證無重大問題，與設計規範一致。
- **文件**: 所有模組皆有對應的 `實現摘要`。
