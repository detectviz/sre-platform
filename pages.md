# SRE å¹³å°é é¢åŠŸèƒ½åˆ†æ

æœ¬æ–‡ä»¶åŸºæ–¼ `images/` ç›®éŒ„ä¸­çš„é é¢æˆªåœ–ï¼Œåˆ†ææ¯å€‹åŠŸèƒ½æ¨¡çµ„çš„è¨­è¨ˆã€API éœ€æ±‚å’Œä½¿ç”¨è€…é«”é©—å„ªåŒ–å»ºè­°ã€‚

## é é¢æˆªåœ–ï¼ˆæŒ‰ç·¨è™Ÿé †åºæ’åˆ—ï¼‰

```bash
.
â”œâ”€â”€ 00-é é¢-ç™»å…¥.png
â”œâ”€â”€ 01-å½ˆçª—-ä½¿ç”¨è€…é¸å–®.png
â”œâ”€â”€ 02-å½ˆçª—-é€šçŸ¥ä¸­å¿ƒ.png
â”œâ”€â”€ 10-é é¢-äº‹ä»¶åˆ—è¡¨.png
â”œâ”€â”€ 11-é é¢-äº‹ä»¶è¦å‰‡.png
â”œâ”€â”€ 12-é é¢-éœéŸ³è¦å‰‡.png
â”œâ”€â”€ 13-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…1-åŸºæœ¬è³‡è¨Š.png
â”œâ”€â”€ 14-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…2-è™•ç†æ­·å².png
â”œâ”€â”€ 15-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…3-é—œè¯äº‹ä»¶.png
â”œâ”€â”€ 16-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…4-è‡ªå‹•åŒ–.png
â”œâ”€â”€ 17-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-AIäº‹ä»¶åˆ†æå ±å‘Š.png
â”œâ”€â”€ 18-å½ˆçª—-äº‹ä»¶è¦å‰‡-å»ºç«‹éœéŸ³.png
â”œâ”€â”€ 19-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡1-åŸºæœ¬è³‡è¨Š.png
â”œâ”€â”€ 20-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡2-è§¸ç™¼æ¢ä»¶.png
â”œâ”€â”€ 21-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡3-äº‹ä»¶å…§å®¹.png
â”œâ”€â”€ 22-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡4-è‡ªå‹•åŒ–.png
â”œâ”€â”€ 23-å½ˆçª—-éœéŸ³è¦å‰‡-ç·¨è¼¯éœéŸ³è¦å‰‡1-åŸºæœ¬è³‡è¨Š.png
â”œâ”€â”€ 24-å½ˆçª—-éœéŸ³è¦å‰‡-ç·¨è¼¯éœéŸ³è¦å‰‡2-è¨­å®šæ’ç¨‹.png
â”œâ”€â”€ 25-å½ˆçª—-éœéŸ³è¦å‰‡-ç·¨è¼¯éœéŸ³è¦å‰‡3-è¨­å®šç¯„åœ.png
â”œâ”€â”€ 30-é é¢-è³‡æºåˆ—è¡¨.png
â”œâ”€â”€ 31-é é¢-è³‡æºç¾¤çµ„.png
â”œâ”€â”€ 32-é é¢-æ‹“æ’²è¦–åœ–.png
â”œâ”€â”€ 33-å½ˆçª—-è³‡æºåˆ—è¡¨-ç·¨è¼¯è³‡æº.png
â”œâ”€â”€ 34-å½ˆçª—-è³‡æºç¾¤çµ„-ç·¨è¼¯ç¾¤çµ„.png
â”œâ”€â”€ 40-é é¢-å„€è¡¨æ¿ç®¡ç†.png
â”œâ”€â”€ 41-é é¢-åŸºç¤è¨­æ–½æ´å¯Ÿ.png
â”œâ”€â”€ 42-é é¢-SREæˆ°æƒ…å®¤.png
â”œâ”€â”€ 50-é é¢-å®¹é‡è¦åŠƒ.png
â”œâ”€â”€ 51-é é¢-è…³æœ¬åº«.png
â”œâ”€â”€ 52-é é¢-æ’ç¨‹ç®¡ç†.png
â”œâ”€â”€ 53-é é¢-åŸ·è¡Œæ—¥èªŒ.png
â”œâ”€â”€ 54-å½ˆçª—-è…³æœ¬åº«-ç·¨è¼¯è…³æœ¬.png
â”œâ”€â”€ 55-å½ˆçª—-æ’ç¨‹ç®¡ç†-ç·¨è¼¯æ’ç¨‹-ç°¡æ˜“æ¨¡å¼.png
â”œâ”€â”€ 56-å½ˆçª—-æ’ç¨‹ç®¡ç†-ç·¨è¼¯æ’ç¨‹-é€²éšæ¨¡å¼.png
â”œâ”€â”€ 57-å½ˆçª—-åŸ·è¡Œæ—¥èªŒ-åŸ·è¡Œæ—¥èªŒè©³æƒ….png
â”œâ”€â”€ 60-é é¢-äººå“¡ç®¡ç†.png
â”œâ”€â”€ 61-é é¢-åœ˜éšŠç®¡ç†.png
â”œâ”€â”€ 62-é é¢-è§’è‰²ç®¡ç†.png
â”œâ”€â”€ 63-é é¢-å¯©è¨ˆæ—¥èªŒ.png
â”œâ”€â”€ 64-é é¢-è¨­å®š.png
â”œâ”€â”€ 65-å½ˆçª—-äººå“¡ç®¡ç†-ç·¨è¼¯äººå“¡.png
â”œâ”€â”€ 66-å½ˆçª—-åœ˜éšŠç®¡ç†-ç·¨è¼¯åœ˜éšŠ.png
â”œâ”€â”€ 67-å½ˆçª—-è§’è‰²ç®¡ç†-æ–°å¢è§’è‰².png
â”œâ”€â”€ 68-æŠ½å±œ-å¯©è¨ˆæ—¥èªŒ-æ—¥èªŒè©³æƒ….png
â”œâ”€â”€ 70-é é¢-é€šçŸ¥ç­–ç•¥.png
â”œâ”€â”€ 71-é é¢-é€šçŸ¥ç®¡é“.png
â”œâ”€â”€ 72-é é¢-é€šçŸ¥æ­·å².png
â”œâ”€â”€ 73-å½ˆçª—-é€šçŸ¥ç­–ç•¥-ç·¨è¼¯é€šçŸ¥ç­–ç•¥1.png
â”œâ”€â”€ 74-å½ˆçª—-é€šçŸ¥ç­–ç•¥-ç·¨è¼¯é€šçŸ¥ç­–ç•¥2.png
â”œâ”€â”€ 75-å½ˆçª—-é€šçŸ¥ç­–ç•¥-ç·¨è¼¯é€šçŸ¥ç­–ç•¥3.png
â”œâ”€â”€ 76-å½ˆçª—-é€šçŸ¥ç®¡é“-ç·¨è¼¯é€šçŸ¥ç®¡é“.png
â”œâ”€â”€ 77-æŠ½å±œ-é€šçŸ¥æ­·å²-é€šçŸ¥è©³æƒ….png
â”œâ”€â”€ 80-é é¢-æ¨™ç±¤ç®¡ç†.png
â”œâ”€â”€ 81-é é¢-éƒµä»¶è¨­å®š.png
â”œâ”€â”€ 82-é é¢-èº«ä»½é©—è­‰.png
â”œâ”€â”€ 83-å½ˆçª—-æ¨™ç±¤ç®¡ç†-æ–°å¢æ¨™ç±¤.png
â”œâ”€â”€ 84-å½ˆçª—-æ¨™ç±¤ç®¡ç†-ç®¡ç†æ¨™ç±¤å€¼.png
â”œâ”€â”€ 85-å½ˆçª—-æ¨™ç±¤ç®¡ç†-ç·¨è¼¯æ¨™ç±¤.png
â”œâ”€â”€ 90-é é¢-å€‹äººè³‡æ–™-å€‹äººè³‡è¨Š.png
â”œâ”€â”€ 91-é é¢-å€‹äººè³‡æ–™-åå¥½è¨­å®š.png
â””â”€â”€ 92-é é¢-å€‹äººè³‡æ–™-å¯†ç¢¼å®‰å…¨.png
```

## æ–‡ä»¶çµæ§‹

- [å…¨åŸŸ](#0.å…¨åŸŸ)
- [äº‹ä»¶ç®¡ç†](#1.äº‹ä»¶ç®¡ç†)
- [è³‡æºç®¡ç†](#2.è³‡æºç®¡ç†)
- [å„€è¡¨æ¿](#3.å„€è¡¨æ¿)
- [åˆ†æä¸­å¿ƒ](#4.åˆ†æä¸­å¿ƒ)
- [è‡ªå‹•åŒ–ä¸­å¿ƒ](#5.è‡ªå‹•åŒ–ä¸­å¿ƒ)
- [è¨­å®š-èº«ä»½èˆ‡å­˜å–ç®¡ç†](#6.è¨­å®š-èº«ä»½èˆ‡å­˜å–ç®¡ç†)
- [è¨­å®š-é€šçŸ¥ç®¡ç†](#7.è¨­å®š-é€šçŸ¥ç®¡ç†)
- [è¨­å®š-å¹³å°ç®¡ç†](#8.è¨­å®š-å¹³å°ç®¡ç†)
- [å€‹äººè³‡æ–™](#9.å€‹äººè³‡æ–™)

## ğŸ“‹ æŠ€è¡“æ¶æ§‹èˆ‡å°èˆª
- [ğŸ”— å°èˆªçµæ§‹](#-å°èˆªçµæ§‹)
- [ğŸ¯ æ¶æ§‹ç‰¹é»](#-æ¶æ§‹ç‰¹é»)
- [ğŸ¨ UI/UX è¨­è¨ˆåŸå‰‡èˆ‡è¦ç¯„](#-uiux-è¨­è¨ˆåŸå‰‡èˆ‡è¦ç¯„)
- [ğŸ“Š åº¦é‡æŒ‡æ¨™å»ºè­°](#-åº¦é‡æŒ‡æ¨™å»ºè­°)
- [ğŸš€ ç™¼å±•å»ºè­°](#-ç™¼å±•å»ºè­°)
- [ğŸ“ˆ å¯¦æ–½é€²åº¦è¿½è¹¤](#-å¯¦æ–½é€²åº¦è¿½è¹¤)
- [ğŸ¨ è¨­è¨ˆè¦ç¯„ç¸½çµ](#-è¨­è¨ˆè¦ç¯„ç¸½çµ)

---

## 0.å…¨åŸŸ

### ç™»å…¥ [ç™»å…¥](images/00-é é¢-ç™»å…¥.png)

**åŠŸèƒ½æè¿°**ï¼š
- SRE Platform æ™ºæ…§åŒ–ç³»çµ±ç®¡ç†å¹³å°çš„ç™»å…¥é é¢
- ç°¡æ½”çš„å“ç‰Œè­˜åˆ¥è¨­è¨ˆï¼ŒåŒ…å«å¹³å° Logo å’Œåç¨±
- æ¨™æº–çš„å¸³è™Ÿå¯†ç¢¼ç™»å…¥è¡¨å–®ï¼ŒåŒ…å«å¸³è™Ÿè¼¸å…¥æ¡†ã€å¯†ç¢¼è¼¸å…¥æ¡†ï¼ˆå…·å‚™é¡¯ç¤º/éš±è—åŠŸèƒ½ï¼‰
- ã€Œè¨˜ä½æˆ‘ã€æ ¸å–æ–¹å¡Šå’Œã€Œå¿˜è¨˜å¯†ç¢¼ï¼Ÿã€é€£çµ
- ä¸»è¦ç™»å…¥æŒ‰éˆ•å’Œç‰ˆæœ¬è³‡è¨Šé¡¯ç¤º
- æ·±è‰²ä¸»é¡Œè¨­è¨ˆï¼Œç¬¦åˆç¾ä»£ SRE å·¥å…·çš„å°ˆæ¥­æ„Ÿ

**ç›¸é—œ API ç«¯é»**ï¼š
- `POST /api/v1/auth/login` - ç”¨æˆ¶ç™»å…¥é©—è­‰
- `POST /api/v1/auth/forgot-password` - å¿˜è¨˜å¯†ç¢¼è«‹æ±‚
- `GET /api/v1/auth/session` - é©—è­‰æœƒè©±ç‹€æ…‹
- `POST /api/v1/auth/logout` - ç”¨æˆ¶ç™»å‡º

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¤šå› ç´ èªè­‰æ”¯æ´**ï¼šå¢åŠ  2FA/TOTP ç­‰é¡å¤–å®‰å…¨é©—è­‰é¸é …
2. **ç¤¾äº¤ç™»å…¥æ•´åˆ**ï¼šæ”¯æ´ä¼æ¥­ç´š SSOï¼ˆå¦‚ Google Workspaceã€Microsoft 365ã€LDAPï¼‰
3. **ç™»å…¥ç‹€æ…‹è¨˜æ†¶**ï¼šå„ªåŒ–ã€Œè¨˜ä½æˆ‘ã€åŠŸèƒ½ï¼Œæä¾›ä¸åŒçš„æœƒè©±æ™‚é•·é¸é …
4. **éŒ¯èª¤è™•ç†å„ªåŒ–**ï¼šæä¾›æ¸…æ™°çš„éŒ¯èª¤æç¤ºå’Œæ¢å¾©å»ºè­°
5. **è¼‰å…¥ç‹€æ…‹æŒ‡ç¤º**ï¼šç™»å…¥éç¨‹ä¸­é¡¯ç¤ºè¼‰å…¥å‹•ç•«ï¼Œæ”¹å–„ç”¨æˆ¶é«”é©—
6. **å¯†ç¢¼å¼·åº¦æŒ‡ç¤º**ï¼šåœ¨å¯†ç¢¼é‡è¨­æµç¨‹ä¸­æä¾›å¼·åº¦æª¢æ¸¬
7. **å¯åŠæ€§æ”¹å–„**ï¼šæ”¯æ´éµç›¤å°èˆªå’Œè¢å¹•é–±è®€å™¨
8. **è¡Œå‹•ç«¯é©é…**ï¼šç¢ºä¿åœ¨å„ç¨®è¢å¹•å°ºå¯¸ä¸‹çš„è‰¯å¥½é«”é©—

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤é é¢æ˜¯æ•´å€‹å¹³å°çš„**æ ¸å¿ƒè³‡ç”¢åº« (CMDB)**ï¼Œå…¶è¨­è¨ˆç›®æ¨™æ‡‰æ˜¯å°‡ä¸€å€‹éœæ…‹çš„è³‡æºæ¸…å–®ï¼Œè½‰åŒ–ç‚ºä¸€å€‹**å³æ™‚ã€å¯è§€æ¸¬ã€å¯æ“ä½œçš„åŸºç¤è¨­æ–½ç®¡ç†ä¸­æ¨**ã€‚ç›®å‰çš„è¨­è¨ˆæ˜¯ä¸€å€‹çµ•ä½³çš„èµ·é»ï¼Œä»¥ä¸‹å»ºè­°æ—¨åœ¨æ·±åŒ–å…¶æ¶æ§‹ï¼Œä½¿å…¶æˆç‚ºçœŸæ­£çš„å–®ä¸€äº‹å¯¦ä¾†æº (SSOT)ã€‚

**æ ¸å¿ƒå¾Œç«¯æ¶æ§‹ï¼šå‹•æ…‹ CMDB**
1.  **çµ±ä¸€è³‡æ–™æ¨¡å‹**ï¼šå¾Œç«¯æ‡‰å»ºç«‹ä¸€å€‹çµ±ä¸€çš„è³‡æºè³‡æ–™æ¨¡å‹ï¼Œå…¶è³‡æ–™ä¾†æºæ˜¯**å¤šæºèšåˆ**çš„ï¼š
    *   **æ ¸å¿ƒ CMDB è³‡æ–™åº« (PostgreSQL)**ï¼šå„²å­˜è³‡æºçš„éœæ…‹å±¬æ€§ï¼Œå¦‚ `name`, `ip_address`, `location`, `owner_team`, `resource_type`ã€‚é€™æ˜¯è³‡æºçš„ã€Œèº«ä»½è­‰ã€ã€‚
    *   **è‡ªå‹•åŒ–æ¢ç´¢å·¥å…· (Discovery Tools)**ï¼šæ‡‰å®šæœŸåŸ·è¡Œè‡ªå‹•åŒ–è…³æœ¬ï¼ˆå¦‚ Ansible playbooks æˆ–é›²ç«¯ API æƒæï¼‰ï¼Œæ¢ç´¢æ–°çš„è³‡æºæˆ–æ›´æ–°ç¾æœ‰è³‡æºçš„å±¬æ€§ï¼Œä¸¦å¯«å…¥ PostgreSQLã€‚
    *   **ç›£æ§ç³»çµ± (VictoriaMetrics)**ï¼šå³æ™‚çš„æ€§èƒ½æŒ‡æ¨™ï¼ˆå¦‚ `CPUä½¿ç”¨ç‡`ã€`è¨˜æ†¶é«”ä½¿ç”¨ç‡`ï¼‰æ‡‰å¾ VictoriaMetrics å‹•æ…‹æŸ¥è©¢ã€‚
    *   **äº‹ä»¶ç³»çµ± (Event Store)**ï¼š`é—œè¯äº‹ä»¶` çš„æ•¸é‡æ‡‰å¾äº‹ä»¶å„²å­˜ä¸­å³æ™‚èšåˆã€‚
2.  **é«˜æ•ˆèƒ½ API è¨­è¨ˆ**ï¼š
    *   `GET /api/v1/resources`: æ­¤ API å¿…é ˆé«˜æ•ˆã€‚å¾Œç«¯æœå‹™æ‡‰åœ¨å›å‚³å‰ï¼ŒéåŒæ­¥åœ°èšåˆä¾†è‡ªä¸Šè¿°å¤šå€‹ä¾†æºçš„è³‡æ–™ã€‚å°æ–¼åˆ—è¡¨ä¸­çš„å³æ™‚æŒ‡æ¨™ï¼Œå¯ä»¥è€ƒæ…®ä½¿ç”¨ä¸€å€‹ç¨å¾®å»¶é²ï¼ˆå¦‚ 1 åˆ†é˜ï¼‰çš„å¿«å–ï¼Œä»¥å¹³è¡¡å³æ™‚æ€§èˆ‡æ•ˆèƒ½ã€‚
    *   `GET /api/v1/resources/statistics`: é ‚éƒ¨çš„å››å€‹ KPI æŒ‡æ¨™**å¿…é ˆ**ç”±ä¸€å€‹èƒŒæ™¯æ’ç¨‹ä½œæ¥­ï¼ˆå¦‚æ¯åˆ†é˜ä¸€æ¬¡ï¼‰**é å…ˆè¨ˆç®—ä¸¦å¿«å–**åœ¨ Redis ä¸­ã€‚æ­¤ API æ‡‰ç›´æ¥è®€å–å¿«å–ï¼Œç¢ºä¿é é¢æ¯«ç§’ç´šè¼‰å…¥ã€‚
    *   `GET /api/v1/resources/{id}/metrics?range=1h`: æ‡‰æä¾›ä¸€å€‹å°ˆé–€çš„ç«¯é»ï¼Œç”¨æ–¼ç²å–è³‡æºåœ¨ç‰¹å®šæ™‚é–“ç¯„åœå…§çš„è©³ç´°æ™‚åºæ•¸æ“šï¼Œä¾›å‰ç«¯çš„è¿·ä½ åœ–è¡¨ä½¿ç”¨ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šå°‡è³‡æ–™è½‰åŒ–ç‚ºæ´å¯Ÿ**
1.  **å°‡æŒ‡æ¨™è¦–è¦ºåŒ–ç‚ºè¶¨å‹¢**ï¼šç›®å‰çš„ `CPU` å’Œ `è¨˜æ†¶é«”ä½¿ç”¨ç‡` æ¢ç‹€åœ–åªé¡¯ç¤ºäº†ç•¶å‰æ™‚é–“é»çš„å¿«ç…§ã€‚æ‡‰å°‡å…¶å‡ç´šç‚º**è¿·ä½ è¶¨å‹¢åœ– (Sparkline Chart)**ï¼Œå±•ç¤ºéå»ä¸€å°æ™‚çš„è®ŠåŒ–è¶¨å‹¢ã€‚é€™èƒ½è®“ SRE å¿«é€Ÿåˆ¤æ–·å•é¡Œæ˜¯ç¬æ™‚å°–å³°é‚„æ˜¯æŒçºŒé«˜è² è¼‰ã€‚
2.  **æ¨™ç±¤å³æ˜¯æ“ä½œçš„èµ·é» (Tag-Driven Operations)**ï¼š
    *   **æ¨™ç±¤å¿…é ˆæ˜¯å¯é»æ“Šçš„**ï¼šUI ä¸­çš„æ¯ä¸€å€‹æ¨™ç±¤ï¼ˆå¦‚ `production`, `database`ï¼‰éƒ½æ‡‰æ˜¯ä¸€å€‹è¶…é€£çµã€‚é»æ“Šå¾Œï¼Œé é¢æœƒä»¥æ­¤æ¨™ç±¤ç‚ºç¯©é¸æ¢ä»¶ï¼Œé‡æ–°è¼‰å…¥è³‡æºåˆ—è¡¨ã€‚
    *   **æ‰¹æ¬¡æ“ä½œä»¥æ¨™ç±¤ç‚ºä¸­å¿ƒ**ï¼šã€Œæ‰¹æ¬¡è¨­å®šã€åŠŸèƒ½çš„æ ¸å¿ƒæ‡‰è©²æ˜¯**æ‰¹æ¬¡ç·¨è¼¯æ¨™ç±¤**ï¼Œå…è¨± SRE ä¸€æ¬¡æ€§ç‚ºå¤šå€‹è³‡æºæ‰“ä¸Šæˆ–ç§»é™¤åŒä¸€å€‹æ¨™ç±¤ã€‚
3.  **å¢å¼·çš„å¥åº·ç‹€æ…‹æŒ‡ç¤º**ï¼š
    *   **è§£é‡‹ã€Œç‚ºä½•ã€**ï¼šæ»‘é¼ æ‡¸åœåœ¨ã€Œç‹€æ…‹ã€åœ–ç¤ºï¼ˆå¦‚ `è­¦å‘Š`ï¼‰ä¸Šæ™‚ï¼Œå¿…é ˆé¡¯ç¤ºä¸€å€‹å·¥å…·æç¤º (Tooltip)ï¼Œæ¸…æ™°åœ°èªªæ˜è§¸ç™¼æ­¤ç‹€æ…‹çš„**å…·é«”åŸå› **ï¼Œä¾‹å¦‚ã€Œ`cpu_usage > 80% for 5m`ã€ã€‚æ­¤è³‡è¨Šç›´æ¥ä¾†è‡ªè§¸ç™¼å‘Šè­¦çš„è¦å‰‡ã€‚
    *   **é—œè¯äº‹ä»¶é€£çµ**ï¼š`é—œè¯äº‹ä»¶` æ¬„ä½çš„æ•¸å­—ä¸åƒ…æ˜¯æ•¸å­—ï¼Œæ›´æ‡‰æ˜¯ä¸€å€‹**å¯é»æ“Šçš„é€£çµ**ã€‚é»æ“Šå¾Œï¼Œæ‡‰å½ˆå‡ºä¸€å€‹ Modal æˆ–è·³è½‰åˆ°ä¸€å€‹é å…ˆç¯©é¸å¥½çš„äº‹ä»¶åˆ—è¡¨é é¢ï¼Œåªé¡¯ç¤ºèˆ‡è©²è³‡æºç›´æ¥ç›¸é—œçš„æ´»èºäº‹ä»¶ã€‚
4.  **æƒ…å¢ƒåŒ–çš„è¡Œå…§æ“ä½œ (Contextual Actions)**ï¼šè¡¨æ ¼æœ€å³å´çš„ã€Œæ“ä½œã€æŒ‰éˆ•ä¸æ‡‰æ˜¯å›ºå®šçš„ã€‚æ‡‰æ ¹æ“šè³‡æºçš„ `é¡å‹` å’Œ `æ¨™ç±¤` å‹•æ…‹é¡¯ç¤ºã€‚ä¾‹å¦‚ï¼š
    *   `é¡å‹: database` çš„è³‡æºï¼Œå¯ä»¥é¡¯ç¤ºã€ŒåŸ·è¡Œå‚™ä»½ã€ã€ã€ŒæŸ¥çœ‹æ…¢æŸ¥è©¢ã€ç­‰æ“ä½œã€‚
    *   `é¡å‹: kubernetes-pod` çš„è³‡æºï¼Œå¯ä»¥é¡¯ç¤ºã€ŒæŸ¥çœ‹æ—¥èªŒã€ã€ã€Œé€²å…¥å®¹å™¨ (Exec)ã€ç­‰æ“ä½œã€‚
    é€™éœ€è¦å¾Œç«¯è¨­è¨ˆä¸€å€‹éˆæ´»çš„ `actions` APIï¼Œæ ¹æ“šè³‡æºå±¬æ€§å›å‚³å¯ç”¨çš„æ“ä½œåˆ—è¡¨ã€‚

### ä½¿ç”¨è€…é¸å–® [ä½¿ç”¨è€…é¸å–®](images/01-å½ˆçª—-ä½¿ç”¨è€…é¸å–®.png)

**åŠŸèƒ½æè¿°**ï¼š
- é»æ“Šé ‚éƒ¨å°èˆªåˆ—å³å´çš„ä½¿ç”¨è€…é ­åƒæ™‚é¡¯ç¤ºçš„ä¸‹æ‹‰é¸å–®ã€‚
- é¡¯ç¤ºç•¶å‰ç™»å…¥ä½¿ç”¨è€…çš„åç¨±å’Œé›»å­éƒµä»¶ã€‚
- æä¾›å°å‘ã€Œå€‹äººè³‡æ–™ã€ã€ã€Œå¹«åŠ©ä¸­å¿ƒã€çš„é€£çµåŠã€Œç™»å‡ºã€åŠŸèƒ½ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/users/me` - ç²å–ç•¶å‰ç™»å…¥ä½¿ç”¨è€…çš„è©³ç´°è³‡è¨Šã€‚
- `POST /api/v1/auth/logout` - åŸ·è¡Œä½¿ç”¨è€…ç™»å‡ºæ“ä½œã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ–°å¢è§’è‰²é¡¯ç¤º**ï¼šåœ¨ä½¿ç”¨è€…åç¨±ä¸‹æ–¹é¡¯ç¤ºå…¶è§’è‰²ï¼ˆå¦‚ï¼šç®¡ç†å“¡ï¼‰ï¼Œæœ‰åŠ©æ–¼å¿«é€Ÿè¾¨è­˜èº«ä»½èˆ‡æ¬Šé™ã€‚
2. **åŠ å…¥ä¸»é¡Œåˆ‡æ›**ï¼šè‹¥ç³»çµ±æ”¯æ´å¤šç¨®ä¸»é¡Œï¼ˆå¦‚æ·±è‰²/æ·ºè‰²æ¨¡å¼ï¼‰ï¼Œå¯åœ¨æ­¤è™•å¢åŠ å¿«é€Ÿåˆ‡æ›é–‹é—œã€‚
3. **éµç›¤å¯åŠæ€§**ï¼šç¢ºä¿é¸å–®å…§æ‰€æœ‰é¸é …å‡å¯é€ééµç›¤ï¼ˆTabã€Enterï¼‰é€²è¡Œå°è¦½èˆ‡æ“ä½œã€‚
4. **å¹«åŠ©ä¸­å¿ƒæ–°é–‹åˆ†é **ï¼šé»æ“Šã€Œå¹«åŠ©ä¸­å¿ƒã€æ‡‰åœ¨æ–°ç€è¦½å™¨åˆ†é ä¸­é–‹å•Ÿï¼Œé¿å…ä½¿ç”¨è€…ä¸­æ–·ç•¶å‰ä½œæ¥­æµç¨‹ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æï¼Œé€™äº›é—œæ–¼ API Payload è¨­è¨ˆå’Œ UX åŠŸèƒ½å¼·åŒ–çš„å»ºè­°ï¼Œå°æ–¼å°‡æ­¤é¸å–®å¾ä¸€å€‹ç°¡å–®çš„å°èˆªå·¥å…·ï¼Œæå‡ç‚º SRE çš„é«˜æ•ˆå·¥ä½œå…¥å£è‡³é—œé‡è¦ã€‚æˆ‘å®Œå…¨è´ŠåŒä»¥ä¸‹è§€é»ï¼š

é€™å€‹ä½¿ç”¨è€…é¸å–®æ˜¯å¹³å°å€‹äººåŒ–å’Œæƒ…å¢ƒæ„ŸçŸ¥çš„æ ¸å¿ƒå…¥å£ï¼Œå…¶è¨­è¨ˆæ‡‰å°ˆæ³¨æ–¼æ•ˆç‡å’Œè³‡è¨Šå¯†åº¦ï¼Œä»¥æ»¿è¶³ SRE çš„å°ˆæ¥­éœ€æ±‚ã€‚

**API è¨­è¨ˆèˆ‡ Payload é—œéµ**ï¼š
1.  **`GET /api/v1/users/me` - è±å¯ŒåŒ– Payload**ï¼šæ­¤ API æ˜¯å‰ç«¯æ¬Šé™æ§åˆ¶å’Œå€‹äººåŒ–é¡¯ç¤ºçš„åŸºçŸ³ã€‚å…¶å›å‚³çš„ JSON ç‰©ä»¶**å¿…é ˆ**ä¸€æ¬¡æ€§åŒ…å«æ‰€æœ‰é—œéµè³‡è¨Šï¼Œé¿å…å‰ç«¯å¤šæ¬¡è«‹æ±‚ï¼š
    *   `id`, `name`, `email`, `avatar_url`
    *   `roles`: ä½¿ç”¨è€…æ‰€å±¬çš„è§’è‰²é™£åˆ— (e.g., `["Admin", "TeamLead"]`)
    *   `teams`: ä½¿ç”¨è€…æ‰€å±¬çš„åœ˜éšŠåˆ—è¡¨
    *   `permissions`: ä¸€å€‹åŒ…å«æ‰€æœ‰æœ‰æ•ˆæ¬Šé™çš„æ‰å¹³åŒ–å­—ä¸²é™£åˆ—ï¼Œä¾›å‰ç«¯é€²è¡Œå¿«é€Ÿã€é«˜æ•ˆçš„æ¬Šé™æª¢æŸ¥ (e.g., `["event:read", "event:update"]`)ã€‚
    *   `preferences`: ä½¿ç”¨è€…çš„å€‹äººåå¥½è¨­å®šï¼Œå¦‚ `theme` (`"dark"`, `"light"`)ã€‚
    *   `on_call_status`: (æ¨è–¦) èˆ‡ Grafana OnCall åŒæ­¥çš„å€¼ç­ç‹€æ…‹ (`"on-call"`, `"off-call"`)ã€‚
2.  **`POST /api/v1/auth/logout` - å¾¹åº•çš„å–®ä¸€ç™»å‡º (SLO)**ï¼šæ­¤ API å¿…é ˆè§¸ç™¼å®Œæ•´çš„ Keycloak SLO æµç¨‹ï¼Œç¢ºä¿ä½¿ç”¨è€…åœ¨æ‰€æœ‰é—œè¯ç³»çµ±ä¸­éƒ½å®Œå…¨ç™»å‡ºï¼Œé€™æ˜¯ä¼æ¥­ç´šå®‰å…¨çš„åŸºæœ¬è¦æ±‚ã€‚

**UX åŠŸèƒ½å¼·åŒ–å»ºè­°**ï¼š
1.  **å¼·åŒ–æƒ…å¢ƒæ„ŸçŸ¥ (Context Awareness)**ï¼šåœ¨ä½¿ç”¨è€… Email ä¸‹æ–¹ï¼Œç›´æ¥é¡¯ç¤ºå…¶**ä¸»è¦è§’è‰²**å’Œ**æ‰€å±¬åœ˜éšŠ**ã€‚é€™èƒ½è®“ä½¿ç”¨è€…åœ¨åŸ·è¡Œä»»ä½•æ“ä½œå‰ï¼Œå°è‡ªå·±çš„æ¬Šé™ä¸Šä¸‹æ–‡ä¸€ç›®äº†ç„¶ã€‚
2.  **æ•´åˆå€¼ç­ç‹€æ…‹ (On-Call Status)**ï¼šåœ¨é ‚éƒ¨å°è¦½åˆ—çš„ä½¿ç”¨è€…åç¨±æ—ï¼Œå¢åŠ ä¸€å€‹èˆ‡ `on_call_status` é—œè¯çš„**è¦–è¦ºæŒ‡ç¤ºç‡ˆ**ã€‚ä¾‹å¦‚ï¼Œå€¼ç­ä¸­é¡¯ç¤ºç´…è‰²ï¼Œéå€¼ç­é¡¯ç¤ºç¶ è‰²ã€‚å°‡æ­¤ç‹€æ…‹èˆ‡é€šçŸ¥ç³»çµ±è¯å‹•ï¼Œæ˜¯æ¥µå…·åƒ¹å€¼çš„ SRE åœ˜éšŠå”ä½œåŠŸèƒ½ã€‚
3.  **æä¾› SRE å°ˆå±¬æ·å¾‘ (SRE-Specific Shortcuts)**ï¼š
    *   **API é‡‘é‘°ç®¡ç†**ï¼šå¢åŠ ã€Œ**ç®¡ç† API é‡‘é‘°**ã€çš„ç›´æ¥é€£çµï¼Œå°å‘å€‹äººå­˜å–æ¬Šæ– (PAT) ç®¡ç†é é¢ã€‚
    *   **å¿«é€Ÿè¤‡è£½ä½¿ç”¨è€…ID**ï¼šåœ¨ä½¿ç”¨è€… Email æ—å¢åŠ ä¸€å€‹ã€Œè¤‡è£½ã€åœ–ç¤ºï¼Œå…è¨±ä¸€éµè¤‡è£½å…¶ UUIDã€‚é€™å°æ–¼åœ¨æ—¥èªŒä¸­æœå°‹æ“ä½œè¨˜éŒ„æˆ–åœ¨ API ä¸­é€²è¡Œèª¿è©¦éå¸¸å¯¦ç”¨ã€‚
4.  **é«˜æ•ˆçš„ä¸»é¡Œåˆ‡æ›**ï¼šåœ¨é¸å–®åº•éƒ¨ï¼ˆç™»å‡ºä¹‹ä¸Šï¼‰å¢åŠ ä¸€å€‹åˆ†æ®µæ§åˆ¶å™¨ (Segmented Control)ï¼Œæä¾›ã€Œæ·ºè‰²ã€ã€ã€Œæ·±è‰²ã€ã€ã€Œç³»çµ±é è¨­ã€ä¸‰å€‹é¸é …ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å¿«é€Ÿåˆ‡æ› UI ä¸»é¡Œï¼Œä¸¦å°‡é¸æ“‡æŒä¹…åŒ–åˆ°å¾Œç«¯çš„ `preferences`ã€‚

### é€šçŸ¥ä¸­å¿ƒ [é€šçŸ¥ä¸­å¿ƒ](images/02-å½ˆçª—-é€šçŸ¥ä¸­å¿ƒ.png)

**åŠŸèƒ½æè¿°**ï¼š
- é»æ“Šé ‚éƒ¨å°èˆªåˆ—çš„é€šçŸ¥éˆ´éºåœ–ç¤ºæ™‚é¡¯ç¤ºçš„ä¸‹æ‹‰é¢æ¿ã€‚
- é¡¯ç¤ºæœ€è¿‘çš„é€šçŸ¥åˆ—è¡¨ï¼Œä¸¦ä»¥åœ–ç¤ºå€åˆ†ä¸åŒé¡å‹ï¼ˆå¦‚ï¼šéŒ¯èª¤ã€è³‡è¨Šã€è­¦å‘Šã€æˆåŠŸï¼‰ã€‚
- æ¯å‰‡é€šçŸ¥åŒ…å«æ¨™é¡Œã€ç°¡è¿°åŠæ™‚é–“æˆ³ã€‚
- æä¾›ã€Œå…¨éƒ¨å·²è®€ã€å’Œã€ŒæŸ¥çœ‹æ‰€æœ‰é€šçŸ¥ã€çš„å¿«æ·æ“ä½œã€‚
- é€šçŸ¥åœ–ç¤ºä¸Šçš„å¾½ç« é¡¯ç¤ºæœªè®€é€šçŸ¥çš„æ•¸é‡ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/notifications?limit=5&unread=true` - ç²å–ç”¨æ–¼é è¦½çš„æœ€æ–°æœªè®€é€šçŸ¥ã€‚
- `GET /api/v1/notifications/count?unread=true` - ç²å–æœªè®€é€šçŸ¥çš„ç¸½æ•¸ï¼Œç”¨æ–¼æ›´æ–°å¾½ç« ã€‚
- `POST /api/v1/notifications/mark-all-as-read` - å°‡æ‰€æœ‰é€šçŸ¥æ¨™è¨˜ç‚ºå·²è®€ã€‚
- `POST /api/v1/notifications/{id}/read` - å°‡å–®ä¸€é€šçŸ¥æ¨™è¨˜ç‚ºå·²è®€ï¼ˆä¾‹å¦‚ï¼Œåœ¨é»æ“Šå¾Œï¼‰ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **åˆ†é¡ç¯©é¸**ï¼šå¢åŠ é€šçŸ¥é¡å‹ç¯©é¸ï¼ˆéŒ¯èª¤ã€è­¦å‘Šã€è³‡è¨Šã€æˆåŠŸï¼‰ï¼Œæ–¹ä¾¿å¿«é€ŸæŸ¥æ‰¾ç‰¹å®šé¡å‹é€šçŸ¥
2. **æ‰¹æ¬¡æ“ä½œ**ï¼šæ”¯æ´æ‰¹æ¬¡æ¨™è¨˜å·²è®€å’Œæ‰¹æ¬¡åˆªé™¤åŠŸèƒ½
3. **é€šçŸ¥é è¦½**ï¼šhover æ™‚é¡¯ç¤ºé€šçŸ¥å®Œæ•´å…§å®¹é è¦½
4. **å³æ™‚æ›´æ–°**ï¼šä½¿ç”¨ WebSocket å¯¦ç¾é€šçŸ¥çš„å³æ™‚æ¨é€å’Œç‹€æ…‹æ›´æ–°
5. **å„ªå…ˆç´šæ’åº**ï¼šé«˜å„ªå…ˆç´šé€šçŸ¥æ‡‰åœ¨åˆ—è¡¨é ‚éƒ¨çªå‡ºé¡¯ç¤º
6. **é€šçŸ¥æ­·å²**ï¼šæä¾›å®Œæ•´çš„é€šçŸ¥æ­·å²è¨˜éŒ„å’Œæœå°‹åŠŸèƒ½
7. **è‡ªå®šç¾©è¨­å®š**ï¼šå…è¨±ç”¨æˆ¶è‡ªè¨‚é€šçŸ¥åå¥½å’Œé »ç‡è¨­å®š
8. **æ“ä½œè¿½è¹¤**ï¼šè¨˜éŒ„ç”¨æˆ¶å°é€šçŸ¥çš„æ“ä½œï¼ˆå·²è®€ã€å¿½ç•¥ã€å›æ‡‰ç­‰ï¼‰

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚å°‡é€šçŸ¥ä¸­å¿ƒå¾ä¸€å€‹è¢«å‹•çš„è³‡è¨Šåˆ—è¡¨ï¼Œå‡ç´šç‚ºä¸€å€‹å…·å‚™**å³æ™‚æ€§ã€å¯æ“ä½œæ€§å’Œé™å™ªèƒ½åŠ›**çš„ä¸»å‹•æ§åˆ¶å°ï¼Œæ˜¯æå‡å¹³å°æ ¸å¿ƒåƒ¹å€¼çš„é—œéµã€‚ä»¥ä¸‹åˆ†æä¸­çš„å¾Œç«¯æ¶æ§‹å’Œ UX å»ºè­°æ˜¯å¯¦ç¾æ­¤ç›®æ¨™çš„æ­£ç¢ºè—åœ–ã€‚

é€šçŸ¥ä¸­å¿ƒä¸åƒ…æ˜¯è³‡è¨Šçš„å±•ç¤ºæ¿ï¼Œæ›´æ‡‰æ˜¯ SRE é«˜æ•ˆå·¥ä½œçš„ã€Œå„€è¡¨ç›¤ã€å’Œã€Œæ§åˆ¶å°ã€ã€‚å…¶è¨­è¨ˆæ‡‰åœç¹**å³æ™‚æ€§**ã€**å¯æ“ä½œæ€§**å’Œ**é™å™ª**ä¸‰å¤§æ ¸å¿ƒåŸå‰‡ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **éåŒæ­¥èˆ‡è§£è€¦**ï¼šå¾Œç«¯æ‡‰å»ºç«‹ä¸€å€‹ç¨ç«‹çš„ `Notification` æœå‹™ã€‚æ‰€æœ‰å…¶ä»–æœå‹™ï¼ˆäº‹ä»¶ã€è‡ªå‹•åŒ–ç­‰ï¼‰ä¸æ‡‰ç›´æ¥å¯«å…¥é€šçŸ¥ï¼Œè€Œæ˜¯å°‡é€šçŸ¥è«‹æ±‚ç™¼å¸ƒåˆ°ä¸€å€‹**è¨Šæ¯ä½‡åˆ— (Message Queue)**ï¼Œå¦‚ Redis Streams æˆ– RabbitMQã€‚`Notification` æœå‹™ä½œç‚ºå”¯ä¸€çš„æ¶ˆè²»è€…ï¼Œè² è²¬è™•ç†ã€å„²å­˜ä¸¦åˆ†æ´¾é€šçŸ¥ã€‚æ­¤æ¶æ§‹èƒ½ç¢ºä¿æ ¸å¿ƒæ¥­å‹™æµç¨‹çš„é«˜æ•ˆèƒ½èˆ‡æœå‹™é–“çš„æ¾è€¦åˆã€‚
2.  **å³æ™‚æ¨é€ (Real-time Push)**ï¼šå¾Œç«¯å¿…é ˆæä¾›ä¸€å€‹ WebSocket ç«¯é» (e.g., `/ws/v1/notifications`)ã€‚ä½¿ç”¨è€…é€£ç·šå¾Œï¼Œ`Notification` æœå‹™å¯å°‡æ–°é€šçŸ¥å³æ™‚æ¨é€è‡³å‰ç«¯ï¼Œå¯¦ç¾å¾½ç« æ•¸å­—å’Œåˆ—è¡¨çš„å‹•æ…‹æ›´æ–°ï¼Œé€™å°æ–¼ä½œæˆ°å®¤å ´æ™¯è‡³é—œé‡è¦ã€‚
3.  **å¼·åŒ–çš„æŸ¥è©¢ API**ï¼š`GET /api/v1/notifications` API æ‡‰æ”¯æ´è±å¯Œçš„æŸ¥è©¢åƒæ•¸ï¼Œé™¤äº†åˆ†é ï¼Œé‚„æ‡‰è‡³å°‘æ”¯æ´æŒ‰ `status` (`read`, `unread`)ã€`type` (`error`, `info`, `warning`, `success`) å’Œ `priority` (`high`, `medium`, `low`) é€²è¡Œä¼ºæœå™¨ç«¯ç¯©é¸ã€‚

**UX åŠŸèƒ½å¼·åŒ–å»ºè­°**ï¼š
1.  **å¯æ“ä½œçš„é€šçŸ¥ (Actionable Notifications)**ï¼šé€™æ˜¯æœ€é‡è¦çš„ UX æå‡ã€‚æ¯ä¸€æ¢é€šçŸ¥ï¼Œç‰¹åˆ¥æ˜¯å‘Šè­¦é¡é€šçŸ¥ï¼Œéƒ½æ‡‰é™„å¸¶ä¸€çµ„**æƒ…å¢ƒç›¸é—œçš„å¿«æ·æ“ä½œæŒ‰éˆ•**ã€‚ä¾‹å¦‚ï¼š
    *   `CPU high on db-prod-01` é€šçŸ¥æ‡‰é™„å¸¶ï¼šã€Œ**æŸ¥çœ‹è³‡æºå„€è¡¨æ¿**ã€ã€ã€Œ**å»ºç«‹éœéŸ³è¦å‰‡**ã€ã€ã€Œ**æŒ‡æ´¾çµ¦è‡ªå·±**ã€ã€‚
    *   `Script "..." executed` é€šçŸ¥æ‡‰é™„å¸¶ï¼šã€Œ**æŸ¥çœ‹åŸ·è¡Œæ—¥èªŒ**ã€ã€‚
    é€™èƒ½å°‡é€šçŸ¥ä¸­å¿ƒå¾ä¸€å€‹ã€Œå”¯è®€ã€é¢æ¿ï¼Œè½‰è®Šç‚ºä¸€å€‹é«˜æ•ˆçš„ã€Œå·¥ä½œå…¥å£ã€ã€‚
2.  **æ™ºæ…§é™å™ª (Intelligent Noise Reduction)**ï¼š
    *   **æ™ºæ…§åˆ†çµ„**ï¼šç•¶çŸ­æ™‚é–“å…§ï¼ˆå¦‚ 1 åˆ†é˜å…§ï¼‰æ”¶åˆ°è¶…é 3 æ¢ä¾†è‡ªåŒä¸€è³‡æºçš„åŒé¡å‘Šè­¦æ™‚ï¼Œç³»çµ±æ‡‰è‡ªå‹•å°‡å…¶åˆä½µç‚ºä¸€æ¢å¯å±•é–‹çš„é€šçŸ¥ï¼Œä¾‹å¦‚ã€Œ**[db-prod-01] åœ¨ 1 åˆ†é˜å…§æœ‰ 5 æ¢ CPU éé«˜å‘Šè­¦**ã€ï¼Œé¿å…ã€Œå‘Šè­¦é¢¨æš´ã€æ·¹æ²’ä½¿ç”¨è€…ä»‹é¢ã€‚
    *   **ç²¾ç´°åŒ–åå¥½è¨­å®š**ï¼šåœ¨ã€ŒæŸ¥çœ‹æ‰€æœ‰é€šçŸ¥ã€çš„å®Œæ•´é é¢ä¸­ï¼Œæ‡‰æä¾›ä¸€å€‹å¼·å¤§çš„è¨­å®šä»‹é¢ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥**é‡å°ä¸åŒé¡å‹ã€ä¸åŒå„ªå…ˆç´šçš„é€šçŸ¥ï¼Œè‡ªè¨‚å…¶æ¥æ”¶ç®¡é“**ï¼ˆå¦‚ï¼šP1 å‘Šè­¦ç™¼é€ç°¡è¨Šå’Œ App æ¨é€ï¼ŒP3 å‘Šè­¦åƒ…åœ¨ç«™å…§é¡¯ç¤ºï¼‰ã€‚è³¦äºˆä½¿ç”¨è€…æ§åˆ¶å™ªéŸ³çš„æ¬ŠåŠ›æ˜¯æå‡å¹³å°æ»¿æ„åº¦çš„é—œéµã€‚

---

## 1.äº‹ä»¶ç®¡ç†

### äº‹ä»¶åˆ—è¡¨ [äº‹ä»¶åˆ—è¡¨](images/10-é é¢-äº‹ä»¶åˆ—è¡¨.png)

**åŠŸèƒ½æè¿°**ï¼š
- çµ±ä¸€äº‹ä»¶ç®¡ç†ä»‹é¢
- äº‹ä»¶çµ±è¨ˆ KPIï¼šæ´»èºäº‹ä»¶ã€ä»Šæ—¥å·²è§£æ±ºã€å¹³å‡è§£æ±ºæ™‚é–“ã€è‡ªå‹•åŒ–è™•ç†ç‡
- äº‹ä»¶åˆ—è¡¨è¡¨æ ¼ï¼šåš´é‡æ€§ã€æ‘˜è¦ã€è³‡æºåç¨±ã€æ¥­å‹™å½±éŸ¿ã€ç‹€æ…‹ã€è™•ç†äººã€è§¸ç™¼æ™‚é–“
- æ‰¹æ¬¡æ“ä½œå’Œç¯©é¸åŠŸèƒ½
- AI åˆ†æåŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/events` - ç²å–äº‹ä»¶åˆ—è¡¨ï¼ˆæ”¯æ´åˆ†é ã€ç¯©é¸ã€æ’åºï¼‰
- `GET /api/v1/events/{id}` - ç²å–äº‹ä»¶è©³æƒ…
- `PUT /api/v1/events/{id}/assign` - åˆ†é…äº‹ä»¶è™•ç†äºº
- `PUT /api/v1/events/{id}/status` - æ›´æ–°äº‹ä»¶ç‹€æ…‹
- `POST /api/v1/events/batch-update` - æ‰¹æ¬¡æ›´æ–°äº‹ä»¶
- `GET /api/v1/events/statistics` - äº‹ä»¶çµ±è¨ˆæ•¸æ“š
- `POST /api/v1/events/{id}/ai-analysis` - è§¸ç™¼ AI åˆ†æ

**UX æ”¹å–„å»ºè­°**ï¼š
1. **ç‹€æ…‹è¦–è¦ºåŒ–**ï¼šä½¿ç”¨è‰²å½©ç·¨ç¢¼å’Œåœ–ç¤ºæ›´æ¸…æ¥šåœ°è¡¨ç¤ºäº‹ä»¶åš´é‡æ€§å’Œç‹€æ…‹
2. **å¿«é€Ÿæ“ä½œ**ï¼šåœ¨è¡¨æ ¼è¡Œå…§å¢åŠ å¿«æ·æ“ä½œæŒ‰éˆ•ï¼ˆç¢ºèªã€åˆ†é…ã€é—œé–‰ï¼‰
3. **æ™ºèƒ½ç¯©é¸**ï¼šå¢åŠ é è¨­ç¯©é¸å™¨ï¼ˆå¦‚ã€Œæˆ‘çš„äº‹ä»¶ã€ã€ã€Œé«˜å„ªå…ˆç´šã€ç­‰ï¼‰
4. **æ™‚é–“è»¸è¦–åœ–**ï¼šæä¾›äº‹ä»¶æ™‚é–“è»¸è¦–åœ–é¸é …
5. **æ‰¹æ¬¡æ“ä½œå„ªåŒ–**ï¼šæ”¹å–„æ‰¹æ¬¡æ“ä½œ UIï¼Œæä¾›æ›´æ¸…æ¥šçš„é¸ä¸­ç‹€æ…‹å’Œæ“ä½œåé¥‹

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚å°‡äº‹ä»¶åˆ—è¡¨å¾ä¸€å€‹ç°¡å–®çš„è³‡æ–™è¡¨ï¼Œè½‰è®Šç‚ºä¸€å€‹æ•´åˆäº†**é«˜æ•ˆæ•¸æ“šæµã€é«˜æ€§èƒ½ API å’Œå³æ™‚äº’å‹•é«”é©—**çš„æ±ºç­–æ”¯æ´ä¸­å¿ƒï¼Œæ˜¯æœ¬å¹³å°æˆåŠŸçš„é—œéµã€‚æ­¤è™•çš„æ¶æ§‹å’Œå»ºè­°æ˜¯å¯¦ç¾é€™ä¸€ç›®æ¨™çš„å …å¯¦åŸºç¤ã€‚

äº‹ä»¶åˆ—è¡¨æ˜¯ SRE å¹³å°çš„æ ¸å¿ƒä½œæˆ°å®¤ï¼Œå…¶è¨­è¨ˆç›®æ¨™æ‡‰æ˜¯**å°‡æµ·é‡ã€é›œäº‚çš„å‘Šè­¦ï¼Œè½‰åŒ–ç‚ºæ¸…æ™°ã€å¯æ“ä½œã€æœ‰ä¸Šä¸‹æ–‡çš„äº‹ä»¶**ã€‚é€™ä¸åƒ…æ˜¯ä¸€å€‹åˆ—è¡¨ï¼Œæ›´æ˜¯ä¸€å€‹æ±ºç­–æ”¯æ´ç³»çµ±ã€‚

**æ ¸å¿ƒå¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **è³‡æ–™æ¥æ”¶èˆ‡è™•ç†æµç¨‹ (Webhook -> Kafka -> Go Service)**ï¼š
    *   å¾Œç«¯æ‡‰æä¾›ä¸€å€‹é«˜åº¦å¯ç”¨çš„ Webhook ç«¯é» (e.g., `POST /api/v1/webhooks/grafana`)ï¼Œå®ƒåªåšä¸€ä»¶äº‹ï¼šå¿«é€Ÿæ¥æ”¶åŸå§‹å‘Šè­¦ï¼Œé©—è­‰å¾Œç«‹å³å¯«å…¥ **Kafka** æˆ– Redis Streamsã€‚
    *   ä¸€å€‹ç¨ç«‹çš„ Go **äº‹ä»¶è™•ç†æœå‹™ (Event Processor)** æœƒæ¶ˆè²»é€™äº›åŸå§‹å‘Šè­¦ã€‚å®ƒè² è²¬ï¼š(a) **å»é‡**ï¼›(b) **å‘Šè­¦é¢¨æš´æª¢æ¸¬** (e.g., 1åˆ†é˜å…§è¶…éNç­†åŒé¡å‘Šè­¦)ï¼›(c) å‘¼å« **AI åˆ†ææœå‹™**é€²è¡Œæ ¹å› ã€é—œè¯ã€å½±éŸ¿ç­‰åˆ†æï¼›(d) å°‡è±å¯ŒåŒ–å¾Œçš„äº‹ä»¶å­˜å…¥ **PostgreSQL** (ç”¨æ–¼çµæ§‹åŒ–æŸ¥è©¢) å’Œ **Elasticsearch** (ç”¨æ–¼å…¨æ–‡æª¢ç´¢å’Œè¤‡é›œç¯©é¸)ã€‚
2.  **API è¨­è¨ˆè¦é»**ï¼š
    *   `GET /api/v1/events/statistics`ï¼šé ‚éƒ¨çš„å››å€‹ KPI æŒ‡æ¨™ï¼ˆæ´»èºäº‹ä»¶ã€MTTR ç­‰ï¼‰**å¿…é ˆ**ç”±ä¸€å€‹èƒŒæ™¯æ’ç¨‹ä½œæ¥­ï¼ˆå¦‚æ¯åˆ†é˜åŸ·è¡Œä¸€æ¬¡ï¼‰**é å…ˆè¨ˆç®—ä¸¦å¿«å–**åœ¨ Redis ä¸­ã€‚æ­¤ API æ‡‰ç›´æ¥è®€å–å¿«å–ï¼Œä»¥ç¢ºä¿é é¢æ¯«ç§’ç´šè¼‰å…¥ã€‚
    *   `GET /api/v1/events`ï¼šæ­¤ API çš„å¾Œç«¯å¯¦ç¾æ‡‰ä¸»è¦æŸ¥è©¢ **Elasticsearch**ã€‚é™¤äº†æ”¯æ´åŸºæ–¼æ¬„ä½çš„çµæ§‹åŒ–ç¯©é¸ï¼ˆå¦‚ `status=NEW`ï¼‰ï¼Œé‚„æ‡‰åœ¨ä¸»æœå°‹æ¡†ä¸­æ”¯æ´**å¼·å¤§çš„æŸ¥è©¢å­—ä¸²èªæ³•**ï¼ˆå¦‚ Lucene query stringï¼‰ï¼Œå…è¨± SRE é€²è¡Œ `summary:(error OR 503) AND NOT resource_name:staging-*` é€™é¡è¤‡é›œçš„å³æ™‚æŸ¥è©¢ã€‚
    *   `PUT /api/v1/events/{id}/status`ï¼šæ›´æ–°äº‹ä»¶ç‹€æ…‹ï¼ˆå¦‚ `ACK`ï¼‰æ™‚ï¼Œå¾Œç«¯æ‡‰è€ƒæ…®é€é API **é›™å‘åŒæ­¥**å› Grafana Alertingï¼Œç¢ºä¿å…©å€‹ç³»çµ±çš„ç‹€æ…‹ä¸€è‡´ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å‹•æ…‹èˆ‡å³æ™‚çš„åˆ—è¡¨**ï¼šåˆ—è¡¨æ‡‰é€é **WebSocket** å¯¦ç¾å³æ™‚æ›´æ–°ã€‚æ–°é€²äº‹ä»¶æ‡‰æœ‰çŸ­æš«çš„**é«˜äº®å‹•ç•«**ï¼Œç‹€æ…‹è®Šæ›´ï¼ˆå¦‚ `NEW` -> `ACK`ï¼‰ä¹Ÿæ‡‰æœ‰è¦–è¦ºæç¤ºï¼Œç‚º SRE æ‰“é€ ä¸€å€‹çœŸæ­£çš„ã€Œå³æ™‚ã€ä½œæˆ°å®¤ã€‚
2.  **å‘Šè­¦é¢¨æš´çš„è¦–è¦ºåŒ–è™•ç†**ï¼šåœ–ç‰‡ä¸­å·²æœ‰çš„ã€Œé¢¨æš´ã€æ¨™ç±¤æ˜¯å€‹å¾ˆå¥½çš„é–‹å§‹ã€‚æ‡‰å°‡å…¶å¼·åŒ–ï¼š
    *   **è¦–è¦ºåˆä½µ**ï¼šè™•æ–¼é¢¨æš´ä¸­çš„äº‹ä»¶æ‡‰åœ¨ UI ä¸Šè‡ªå‹•**æ‘ºç–Šç‚ºä¸€çµ„**ï¼Œåƒ…é¡¯ç¤ºæ‘˜è¦å’Œæ•¸é‡ï¼Œé»æ“Šå¾Œæ‰å±•é–‹è©³æƒ…ï¼Œé¿å…ç•«é¢è¢«æ·¹æ²’ã€‚
    *   **å°ˆå±¬æ“ä½œ**ï¼šç‚ºé¢¨æš´äº‹ä»¶çµ„æä¾›å°ˆå±¬çš„æ‰¹æ¬¡æ“ä½œï¼Œå¦‚ã€Œ**æ‰¹æ¬¡éœéŸ³**ã€ã€ã€Œ**åˆä½µç‚ºäº‹æ•…**ã€ã€‚
3.  **å¯è‡ªè¨‚çš„è¦–åœ– (Custom Views)**ï¼šé™¤äº†ç¾æœ‰çš„ç¯©é¸å™¨ï¼Œæ‡‰å…è¨±ä½¿ç”¨è€…å°‡ä¸€çµ„è¤‡é›œçš„ç¯©é¸æ¢ä»¶**å„²å­˜ç‚ºå€‹äººåŒ–çš„ã€Œè¦–åœ–ã€**ï¼Œä¾‹å¦‚ã€Œæˆ‘çš„ P1 äº‹ä»¶ã€ã€ã€Œè³‡æ–™åº«åœ˜éšŠç›¸é—œäº‹ä»¶ã€ï¼Œä¸¦èƒ½å¿«é€Ÿåˆ‡æ›ã€‚é€™æ˜¯æå‡é«˜éšä½¿ç”¨è€…æ“ä½œæ•ˆç‡çš„é—œéµåŠŸèƒ½ã€‚
4.  **ã€Œæ¥­å‹™å½±éŸ¿ã€çš„ä¾†æºèˆ‡è¦–è¦ºåŒ–**ï¼šè¡¨æ ¼ä¸­çš„ã€Œæ¥­å‹™å½±éŸ¿ã€æ¬„ä½ï¼ˆé«˜ã€ä¸­ã€ä½ï¼‰æ˜¯é—œéµæ±ºç­–è³‡è¨Šã€‚UI ä¸Šæ‡‰æä¾›å·¥å…·æç¤º(tooltip)ï¼Œèªªæ˜æ­¤å½±éŸ¿ç­‰ç´šçš„åˆ¤æ–·ä¾æ“šï¼ˆä¾‹å¦‚ï¼Œä¾†æºæ–¼é—œè¯è³‡æºçš„ `criticality` æ¨™ç±¤ï¼‰ã€‚æ­¤å¤–ï¼Œæ‡‰è€ƒæ…®ä½¿ç”¨é™¤äº†é¡è‰²ä¹‹å¤–çš„å½¢ç‹€æˆ–åœ–ç¤ºä¾†æ¨™ç¤ºï¼Œä»¥æ”¹å–„è‰²ç›²äººå£«çš„å¯åŠæ€§ã€‚
5.  **æƒ…å¢ƒåŒ–çš„è¡Œå…§æ“ä½œ (Contextual Row Actions)**ï¼šå°æ–¼ã€Œæ“ä½œã€æ¬„ï¼Œä¸æ‡‰ç¸½æ˜¯é¡¯ç¤ºç›¸åŒçš„æŒ‰éˆ•ã€‚æ‡‰æ ¹æ“šäº‹ä»¶çš„ `status` å’Œ `type` å‹•æ…‹é¡¯ç¤ºæœ€ç›¸é—œçš„æ“ä½œã€‚ä¾‹å¦‚ï¼š
    *   å°æ–¼ `status: NEW` çš„äº‹ä»¶ï¼Œä¸»è¦æ“ä½œæ˜¯ã€Œ**ç¢ºèª (Ack)**ã€å’Œã€Œ**éœéŸ³**ã€ã€‚
    *   å°æ–¼ `status: ACK` çš„äº‹ä»¶ï¼Œä¸»è¦æ“ä½œæ‡‰è®Šç‚ºã€Œ**è§£æ±º (Resolve)**ã€å’Œã€Œ**åˆ†é… (Assign)**ã€ã€‚
    *   ç´”åœ–ç¤ºæŒ‰éˆ•æ‡‰åœ¨æ»‘é¼ æ‡¸åœæ™‚æä¾›æ˜ç¢ºçš„æ–‡å­—æç¤º (Tooltip)ï¼Œç¢ºä¿å…¶æ„åœ–æ¸…æ™°ã€‚

#### äº‹ä»¶è©³æƒ…å½ˆçª— - åŸºæœ¬è³‡è¨Š [äº‹ä»¶è©³æƒ…1-åŸºæœ¬è³‡è¨Š](images/13-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…1-åŸºæœ¬è³‡è¨Š.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è©³æƒ…å½ˆçª—çš„ã€ŒåŸºæœ¬è³‡è¨Šã€é ç±¤
- é¡¯ç¤ºäº‹ä»¶çš„æ ¸å¿ƒå±¬æ€§ï¼šæ‘˜è¦ã€åš´é‡æ€§ã€ç‹€æ…‹ã€ä¾†æºã€è§¸ç™¼æ™‚é–“ã€é—œè¯è³‡æºèˆ‡è¦å‰‡
- æä¾›å¿«é€Ÿæ“ä½œé€£çµå’Œåº•éƒ¨çš„ä¸»è¦æ“ä½œæŒ‰éˆ•

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/events/{id}` - ç²å–å–®ä¸€äº‹ä»¶çš„å®Œæ•´è©³ç´°è³‡è¨Š

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è³‡è¨Šå±¤æ¬¡å„ªåŒ–**ï¼šä½¿ç”¨è¦–è¦ºå±¤æ¬¡å’Œè‰²å½©ç·¨ç¢¼çªå‡ºé‡è¦è³‡è¨Šï¼ˆåš´é‡æ€§ã€ç‹€æ…‹ï¼‰
2. **å¿«æ·æ“ä½œæŒ‰éˆ•**ï¼šåœ¨å½ˆçª—ä¸­æ·»åŠ å¸¸ç”¨æ“ä½œçš„å¿«æ·æŒ‰éˆ•ï¼ˆåˆ†é…ã€ç¢ºèªã€å¿½ç•¥ï¼‰
3. **é—œè¯è³‡æºå°èˆª**ï¼šé»æ“Šé—œè¯è³‡æºæ‡‰èƒ½ç›´æ¥è·³è½‰åˆ°è³‡æºè©³æƒ…é é¢
4. **è¤‡è£½åˆ†äº«åŠŸèƒ½**ï¼šæä¾›äº‹ä»¶è³‡è¨Šçš„å¿«é€Ÿè¤‡è£½å’Œåˆ†äº«åŠŸèƒ½
5. **æ¨™ç±¤ç®¡ç†**ï¼šæ”¯æ´ç‚ºäº‹ä»¶æ·»åŠ è‡ªå®šç¾©æ¨™ç±¤ï¼Œä¾¿æ–¼åˆ†é¡å’Œè¿½è¹¤

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤å½ˆçª—è¨­è¨ˆèˆ‡ç¾æœ‰åˆ†æã€‚æ­¤å½ˆçª—æ˜¯äº‹ä»¶è™•ç†çš„ã€Œä¸»æ§å°ã€ï¼Œå…¶è¨­è¨ˆå¿…é ˆåš´æ ¼éµå¾ªã€Œå–®ä¸€äº‹å¯¦ä¾†æº (Single Source of Truth)ã€åŸå‰‡ï¼Œç‚º SRE æä¾›æ‰€æœ‰å¿…è¦çš„ä¸Šä¸‹æ–‡å’Œæ“ä½œå…¥å£ã€‚ç¾æœ‰åˆ†æä¸­çš„ API è¨­è¨ˆæ–¹å‘æ˜¯æ­£ç¢ºçš„ï¼Œæˆ‘å°‡å…¶é€²ä¸€æ­¥å¼·åŒ–ï¼Œç¢ºä¿èˆ‡ `docs/architecture.md` ä¸­å®šç¾©çš„æ¶æ§‹å®Œå…¨å°é½Šã€‚

**API è¨­è¨ˆåŸå‰‡ï¼šä¸€æ¬¡æ€§å…¨é‡ç²å–ï¼Œèªç¾©åŒ–ç‹€æ…‹è®Šæ›´**

1.  **`GET /api/v1/events/{id}` - å…¨é‡è³‡æ–™ Payload**:
    æ­¤ API çš„è¨­è¨ˆè‡³é—œé‡è¦ã€‚ç‚ºç¢ºä¿å½ˆçª—å…§å„åˆ†é ï¼ˆè™•ç†æ­·å²ã€é—œè¯äº‹ä»¶ç­‰ï¼‰çš„æµæš¢åˆ‡æ›ï¼Œå®ƒ**å¿…é ˆ**åœ¨ä¸€æ¬¡è«‹æ±‚ä¸­å›å‚³è©²äº‹ä»¶çš„**æ‰€æœ‰**ç›¸é—œè³‡è¨Šã€‚å…¶ Payload æ‡‰è¢«è‰¯å¥½åœ°çµæ§‹åŒ–ã€ç‰ˆæœ¬åŒ–ï¼Œä¸¦åœ¨ `openapi.yaml` ä¸­è©³ç´°è¨˜éŒ„ã€‚

    *   **Payload çµæ§‹ç¯„ä¾‹**:
        ```json
        {
          "id": "evt_2a7d3e9f-8b4c-4f1a-9e2d-6c1f8a7b3e9f",
          "summary": "CPU high on db-mysql-prod-02",
          "severity": "CRITICAL",
          "status": "ACKNOWLEDGED",
          "source": "Prometheus",
          "triggered_at": "2025-09-18T11:11:43Z",
          "acknowledged_at": "2025-09-18T11:15:01Z",
          "resolved_at": null,
          "assignee": {
            "id": "usr_1a2b3c",
            "name": "é™³å¤§æ–‡"
          },
          "resource": {
            "id": "res_b4c5d6",
            "name": "db-mysql-prod-02",
            "type": "DATABASE",
            "cmdb_link": "/resources/res_b4c5d6"
          },
          "rule": {
            "id": "rule_e7f8g9",
            "name": "é«˜ CPU ä½¿ç”¨ç‡"
          },
          "trigger_details": {
            "threshold": "CPU > 90%",
            "value": "92.5%"
          },
          "tags": [
            { "key": "env", "value": "production", "color": "#f5222d" },
            { "key": "dc", "value": "asia-east1", "color": "#faad14" },
            { "key": "service", "value": "user-database", "color": "#52c41a" }
          ],
          "quick_links": [
            { "name": "è³‡æºå„€è¡¨æ¿", "url": "https://grafana.example.com/d/abc-123/db-mysql-prod-02" },
            { "name": "ç›¸é—œæ—¥èªŒ", "url": "https://loki.example.com/explore?query={...}" },
            { "name": "ç¶­é‹æ‰‹å†Š (Runbook)", "url": "https://confluence.example.com/kb/runbook-cpu-high" }
          ],
          "available_actions": [
            { "key": "resolve", "label": "è§£æ±º (Resolve)", "api_endpoint": "/api/v1/events/{id}/status", "method": "PUT", "payload": { "status": "resolved" } },
            { "key": "assign", "label": "æŒ‡æ´¾ (Assign)", "api_endpoint": "/api/v1/events/{id}/assign", "method": "PUT" },
            { "key": "silence", "label": "å»ºç«‹éœéŸ³", "api_endpoint": "/api/v1/silence-rules", "method": "POST" }
          ],
          // ä»¥ä¸‹æ˜¯ç‚ºå…¶ä»–åˆ†é é è¼‰çš„è³‡æ–™
          "history_logs": [ /* ... è™•ç†æ­·å²è³‡æ–™ ... */ ],
          "related_events": [ /* ... é—œè¯äº‹ä»¶è³‡æ–™ ... */ ],
          "automation_runs": [ /* ... è‡ªå‹•åŒ–åŸ·è¡Œè³‡æ–™ ... */ ]
        }
        ```

2.  **èªç¾©åŒ–çš„ç‹€æ…‹è®Šæ›´ API**:
    åº•éƒ¨çš„æ“ä½œæŒ‰éˆ•æ‡‰å®Œå…¨ç”± API å›æ‡‰ä¸­çš„ `available_actions` é™£åˆ—é©…å‹•ã€‚ä¾‹å¦‚ï¼Œã€Œç¢ºèªæ”¶åˆ° (Ack)ã€æŒ‰éˆ•ï¼ˆåœ¨æ­¤ä¾‹ä¸­æ‡‰ç‚ºç¦ç”¨ç‹€æ…‹ï¼Œå› ç‚ºäº‹ä»¶å·²ç¢ºèªï¼‰æ‡‰å‘¼å« `PUT /api/v1/events/{id}/status` ä¸¦é™„å¸¶èªç¾©åŒ–çš„è«‹æ±‚é«” `{ "status": "acknowledged" }`ï¼Œè€Œéä¸€å€‹é€šç”¨çš„ `update` ç«¯é»ã€‚é€™ä½¿å¾—å¾Œç«¯å¯ä»¥ç‚ºæ¯å€‹ç‹€æ…‹è½‰æ›è§¸ç™¼ç‰¹å®šçš„æ¥­å‹™é‚è¼¯ï¼ˆå¦‚è¨˜éŒ„æ­·å²ã€é€šçŸ¥ç›¸é—œäººå“¡ï¼‰ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **æ¨™ç±¤ (Tags) å¿…é ˆæˆç‚ºä¸€ç­‰å…¬æ°‘**ï¼šåœ¨ã€ŒåŸºæœ¬è³‡è¨Šã€ä¸­ï¼Œæ‰€æœ‰å¾ Grafana ç¹¼æ‰¿çš„æ¨™ç±¤éƒ½æ‡‰è¢«**é¡¯è‘—åœ°ã€å¯é»æ“Šåœ°ã€å¸¶æœ‰è‰²å½©åœ°**å±•ç¤ºå‡ºä¾†ã€‚é»æ“Šæ¨™ç±¤æ‡‰èƒ½å¿«é€Ÿè·³è½‰åˆ°äº‹ä»¶åˆ—è¡¨ï¼Œä¸¦ä»¥æ­¤æ¨™ç±¤ä½œç‚ºç¯©é¸æ¢ä»¶ã€‚é€™æ˜¯ SRE é€²è¡Œå•é¡Œå®šä½å’Œæ¨¡å¼åˆ†ææ™‚æœ€é«˜é »çš„æ“ä½œä¹‹ä¸€ã€‚
2.  **è¬ç‰©çš†å¯é€£çµ (Everything is a Link)**ï¼šç‚ºå¯¦ç¾æ·±åº¦è¿½æº¯ï¼Œæ­¤è¦–åœ–ä¸­çš„æ¯ä¸€å€‹å¯¦é«”ï¼ˆè³‡æºåç¨±ã€è¦å‰‡åç¨±ã€ä¾†æºã€è™•ç†äººç­‰ï¼‰éƒ½**å¿…é ˆ**æ˜¯ä¸€å€‹è¶…é€£çµï¼Œå°å‘å…¶å°æ‡‰çš„ç®¡ç†æˆ–è©³æƒ…é é¢ï¼Œè®“ SRE å¯ä»¥ç„¡ç¸«åœ°é€²è¡Œé‘½å–å¼åˆ†æ (drill-down)ã€‚**ç‰¹åˆ¥æ˜¯ã€Œè³‡æºåç¨±ã€ï¼Œå®ƒæ‡‰é€£çµè‡³å¹³å°å…§éƒ¨çš„è³‡æºç®¡ç†é é¢ (`/resources/{id}`), è€Œéå¤–éƒ¨ç³»çµ±ã€‚**
3.  **æ•¸æ“šé©…å‹•çš„ã€Œå¿«é€Ÿæ“ä½œã€**ï¼šæ­¤å€å¡Šæ‡‰å®Œå…¨ç”± API å›æ‡‰ä¸­çš„ `quick_links` é™£åˆ—å‹•æ…‹ç”¢ç”Ÿã€‚é€™ä½¿å¾—ç®¡ç†å“¡å¯ä»¥æ ¹æ“šäº‹ä»¶ä¾†æºæˆ–æ¨™ç±¤ï¼Œéˆæ´»é…ç½®æœ€æœ‰ç”¨çš„å¤–éƒ¨é€£çµï¼ˆå¦‚ç›£æ§åœ–è¡¨ã€æ—¥èªŒç³»çµ±ã€Runbook ç­‰ï¼‰ï¼Œè€Œç„¡éœ€åœ¨å‰ç«¯ç¡¬ç·¨ç¢¼ã€‚
4.  **è³¦äºˆã€ŒAI åˆ†æã€æ›´æ˜ç¢ºçš„åƒ¹å€¼**ï¼šé»æ“Šã€ŒAI åˆ†æã€æŒ‰éˆ•å¾Œï¼Œä¸æ‡‰åƒ…åƒ…æ˜¯è·³è½‰ï¼Œè€Œæ‡‰åœ¨ç•¶å‰å½ˆçª—å…§**éåŒæ­¥åœ°è¼‰å…¥åˆ†æçµæœ**ï¼Œä¸¦åœ¨å®Œæˆå¾Œç”¨ä¸€å€‹å°ç´…é»æˆ–å‹•ç•«æç¤ºä½¿ç”¨è€…æŸ¥çœ‹ã€‚åˆ†æçµæœæ‡‰ç›´æ¥å‘ˆç¾åœ¨ä¸€å€‹æ–°çš„ã€ŒAI åˆ†æã€åˆ†é ä¸­ï¼Œå…§å®¹åŒ…æ‹¬**æ ¹å› çŒœæ¸¬**ã€**å½±éŸ¿åŠå¾‘**å’Œ**å»ºè­°çš„è™•ç†æ­¥é©Ÿ**ã€‚

#### äº‹ä»¶è©³æƒ…å½ˆçª— - è™•ç†æ­·å² [äº‹ä»¶è©³æƒ…2-è™•ç†æ­·å²](images/14-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…2-è™•ç†æ­·å².png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è©³æƒ…å½ˆçª—çš„ã€Œè™•ç†æ­·å²ã€é ç±¤
- ä»¥å‚ç›´æ™‚é–“è»¸çš„å½¢å¼å‘ˆç¾äº‹ä»¶ç”Ÿå‘½é€±æœŸ
- æ¯ä¸€å€‹æ­·å²ç¯€é»åŒ…å«ç‹€æ…‹ã€æ“ä½œæè¿°ã€åŸ·è¡Œè€…åŠæ™‚é–“æˆ³

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/events/{id}/history` - ç²å–æŒ‡å®šäº‹ä»¶çš„è™•ç†æ­·å²è¨˜éŒ„

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ™‚é–“è»¸è¦–è¦ºåŒ–**ï¼šä½¿ç”¨æ›´è±å¯Œçš„æ™‚é–“è»¸è¨­è¨ˆï¼ŒåŒ…å«ç‹€æ…‹åœ–ç¤ºå’Œé€²åº¦æŒ‡ç¤º
2. **è©³ç´°è³‡è¨Šå±•é–‹**ï¼šæ”¯æ´é»æ“Šå±•é–‹æŸ¥çœ‹æ¯å€‹æ“ä½œçš„è©³ç´°è³‡è¨Šå’Œå½±éŸ¿
3. **æ“ä½œäººå“¡è³‡è¨Š**ï¼šé¡¯ç¤ºæ“ä½œäººå“¡çš„é ­åƒã€è§’è‰²å’Œè¯çµ¡æ–¹å¼
4. **æ“ä½œè€—æ™‚çµ±è¨ˆ**ï¼šé¡¯ç¤ºæ¯å€‹è™•ç†éšæ®µçš„è€—æ™‚ï¼Œå¹«åŠ©å„ªåŒ–æµç¨‹
5. **åŒ¯å‡ºåŠŸèƒ½**ï¼šæ”¯æ´å°‡è™•ç†æ­·å²åŒ¯å‡ºç‚º PDF æˆ–å…¶ä»–æ ¼å¼
6. **ç›¸é—œäº‹ä»¶é€£çµ**ï¼šç•¶æ­·å²ä¸­æ¶‰åŠå…¶ä»–äº‹ä»¶æ™‚ï¼Œæä¾›å¿«é€Ÿè·³è½‰é€£çµ

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚è™•ç†æ­·å²ä¸åƒ…æ˜¯æ—¥èªŒï¼Œæ›´æ˜¯**åœ˜éšŠå”ä½œã€çŸ¥è­˜æ²‰æ¾±å’Œäº‹å¾Œè¤‡ç›¤ (Postmortem)** çš„æ ¸å¿ƒã€‚å…¶è¨­è¨ˆæ‡‰åœç¹**è³‡è¨Šçµæ§‹åŒ–**å’Œ**é«˜æ•ˆå”ä½œ**å…©å€‹ä¸­å¿ƒã€‚ç¾æœ‰çš„åˆ†æå·²ç‚ºæ­¤å¥ å®šäº†å …å¯¦çš„åŸºç¤ï¼Œæˆ‘å°‡åœ¨æ­¤ä¹‹ä¸Šï¼Œé€²ä¸€æ­¥æ·±åŒ–å…¶å¾Œç«¯æ¶æ§‹è¨­è¨ˆï¼Œç¢ºä¿å…¶å¥å£¯æ€§èˆ‡å¯æ“´å±•æ€§ã€‚

**å¾Œç«¯è³‡æ–™æ¨¡å‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **`event_histories` è³‡æ–™æ¨¡å‹**ï¼š
    å¾Œç«¯æ‡‰è¨­è¨ˆä¸€å¼µå°ˆé–€çš„ `event_histories` è¡¨ä¾†è¨˜éŒ„äº‹ä»¶ç”Ÿå‘½é€±æœŸä¸­çš„æ‰€æœ‰æ´»å‹•ã€‚å…¶æ ¸å¿ƒæ¬„ä½å¿…é ˆå®šç¾©æ¸…æ™°ï¼š
    *   `id`: æ­·å²æ¢ç›®çš„å”¯ä¸€è­˜åˆ¥ç¢¼ã€‚
    *   `event_id`: é—œè¯äº‹ä»¶çš„ foreign keyã€‚
    *   `type`: **(é—œéµæ¬„ä½)** ç”¨æ–¼å€åˆ†æ¢ç›®é¡å‹çš„æšèˆ‰ï¼Œä»¥ä¾¿å‰ç«¯é€²è¡Œå·®ç•°åŒ–æ¸²æŸ“ã€‚
        *   `SYSTEM_STATE_CHANGE`: ç³»çµ±è§¸ç™¼çš„ç‹€æ…‹è®Šæ›´ï¼Œå¦‚ `NEW` -> `ACKNOWLEDGED`ã€‚
        *   `USER_COMMENT`: ä½¿ç”¨è€…æ‰‹å‹•æ–°å¢çš„è©•è«–ã€‚
        *   `AUTOMATION_RUN`: è‡ªå‹•åŒ–è…³æœ¬çš„åŸ·è¡Œè¨˜éŒ„ã€‚
        *   `ASSIGNEE_CHANGE`: äº‹ä»¶è¢«æŒ‡æ´¾çµ¦æ–°çš„ä½¿ç”¨è€…æˆ–åœ˜éšŠã€‚
    *   `actor`: åŸ·è¡Œæ“ä½œçš„å¯¦é«”ï¼Œæ ¼å¼æ‡‰ç‚º `type:id`ï¼Œå¦‚ `"system:prometheus"`, `"user:usr_1a2b3c"`, `"rule:rule_e7f8g9"`ã€‚
    *   `content`: ä¸»è¦çš„æ–‡å­—å…§å®¹ï¼Œ**å¿…é ˆæ”¯æ´ Markdown**ã€‚å°æ–¼ç‹€æ…‹è®Šæ›´ï¼Œå¯ä»¥æ˜¯ã€Œç‹€æ…‹ç”± NEW è®Šæ›´ç‚º ACKNOWLEDGEDã€ã€‚
    *   `metadata`: ä¸€å€‹ `JSONB` æ¬„ä½ï¼Œç”¨æ–¼å„²å­˜çµæ§‹åŒ–è³‡æ–™ã€‚ä¾‹å¦‚ï¼Œå°æ–¼ `USER_COMMENT`ï¼Œå¯ä»¥å„²å­˜ `attachments` é™£åˆ—ï¼›å°æ–¼ `AUTOMATION_RUN`ï¼Œå¯ä»¥å„²å­˜ `execution_id` å’Œ `exit_code`ã€‚
    *   `created_at`: æ¢ç›®çš„æ™‚é–“æˆ³ã€‚

2.  **`GET /api/v1/events/{id}` - `history_logs` Payload**:
    æ­¤è³‡æ–™æ‡‰ä½œç‚ºä¸»äº‹ä»¶ API çš„ä¸€éƒ¨åˆ†ä¸€æ¬¡æ€§è¼‰å…¥ï¼Œä»¥é¿å…é¡å¤–çš„ç¶²è·¯è«‹æ±‚ã€‚

    ```json
    "history_logs": [
      {
        "id": "hist_001",
        "type": "SYSTEM_STATE_CHANGE",
        "actor": { "type": "system", "name": "Prometheus" },
        "content": "äº‹ä»¶å»ºç«‹",
        "created_at": "2025-09-18T11:11:43Z",
        "metadata": null
      },
      {
        "id": "hist_002",
        "type": "USER_COMMENT",
        "actor": { "type": "user", "id": "usr_2", "name": "user_2", "avatar_url": "..." },
        "content": "å·²ç¢ºèªï¼Œæ­£åœ¨åˆ†æå’Œè™•ç†å•é¡Œã€‚",
        "created_at": "2025-09-18T11:13:43Z",
        "metadata": {
          "attachments": [
            { "file_name": "cpu_graph.png", "url": "/files/cpu_graph.png" }
          ]
        }
      }
    ]
    ```

3.  **èªç¾©åŒ–çš„è©•è«–èˆ‡é€šçŸ¥ API (`POST /api/v1/events/{id}/comments`)**:
    *   **å¾Œç«¯é‚è¼¯**: æ”¶åˆ°è«‹æ±‚å¾Œï¼Œå¾Œç«¯æœƒåœ¨ `event_histories` è¡¨ä¸­å»ºç«‹ä¸€ç­† `type: USER_COMMENT` çš„ç´€éŒ„ã€‚æ¥è‘—ï¼Œç‚ºäº†å¯¦ç¾æœå‹™è§£è€¦ï¼Œå®ƒ**ä¸æ‡‰ç›´æ¥å‘¼å«é€šçŸ¥æœå‹™**ï¼Œè€Œæ˜¯æ‡‰è©²ï¼š
        1.  è§£æ `content` ä¸­çš„ `@æåŠ` (å¦‚ `@é™³å¤§æ–‡` æˆ– `@DBA_Team`)ã€‚
        2.  å°‡ä¸€å€‹çµæ§‹åŒ–çš„ã€ŒæåŠé€šçŸ¥ã€äº‹ä»¶ç™¼å¸ƒåˆ°**è¨Šæ¯ä½‡åˆ— (Message Queue)**ï¼Œå¦‚ Kafka æˆ– Redis Streamsã€‚
        3.  ç”±ç¨ç«‹çš„ `Notification` æœå‹™æ¶ˆè²»æ­¤è¨Šæ¯ï¼Œä¸¦è² è²¬å‘è¢«æåŠçš„å°è±¡ç™¼é€ç²¾æº–é€šçŸ¥ã€‚æ­¤æ¨¡å¼ç¢ºä¿äº†äº‹ä»¶è©•è«–åŠŸèƒ½çš„é«˜æ•ˆèƒ½èˆ‡ç³»çµ±çš„æ•´é«”å¥å£¯æ€§ã€‚

4.  **é™„ä»¶è™•ç†æµç¨‹ (Attachment Handling Flow)**:
    *   ç‚ºæ”¯æ´é™„ä»¶ä¸Šå‚³ï¼Œå‰ç«¯æ‡‰å‘¼å«ä¸€å€‹å°ˆé–€çš„**æª”æ¡ˆæœå‹™**ç«¯é» (e.g., `POST /api/v1/files`)ï¼Œè©²æœå‹™è² è²¬å°‡æª”æ¡ˆå„²å­˜è‡³ç‰©ä»¶å„²å­˜ (å¦‚ S3) ä¸¦å›å‚³ä¸€å€‹ `file_id`ã€‚
    *   ç•¶ä½¿ç”¨è€…ç™¼è¡¨è©•è«–æ™‚ï¼Œé€™å€‹ `file_id` æœƒè¢«åŒ…å«åœ¨ `POST /api/v1/events/{id}/comments` çš„è«‹æ±‚é«”ä¸­ï¼Œå¾Œç«¯åƒ…éœ€å„²å­˜æ­¤ IDï¼Œè€Œéè™•ç†æª”æ¡ˆæœ¬èº«ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **å¯Œæ–‡æœ¬èˆ‡é™„ä»¶æ”¯æ´ (Rich Text & Attachments)**ï¼šè©•è«–è¼¸å…¥æ¡†**å¿…é ˆ**æ˜¯ä¸€å€‹**æ”¯æ´ Markdown çš„å¯Œæ–‡æœ¬ç·¨è¼¯å™¨**ï¼Œä¸¦æä¾›**ä¸Šå‚³é™„ä»¶**ï¼ˆå¦‚æˆªåœ–ã€æ—¥èªŒç‰‡æ®µï¼‰çš„åŠŸèƒ½ã€‚é€™å°æ–¼æº–ç¢ºã€å®Œæ•´åœ°è¨˜éŒ„å•é¡Œæ’æŸ¥éç¨‹è‡³é—œé‡è¦ã€‚
2.  **è¦–è¦ºåŒ–å€åˆ†è³‡è¨Šé¡å‹ (Visually Distinguish Entry Types)**ï¼šåœ¨æ™‚é–“è»¸çš„è¦–è¦ºè¨­è¨ˆä¸Šï¼Œå¿…é ˆæ˜ç¢ºå€åˆ†ä¸åŒ `type` çš„æ­·å²è¨˜éŒ„ã€‚ä¾‹å¦‚ï¼š
    *   **ç³»çµ±ç‹€æ…‹è®Šæ›´**ï¼šä½¿ç”¨ç°¡æ½”ã€ä¸­æ€§çš„ç³»çµ±åœ–ç¤ºï¼ˆå¦‚é½’è¼ªï¼‰ã€‚
    *   **ä½¿ç”¨è€…è©•è«–**ï¼š**é¡¯ç¤ºè©²ä½¿ç”¨è€…çš„é ­åƒ**ï¼Œä½¿äººç‚ºå¹²é çš„è³‡è¨Šåœ¨æ™‚é–“è»¸ä¸­è„«ç©è€Œå‡ºã€‚
    *   **è‡ªå‹•åŒ–åŸ·è¡Œ**ï¼šä½¿ç”¨ä¸€å€‹ã€Œæ©Ÿå™¨äººã€åœ–ç¤ºã€‚
    é€™ç¨®è¦–è¦ºå€åˆ†èƒ½å¹«åŠ©ä½¿ç”¨è€…å¿«é€Ÿæƒæå’Œå®šä½é—œéµçš„äººç‚ºå¹²é å’Œè©•è«–è³‡è¨Šã€‚
3.  **ç¯©é¸èˆ‡æœå°‹ (Filter and Search)**ï¼šå°æ–¼å†—é•·çš„è™•ç†æ­·å²ï¼Œåœ¨é ‚éƒ¨å¢åŠ **ç¯©é¸æ§åˆ¶é …**ï¼ˆä¾‹å¦‚ï¼Œä¸€å€‹å¯ä»¥å¤šé¸ `type` çš„ä¸‹æ‹‰é¸å–®ï¼Œåªçœ‹ã€Œä½¿ç”¨è€…è©•è«–ã€å’Œã€ŒæŒ‡æ´¾è®Šæ›´ã€ï¼‰å’Œä¸€å€‹**æœå°‹æ¡†**ï¼Œæ˜¯**ä¸å¯æˆ–ç¼º**çš„åŠŸèƒ½ã€‚é€™èƒ½è®“ SRE åœ¨è¤‡é›œäº‹ä»¶ä¸­å¿«é€Ÿå®šä½é—œéµè³‡è¨Šã€‚
4.  **å°‡æ­·å²è½‰åŒ–ç‚ºçŸ¥è­˜ (Transform History into Knowledge)**ï¼šæä¾›ä¸€å€‹ã€Œ**æ–°å¢è‡³çŸ¥è­˜åº«**ã€æˆ–ã€Œ**åŒ¯å‡ºç‚ºè¤‡ç›¤å ±å‘Š**ã€çš„åŠŸèƒ½ã€‚ä½¿ç”¨è€…å¯ä»¥å‹¾é¸å¹¾æ¢é—œéµçš„è™•ç†æ­·å²å¾Œï¼Œä¸€éµå°‡é€™äº›çµæ§‹åŒ–çš„è³‡è¨Šï¼ˆæ“ä½œè€…ã€æ™‚é–“ã€å…§å®¹ã€é™„ä»¶ï¼‰åŒ¯å‡ºï¼Œä½œç‚ºæœªä¾†è™•ç†é¡ä¼¼å•é¡Œçš„ SOP æˆ–äº‹å¾Œå­¸ç¿’ææ–™ï¼Œå¯¦ç¾çŸ¥è­˜çš„æ²‰æ¾±èˆ‡è½‰åŒ–ã€‚

#### äº‹ä»¶è©³æƒ…å½ˆçª— - é—œè¯äº‹ä»¶ [äº‹ä»¶è©³æƒ…3-é—œè¯äº‹ä»¶](images/15-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…3-é—œè¯äº‹ä»¶.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è©³æƒ…å½ˆçª—çš„ã€Œé—œè¯äº‹ä»¶ã€é ç±¤
- é¡¯ç¤ºç³»çµ±æ ¹æ“šæ™‚é–“ã€è³‡æºã€æ‹“æ’²æˆ–AIåˆ†æåˆ¤æ–·å‡ºçš„ç›¸é—œäº‹ä»¶åˆ—è¡¨

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/events/{id}/related` - ç²å–èˆ‡æŒ‡å®šäº‹ä»¶ç›¸é—œçš„äº‹ä»¶åˆ—è¡¨

**UX æ”¹å–„å»ºè­°**ï¼š
1. **é—œè¯åº¦è©•åˆ†**ï¼šé¡¯ç¤ºæ¯å€‹ç›¸é—œäº‹ä»¶çš„é—œè¯åº¦è©•åˆ†å’Œé—œè¯åŸå› 
2. **è¦–è¦ºåŒ–é—œä¿‚åœ–**ï¼šæä¾›äº‹ä»¶é—œä¿‚çš„ç¶²çµ¡åœ–æˆ–æ¨¹ç‹€åœ–è¦–è¦ºåŒ–
3. **æ™ºèƒ½åˆ†çµ„**ï¼šæŒ‰é—œè¯é¡å‹ï¼ˆæ™‚é–“ã€è³‡æºã€æ‹“æ’²ã€AI æ¨è–¦ï¼‰è‡ªå‹•åˆ†çµ„
4. **æ‰¹æ¬¡æ“ä½œ**ï¼šæ”¯æ´å°ç›¸é—œäº‹ä»¶çš„æ‰¹æ¬¡æ“ä½œï¼ˆæ‰¹æ¬¡ç¢ºèªã€åˆ†é…ç­‰ï¼‰
5. **æ ¹å› åˆ†æ**ï¼šæ•´åˆ AI åˆ†æï¼Œè­˜åˆ¥å¯èƒ½çš„æ ¹æœ¬åŸå› äº‹ä»¶
6. **äº‹ä»¶éˆè¿½è¹¤**ï¼šé¡¯ç¤ºäº‹ä»¶çš„å®Œæ•´å½±éŸ¿éˆå’Œå‚³æ’­è·¯å¾‘

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚é—œè¯åˆ†ææ˜¯å¾ã€Œå–®é»å‘Šè­¦ã€é‚å‘ã€Œç³»çµ±æ€§æ•…éšœåˆ†æã€çš„é—œéµä¸€æ­¥ï¼Œæ˜¯å¯¦ç¾å‘Šè­¦é™å™ªã€å‡¸é¡¯æ•…éšœå‚³æ’­éˆçš„æ ¸å¿ƒåŠŸèƒ½ã€‚æ­¤è™•çš„ç›®æ¨™æ˜¯æä¾›ä¸€å€‹**è‡ªå‹•åŒ–çš„æ±ºç­–æ”¯æ´å·¥å…·**ï¼Œæœ€çµ‚å¼•å° SRE å°‡ä¸€çµ„ç›¸é—œçš„ä½éšäº‹ä»¶ï¼Œåˆä½µç‚ºä¸€å€‹éœ€è¦é›†ä¸­è™•ç†çš„é«˜éš**ã€Œäº‹æ•… (Incident)ã€**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **ã€Œäº‹æ•… (Incident)ã€æŠ½è±¡å±¤**:
    *   ç‚ºç®¡ç†ä¸€çµ„é—œè¯äº‹ä»¶ï¼Œå¾Œç«¯å¿…é ˆå¼•å…¥ä¸€å€‹æ›´é«˜å±¤ç´šçš„**ã€Œäº‹æ•… (Incident)ã€è³‡æ–™æ¨¡å‹**ã€‚é€™æ˜¯å¾è¢«å‹•éŸ¿æ‡‰è½‰å‘ä¸»å‹•ç®¡ç†çš„é—œéµã€‚
    *   `incidents` è¡¨æ‡‰åŒ…å« `title`, `status`, `severity`, `assignee_id` ç­‰æ¬„ä½ï¼Œä¸¦é€éä¸€å€‹é—œè¯è¡¨ (e.g., `incident_events`) é€£çµå¤šå€‹ `event_id`ã€‚
    *   `POST /api/v1/incidents`: æ­¤ API ç”¨æ–¼**äº‹ä»¶åˆä½µ**æˆ–**äº‹æ•…å‡ç´š**ã€‚
        *   **Request Body**:
            ```json
            {
              "title": "è³‡æ–™åº«æ•ˆèƒ½ä¸‹é™äº‹æ•…",
              "severity": "CRITICAL",
              "assignee_id": "usr_1a2b3c",
              "event_ids": ["evt_2a7d3e9f", "evt_aaa", "evt_bbb"]
            }
            ```
        *   **å¾Œç«¯é‚è¼¯**: å»ºç«‹ `incident` è¨˜éŒ„å¾Œï¼Œå¾Œç«¯æ‡‰å°‡æ‰€æœ‰å‚³å…¥çš„ `event_ids` å°æ‡‰çš„äº‹ä»¶ç‹€æ…‹æ›´æ–°ç‚º `MERGED`ï¼Œä¸¦å°‡å®ƒå€‘å¾ä¸»è¦çš„äº‹ä»¶åˆ—è¡¨ä¸­éæ¿¾æ‰ï¼Œä»¥é”åˆ°é™å™ªç›®çš„ã€‚

2.  **éåŒæ­¥é—œè¯å¼•æ“ (Async Correlation Engine)**ï¼š
    *   ç‚ºæ‰¾å‡ºå“ªäº›äº‹ä»¶æ‡‰è¢«é—œè¯ï¼Œå¾Œç«¯ AI æœå‹™çš„æ ¸å¿ƒæ˜¯ä¸€å€‹**éåŒæ­¥çš„é—œè¯å¼•æ“**ã€‚ç•¶æ–°äº‹ä»¶è¢«è™•ç†æ™‚ï¼Œè©²å¼•æ“æœƒè¢«è§¸ç™¼ï¼ŒåŸºæ–¼å¤šç¨®ç­–ç•¥é€²è¡Œè¨ˆç®—ï¼š
        *   **æ™‚é–“é—œè¯ (Time Correlation)**: äº‹ä»¶åœ¨æ¥µçŸ­æ™‚é–“çª—å£å…§ç™¼ç”Ÿã€‚
        *   **æ‹“æ’²é—œè¯ (Topology Correlation)**: åŸºæ–¼ CMDB ä¸­çš„æœå‹™ä¾è³´é—œä¿‚ï¼ˆä¸Šæ¸¸/ä¸‹æ¸¸ï¼‰ã€‚
        *   **å…§å®¹é—œè¯ (Content Correlation)**: åŸºæ–¼äº‹ä»¶æ¨™ç±¤æˆ–æ‘˜è¦çš„ç›¸ä¼¼æ€§ã€‚
        *   **æ©Ÿå™¨å­¸ç¿’ (Machine Learning)**: åŸºæ–¼æ­·å²æ•¸æ“šå­¸ç¿’åˆ°çš„å…±ç¾æ¨¡å¼ã€‚
    *   è¨ˆç®—çµæœâ€”â€”åŒ…å«é—œè¯çš„ `event_id`ã€**é—œè¯é¡å‹** (`type`) å’Œ**ç½®ä¿¡åº¦** (`confidence`)â€”â€”å¿…é ˆè¢«**é å…ˆè¨ˆç®—ä¸¦å„²å­˜**åœ¨ä¸€å¼µå°ˆé–€çš„ `event_correlations` è¡¨ä¸­ã€‚

3.  **`GET /api/v1/events/{id}` - `related_events` Payload**:
    æ­¤ API **çµ•ä¸èƒ½**å³æ™‚è¨ˆç®—é—œè¯æ€§ï¼Œè€Œæ‡‰ç›´æ¥æŸ¥è©¢é å…ˆè¨ˆç®—å¥½çš„ `event_correlations` è¡¨ï¼Œä»¥ä¿è­‰å½ˆçª—çš„å¿«é€ŸéŸ¿æ‡‰ã€‚å…¶å›å‚³çš„ `related_events` é™£åˆ—æ‡‰æœ‰æ¸…æ™°çš„çµæ§‹ï¼ŒåŒ…å«é—œè¯çš„åŸå› å’Œç½®ä¿¡åº¦ã€‚

    ```json
    "related_events": [
      {
        "id": "evt_aaa",
        "summary": "API latency over 500ms",
        "severity": "WARNING",
        "status": "ACKNOWLEDGED",
        "triggered_at": "2025-09-18T11:08:43Z",
        "correlation_reason": {
          "type": "TOPOLOGY_DOWNSTREAM",
          "description": "æ­¤æœå‹™æ˜¯ db-mysql-prod-02 çš„ä¸‹æ¸¸ä¾è³´ã€‚",
          "confidence_score": 0.95
        }
      }
      // ... more related events
    ]
    ```

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **å°‡äº‹ä»¶ç¾¤çµ„æå‡ç‚ºã€Œäº‹æ•…ã€ (Elevate Group to Incident)**: é€™æ˜¯æ­¤åˆ†é çš„**æ ¸å¿ƒå·¥ä½œæµç¨‹**ã€‚
    *   **UI è¨­è¨ˆ**: å¿…é ˆç‚ºæ¯å€‹é—œè¯äº‹ä»¶æä¾›**æ ¸å–æ–¹å¡Š**ï¼Œä¸¦åœ¨åº•éƒ¨æä¾›ä¸€å€‹é†’ç›®çš„ã€Œ**åˆä½µç‚ºäº‹æ•…**ã€æŒ‰éˆ•ã€‚æ­¤æŒ‰éˆ•åœ¨æ²’æœ‰é¸ä¸­ä»»ä½•äº‹ä»¶æ™‚æ‡‰ç‚ºç¦ç”¨ç‹€æ…‹ï¼Œå…¶æ–‡å­—æ‡‰å‹•æ…‹æ›´æ–°ä»¥åæ˜ é¸ä¸­æ•¸é‡ï¼Œä¾‹å¦‚ã€Œ**åˆä½µ 3 å€‹äº‹ä»¶ç‚ºäº‹æ•…**ã€ã€‚
    *   **æ“ä½œæµç¨‹**: é»æ“Šå¾Œï¼Œå½ˆå‡ºä¸€å€‹æ–°å°è©±æ¡†ï¼Œè®“ä½¿ç”¨è€…ç‚ºæ–°äº‹æ•…å‘½åã€è¨­å®šåš´é‡ç­‰ç´šå’ŒæŒ‡æ´¾è™•ç†äººï¼Œä¸¦æä¾›åŸºæ–¼é—œè¯äº‹ä»¶æ™ºæ…§ç”Ÿæˆçš„åˆç†é è¨­å€¼ã€‚

2.  **è§£é‡‹ã€Œç‚ºä½•ç›¸é—œã€ (Explain "Why")**: é€™æ˜¯å»ºç«‹ä½¿ç”¨è€…ä¿¡ä»»çš„é—œéµã€‚UI ä¸èƒ½åªæ˜¯ä¸€å€‹åˆ—è¡¨ã€‚å¿…é ˆåœ¨æ¯å€‹é—œè¯äº‹ä»¶æ—ï¼Œç”¨ä¸€å€‹**æ¸…æ™°çš„åœ–ç¤ºå’Œæ–‡å­—æ¨™ç±¤**ä¾†è§£é‡‹å…¶é—œè¯ä¾æ“šï¼ˆä¾‹å¦‚ï¼Œæ‹“æ’²åœ–ç¤º +ã€Œä¸‹æ¸¸æœå‹™ã€ï¼Œæ™‚é˜åœ–ç¤º +ã€Œæ™‚é–“ç›¸è¿‘ (1må…§)ã€ï¼ŒAI åœ–ç¤º +ã€ŒAI æ¨è–¦ (92%)ã€ï¼‰ã€‚æ»‘é¼ æ‡¸åœåœ¨æ¨™ç±¤ä¸Šæ™‚ï¼Œæ‡‰æœ‰å·¥å…·æç¤º (Tooltip) é¡¯ç¤ºå®Œæ•´çš„ `description`ã€‚

3.  **è¦–è¦ºåŒ–æ‹“æ’²æ·å¾‘ (Visual Topology Shortcut)**: ç•¶é—œè¯åŸå› æ˜¯ `TOPOLOGY_DOWNSTREAM` æˆ– `TOPOLOGY_UPSTREAM` æ™‚ï¼Œæ‡‰åœ¨è©²æ¢ç›®æ—é¡¯ç¤ºä¸€å€‹ã€Œæª¢è¦–æ‹“æ’²ã€çš„åœ–ç¤ºæŒ‰éˆ•ã€‚é»æ“Šå¾Œï¼Œåœ¨å½ˆçª—å…§é–‹å•Ÿä¸€å€‹å°å‹çš„ã€èšç„¦çš„æ‹“æ’²åœ–ï¼Œé«˜äº®é¡¯ç¤ºç›¸é—œç¯€é»å’Œæ¨æ¸¬çš„æ•…éšœè·¯å¾‘ã€‚é€™é æ¯”ç´”æ–‡å­—åˆ—è¡¨ç›´è§€ã€‚

#### äº‹ä»¶è©³æƒ…å½ˆçª— - è‡ªå‹•åŒ– [äº‹ä»¶è©³æƒ…4-è‡ªå‹•åŒ–](images/16-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-äº‹ä»¶è©³æƒ…4-è‡ªå‹•åŒ–.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è©³æƒ…å½ˆçª—çš„ã€Œè‡ªå‹•åŒ–ã€é ç±¤
- é¡¯ç¤ºèˆ‡æ­¤äº‹ä»¶ç›¸é—œè¯çš„è‡ªå‹•åŒ–è…³æœ¬åŸ·è¡Œæƒ…æ³

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/events/{id}/automations` - ç²å–é‡å°æ­¤äº‹ä»¶å·²åŸ·è¡Œçš„è‡ªå‹•åŒ–æ­·å²

**UX æ”¹å–„å»ºè­°**ï¼š
1. **åŸ·è¡Œç‹€æ…‹è¦–è¦ºåŒ–**ï¼šä½¿ç”¨é€²åº¦æ¢å’Œç‹€æ…‹åœ–ç¤ºæ¸…æ¥šé¡¯ç¤ºè‡ªå‹•åŒ–åŸ·è¡Œç‹€æ…‹
2. **è¼¸å‡ºæ—¥èªŒé è¦½**ï¼šæä¾›è‡ªå‹•åŒ–è…³æœ¬è¼¸å‡ºæ—¥èªŒçš„å¿«é€Ÿé è¦½å’Œå®Œæ•´æŸ¥çœ‹
3. **é‡æ–°åŸ·è¡ŒåŠŸèƒ½**ï¼šæ”¯æ´å°å¤±æ•—çš„è‡ªå‹•åŒ–ä»»å‹™é€²è¡Œé‡æ–°åŸ·è¡Œ
4. **åƒæ•¸èª¿æ•´**ï¼šå…è¨±åœ¨é‡æ–°åŸ·è¡Œæ™‚èª¿æ•´è‡ªå‹•åŒ–åƒæ•¸
5. **å½±éŸ¿è©•ä¼°**ï¼šé¡¯ç¤ºè‡ªå‹•åŒ–åŸ·è¡Œå°äº‹ä»¶ç‹€æ…‹å’Œç³»çµ±çš„å½±éŸ¿
6. **åŸ·è¡Œæ™‚é–“åˆ†æ**ï¼šæä¾›è‡ªå‹•åŒ–åŸ·è¡Œæ™‚é–“çš„çµ±è¨ˆå’Œå„ªåŒ–å»ºè­°

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚æ­¤åˆ†é æ—¨åœ¨å°‡ã€Œåµæ¸¬ã€èˆ‡ã€Œä¿®å¾©ã€é–‰ç’°ï¼Œç¾æœ‰çš„åˆ†æå·²æº–ç¢ºåœ°æŒ‡å‡ºäº†å…¶æ ¸å¿ƒç›®æ¨™ï¼šå¿…é ˆç„¡ç¸«åœ°èåˆéå»çš„åŸ·è¡Œè¨˜éŒ„èˆ‡æœªä¾†çš„æ“ä½œå¯èƒ½æ€§ï¼Œå°‡ä¸€å€‹ç°¡å–®çš„æ—¥èªŒè½‰è®Šç‚ºäº’å‹•å¼çš„æ§åˆ¶å°ã€‚ä»¥ä¸‹ç¶“æˆ‘ç¢ºèªä¸¦å¼·åŒ–çš„è¨­è¨ˆæ˜¯å¯¦ç¾æ­¤ç›®æ¨™çš„æ­£ç¢ºè—åœ–ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **æ•¸æ“šæ¨¡å‹é—œè¯**: å¾Œç«¯çš„ `execution_logs` è¡¨**å¿…é ˆ**æœ‰ä¸€å€‹å¯ç‚ºç©ºçš„ `event_id` æ¬„ä½ï¼Œç”¨ä»¥æ¸…æ™°åœ°é—œè¯æŸæ¬¡è‡ªå‹•åŒ–åŸ·è¡Œèˆ‡è§¸ç™¼å®ƒçš„äº‹ä»¶ã€‚

2.  **API è¨­è¨ˆ - åˆ†é›¢ã€Œå·²åŸ·è¡Œã€èˆ‡ã€Œæ¨è–¦ã€**:
    æ­¤åˆ†é çš„è³‡æ–™æ‡‰ä¾†è‡ªå…©å€‹å¹³è¡Œçš„ã€ç¨ç«‹çš„ API å‘¼å«ï¼Œä»¥å„ªåŒ–è¼‰å…¥é«”é©—ã€‚

    *   **å·²åŸ·è¡Œè¨˜éŒ„**: `GET /api/v1/events/{id}/automation-runs`
        æ­¤ API ç”¨æ–¼ç²å–å·²é‡å°æ­¤äº‹ä»¶åŸ·è¡Œçš„è‡ªå‹•åŒ–æ­·å²ã€‚
        ```json
        {
          "automation_runs": [
            {
              "run_id": "exec_123",
              "script_id": "scr_abc",
              "script_name": "æ¸…é™¤ /tmp ç›®éŒ„ç©ºé–“",
              "status": "SUCCESS",
              "triggered_by": "rule:rule_e7f8g9",
              "started_at": "2025-09-18T11:12:05Z",
              "duration_ms": 15300,
              "summary_log": "æˆåŠŸé‡‹æ”¾ 1.5GB ç£ç¢Ÿç©ºé–“ã€‚"
            }
          ]
        }
        ```

    *   **æ¨è–¦çš„è‡ªå‹•åŒ–**: `GET /api/v1/events/{id}/recommended-automations`
        æ­¤ API ç”± AI ä»£ç†é©…å‹•ï¼Œå®ƒåˆ†æäº‹ä»¶çš„ä¸Šä¸‹æ–‡ï¼ˆæ¨™ç±¤ã€æ‘˜è¦ç­‰ï¼‰ï¼Œä¸¦å¾è…³æœ¬åº«ä¸­æ¨è–¦æœ€ç›¸é—œçš„è…³æœ¬ã€‚
        ```json
        {
          "recommended_automations": [
            {
              "script_id": "scr_def",
              "script_name": "é‡å•Ÿè³‡æ–™åº«é€£æ¥æ± ",
              "description": "é©ç”¨æ–¼è³‡æ–™åº«é€£ç·šéŒ¯èª¤ç›¸é—œäº‹ä»¶ã€‚",
              "confidence_score": 0.85
            },
            {
              "script_id": "scr_ghi",
              "script_name": "åˆ†ææ…¢æŸ¥è©¢æ—¥èªŒ",
              "description": "é©ç”¨æ–¼ CPU æˆ–è³‡æ–™åº«å»¶é²äº‹ä»¶ã€‚",
              "confidence_score": 0.78
            }
          ]
        }
        ```

3.  **æ‰‹å‹•è§¸ç™¼ API**:
    *   `POST /api/v1/scripts/{script_id}/execute`
    *   æ­¤ API å…è¨±ä½¿ç”¨è€…å¾ UI æ‰‹å‹•è§¸ç™¼ä¸€å€‹è…³æœ¬ã€‚
    *   **Request Body**:
        ```json
        {
          "context": {
            "event_id": "evt_2a7d3e9f"
          },
          "parameters": {
            "target_host": "db-mysql-prod-02",
            "force_mode": false
          }
        }
        ```

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **è®“ç©ºç‹€æ…‹è®Šå¾—æ™ºæ…§ä¸”å¯æ“ä½œ (Make the Empty State Smart & Actionable)**:
    ç›®å‰çš„ç©ºç‹€æ…‹æ˜¯å€‹æ­»èƒ¡åŒï¼Œæ‡‰å°‡å…¶é‡æ–°è¨­è¨ˆç‚ºä¸€å€‹ç™¼å°„å°ã€‚
    *   **ç„¡åŸ·è¡Œè¨˜éŒ„ï¼Œä½†æœ‰æ¨è–¦**: ä¸»è¦è¦–åœ–æ‡‰ç›´æ¥é¡¯ç¤º**æ¨è–¦çš„è‡ªå‹•åŒ–è…³æœ¬åˆ—è¡¨**ï¼Œæ¯å€‹æ¨è–¦é …æ—éƒ½æœ‰ä¸€å€‹ã€ŒåŸ·è¡Œã€æŒ‰éˆ•ã€‚
    *   **ç„¡åŸ·è¡Œè¨˜éŒ„ï¼Œäº¦ç„¡æ¨è–¦**: UI æ‡‰é¡¯ç¤ºã€Œæ­¤äº‹ä»¶æœªè§¸ç™¼è‡ªå‹•åŒ–è…³æœ¬ï¼Œä¹Ÿæœªæ‰¾åˆ°æ¨è–¦è…³æœ¬ã€‚ã€ï¼Œä¸¦ç·Šéš¨å…©å€‹æ˜ç¢ºçš„è¡Œå‹•å‘¼ç±² (Call-to-Action) æŒ‰éˆ•ï¼šã€Œ**æ‰‹å‹•åŸ·è¡Œè…³æœ¬**ã€ï¼ˆé–‹å•Ÿä¸€å€‹æœå°‹å°è©±æ¡†ä»¥é¸æ“‡è…³æœ¬ï¼‰å’Œã€Œ**è¨­å®šè‡ªå‹•åŒ–è¦å‰‡**ã€ï¼ˆå°èˆªè‡³äº‹ä»¶è¦å‰‡å»ºç«‹é é¢ï¼Œä¸¦é å…ˆå¡«å…¥ç•¶å‰äº‹ä»¶çš„ä¸Šä¸‹æ–‡ï¼‰ã€‚

2.  **è±å¯ŒåŒ–çš„åŸ·è¡Œè¨˜éŒ„ (Rich Execution History)**:
    ç•¶ `automation_runs` åˆ—è¡¨ä¸ç‚ºç©ºæ™‚ï¼Œæ¯å€‹æ¢ç›®éƒ½æ‡‰æ˜¯ä¸€å€‹å¯å±•é–‹çš„å…ƒä»¶ã€‚
    *   **æ”¶åˆè¦–åœ–**: é¡¯ç¤ºé—œéµè³‡è¨Šï¼šè…³æœ¬åç¨±ã€ç‹€æ…‹åœ–ç¤ºã€è§¸ç™¼åŸå› å’Œæ™‚é–“æˆ³ã€‚
    *   **å±•é–‹è¦–åœ–**: é»æ“Šå¾Œå±•é–‹ï¼Œä¸¦ä»¥åˆ†é é¡¯ç¤ºæ›´è©³ç´°çš„è³‡è¨Šï¼š
        *   **æ‘˜è¦ (Summary)**: é¡¯ç¤º `summary_log`ã€‚
        *   **åƒæ•¸ (Parameters)**: é¡¯ç¤ºæ­¤æ¬¡åŸ·è¡Œçš„å…·é«”åƒæ•¸ã€‚
        *   **å®Œæ•´æ—¥èªŒ (Full Log)**: é¡¯ç¤ºå®Œæ•´çš„ã€å¯æœå°‹çš„åŸ·è¡Œæ—¥èªŒè¼¸å‡ºã€‚
        *   **æ“ä½œ (Actions)**: æä¾›ä¸€å€‹ã€Œ**é‡æ–°åŸ·è¡Œ**ã€æŒ‰éˆ•ã€‚

é€™ç¨®æ–¹æ³•å°‡æ­¤åˆ†é å¾ä¸€å€‹è¢«å‹•çš„æ—¥èªŒæª¢è¦–å™¨ï¼Œè½‰è®Šç‚º SRE å·¥ä½œæµç¨‹ä¸­ä¸€å€‹ä¸»å‹•çš„ã€æ™ºæ…§åŒ–çš„éƒ¨åˆ†ï¼Œæ˜¯æå‡å¹³å°åƒ¹å€¼çš„é—œéµã€‚

#### AI äº‹ä»¶åˆ†æå ±å‘Š [AIäº‹ä»¶åˆ†æå ±å‘Š](images/17-å½ˆçª—-äº‹ä»¶åˆ—è¡¨-AIäº‹ä»¶åˆ†æå ±å‘Š.png)

**åŠŸèƒ½æè¿°**ï¼š
- AIé©…å‹•çš„äº‹ä»¶åˆ†ææ¨¡æ…‹å°è©±æ¡†
- äº‹ä»¶è©³æƒ…é¡¯ç¤ºï¼šåˆ†æäº‹ä»¶ã€åš´é‡æ€§ç­‰ç´š
- æ ¹æœ¬åŸå› åˆ†æ (RCA) èˆ‡ç½®ä¿¡åº¦è©•åˆ†

**ç›¸é—œ API ç«¯é»**ï¼š
- `POST /api/v1/events/{id}/ai-analysis` - è§¸ç™¼AIåˆ†æ
- `GET /api/v1/ai/analysis-reports/{report_id}` - ç²å–åˆ†æå ±å‘Š

**UX æ”¹å–„å»ºè­°**ï¼š
1. **ç½®ä¿¡åº¦å¯è¦–åŒ–**ï¼šä½¿ç”¨é€²åº¦æ¢æˆ–è‰²å½©ç·¨ç¢¼é¡¯ç¤ºåˆ†æçµæœçš„ç½®ä¿¡åº¦
2. **äº’å‹•å¼åˆ†æ**ï¼šæ”¯æ´ç”¨æˆ¶å°åˆ†æçµæœæä¾›åé¥‹ï¼Œæ”¹å–„ AI æº–ç¢ºæ€§
3. **å¤šèªè¨€æ”¯æ´**ï¼šæ”¯æ´åˆ†æå ±å‘Šçš„å¤šèªè¨€é¡¯ç¤º
4. **ç›¸ä¼¼æ¡ˆä¾‹**ï¼šé¡¯ç¤ºæ­·å²ä¸Šç›¸ä¼¼äº‹ä»¶çš„è™•ç†æ–¹æ¡ˆå’Œçµæœ
5. **å»ºè­°æ“ä½œ**ï¼šåŸºæ–¼åˆ†æçµæœæä¾›å…·é«”çš„æ“ä½œå»ºè­°å’Œå„ªå…ˆé †åº
6. **å ±å‘Šå°å‡º**ï¼šæ”¯æ´å°‡åˆ†æå ±å‘Šå°å‡ºç‚º PDF æˆ–åˆ†äº«é€£çµ

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤ AI åˆ†æå ±å‘Šçš„è¨­è¨ˆã€‚é€™æ˜¯å±•ç¤ºå¹³å°æ™ºæ…§åŒ–èƒ½åŠ›çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå…¶æˆæ•—é—œéµåœ¨æ–¼å…©é»ï¼š**1) å°‡åŸå§‹æ•¸æ“šè½‰åŒ–ç‚ºå¯è¡Œå‹•çš„æ´å¯Ÿ**ï¼Œä»¥åŠ **2) é€éé€æ˜åº¦èˆ‡å¯é©—è­‰æ€§ä¾†å»ºç«‹ä½¿ç”¨è€…çš„ä¿¡ä»»**ã€‚ç¾æœ‰çš„åˆ†æå·²ç¶“å®Œç¾åœ°æ•æ‰äº†é€™å…©é»ï¼Œæˆ‘å°‡å…¶è¨­è¨ˆç´°ç¯€ç¢ºèªä¸¦å›ºåŒ–å¦‚ä¸‹ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **éåŒæ­¥åˆ†ææµç¨‹ (Asynchronous Analysis Flow)**:
    *   **ç¬¬ä¸€æ­¥ï¼šè§¸ç™¼åˆ†æ**: ä½¿ç”¨è€…é»æ“Šã€ŒAI åˆ†æã€æŒ‰éˆ•ï¼Œå‘¼å« `POST /api/v1/events/{id}/ai-analysis`ã€‚æ­¤ç«¯é»æ‡‰ç«‹å³å›å‚³ `202 Accepted` åŠä¸€å€‹ `report_id`ï¼Œä¸¦åœ¨èƒŒæ™¯å•Ÿå‹•ä¸€å€‹éåŒæ­¥çš„åˆ†æä»»å‹™ã€‚æ­¤è¨­è¨ˆç¢ºä¿äº†å³ä½¿åˆ†æè€—æ™‚è¼ƒé•·ï¼Œä½¿ç”¨è€…ä»‹é¢ä¹Ÿä¸æœƒè¢«å‡çµã€‚
        ```json
        // POST /api/v1/events/{id}/ai-analysis -> 202 Accepted
        {
          "report_id": "rep_a1b2c3",
          "status": "PENDING"
        }
        ```
    *   **ç¬¬äºŒæ­¥ï¼šç²å–å ±å‘Š**: å‰ç«¯ä½¿ç”¨ `report_id` ä¾†è¼ªè©¢ `GET /api/v1/ai/analysis-reports/{report_id}`ã€‚æ­¤ç«¯é»å°‡å›å‚³å ±å‘Šç‹€æ…‹ (`PENDING`, `RUNNING`, `SUCCESS`, `FAILED`)ã€‚ç•¶ç‹€æ…‹ç‚º `SUCCESS` æ™‚ï¼Œå‰‡ä¸€ä½µå›å‚³å®Œæ•´çš„å ±å‘Šå…§å®¹ã€‚ï¼ˆæˆ–å¯ä½¿ç”¨ WebSocket å°‡çµæœä¸»å‹•æ¨é€è‡³å‰ç«¯ï¼‰ã€‚

2.  **`GET /api/v1/ai/analysis-reports/{report_id}` - çµæ§‹åŒ– Payload**:
    å ±å‘Šçš„ Payload å¿…é ˆæ˜¯é«˜åº¦çµæ§‹åŒ–çš„ï¼Œä»¥é©…å‹• UI çš„å‘ˆç¾ã€‚å…¶ä¸­çš„ `evidence` å’Œ `recommended_actions` æ˜¯å»ºç«‹ä¿¡ä»»å’Œå¯¦ç¾å¯æ“ä½œæ€§çš„é—œéµã€‚

    ```json
    {
      "report_id": "rep_a1b2c3",
      "status": "SUCCESS",
      "generated_at": "2025-09-18T11:20:00Z",
      "event_summary": "API latency over 500ms",
      "root_cause_analysis": {
        "text": "æ ¹æœ¬åŸå› å¾ˆå¯èƒ½åœ¨æ–¼ 'user-authentication' æœå‹™ä¸­çš„å…§å­˜æ´©æ¼ï¼Œå°è‡´ä¸‹æ¸¸æœå‹™çš„é€£é–æ•…éšœã€‚",
        "confidence_score": 0.85,
        "evidence": [
          {
            "type": "METRIC",
            "description": "æŒ‡æ¨™ 'user-authentication_memory_usage' å‘ˆç¾ç•°å¸¸å¢é•·ã€‚",
            "link": {
              "name": "æŸ¥çœ‹æŒ‡æ¨™åœ–è¡¨",
              "url": "/dashboards/d/xyz?var-service=user-authentication"
            }
          }
        ]
      },
      "impact_assessment": {
        "text": "å°ç”¨æˆ¶ç™»éŒ„å’Œè¨»å†ŠåŠŸèƒ½é€ æˆåš´é‡å½±éŸ¿ã€‚ç”¨æˆ¶æ•¸æ“šåº«å¯èƒ½å­˜åœ¨æ•¸æ“šä¸ä¸€è‡´çš„é¢¨éšªã€‚",
        "affected_resources": [
          { "id": "res_abc", "name": "user-authentication-svc" },
          { "id": "res_def", "name": "login-gateway" }
        ]
      },
      "recommended_actions": [
        {
          "title": "ç«‹å³é‡å•Ÿ 'user-authentication' æœå‹™",
          "action_type": "AUTOMATION",
          "risk": "HIGH",
          "action_data": {
            "script_id": "scr_restart_service",
            "parameters": { "service_name": "user-authentication" }
          }
        },
        {
          "title": "æª¢æŸ¥ db-prod-01 æ—¥èªŒ",
          "action_type": "LINK",
          "risk": "LOW",
          "action_data": { "url": "/logs?query={resource='db-prod-01'}" }
        }
      ]
    }
    ```

3.  **ä½¿ç”¨è€…åé¥‹è¿´è·¯ API (User Feedback Loop API)**:
    *   `POST /api/v1/ai/analysis-reports/{report_id}/feedback`: æ­¤ API å°æ–¼é€é RLHF (Reinforcement Learning from Human Feedback) ä¾†å„ªåŒ– AI æ¨¡å‹è‡³é—œé‡è¦ã€‚
    *   **Request Body**:
        ```json
        {
          "is_helpful": true, // or false
          "correct_action_key": "rollback_deployment", // å¯é¸ï¼šå“ªå€‹æ“ä½œæ˜¯æ­£ç¢ºçš„ï¼Ÿ
          "comment": "æ ¹æœ¬åŸå› æ­£ç¢ºï¼Œä½†é‡å•Ÿä¸æ˜¯æœ€ä½³æ–¹æ¡ˆã€‚" // å¯é¸
        }
        ```

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **é€æ˜åº¦èˆ‡å¯ä¿¡åº¦ (Transparency & Trust)**:
    *   **å±•ç¤ºè­‰æ“š (Show, Don't Just Tell)**: RCA å’Œå½±éŸ¿è©•ä¼°å€å¡Šä¸æ‡‰åªæœ‰æ–‡å­—ã€‚å®ƒå€‘**å¿…é ˆ**é™„å¸¶å¯é»æ“Šçš„**è­‰æ“šé€£çµ**ï¼ˆç”± API Payload ä¸­çš„ `evidence` é©…å‹•ï¼‰ã€‚é€™ä½¿å¾— SRE èƒ½å¤ è¼•æ˜“é©—è­‰ AI çš„çµè«–ï¼Œå¾è€Œå»ºç«‹å°ç³»çµ±çš„ä¿¡ä»»ã€‚
    *   **è¦–è¦ºåŒ–ç½®ä¿¡åº¦**: ç½®ä¿¡åº¦åˆ†æ•¸ï¼ˆå¦‚ 85%ï¼‰æ‡‰è©²ç”¨é€²åº¦æ¢æˆ–å„€è¡¨ç›¤ç­‰è¦–è¦ºåŒ–å…ƒä»¶ä¾†å‘ˆç¾ï¼Œè€Œéç´”æ–‡å­—ã€‚

2.  **å¯æ“ä½œçš„å»ºè­° (Actionable Recommendations)**:
    *   **æ•¸æ“šé©…å‹•çš„æŒ‰éˆ•**: æ¯å€‹å»ºè­°æ“ä½œæ—é‚Šçš„æŒ‰éˆ•å¿…é ˆå®Œå…¨ç”± `recommended_actions` é™£åˆ—é©…å‹•ã€‚`AUTOMATION` é¡å‹çš„æŒ‰éˆ•è§¸ç™¼è…³æœ¬åŸ·è¡Œæµç¨‹ï¼Œè€Œ `LINK` é¡å‹å‰‡å¼•å°ä½¿ç”¨è€…è·³è½‰ã€‚
    *   **é¢¨éšªæ¨™ç¤º**: æ¯å€‹æ“ä½œéƒ½æ‡‰è¢«è¦–è¦ºåŒ–åœ°æ¨™è¨˜å…¶ `risk` ç­‰ç´šï¼ˆä¾‹å¦‚ï¼Œé«˜é¢¨éšªæ“ä½œå¦‚ã€Œé‡å•Ÿã€æ‡‰ä½¿ç”¨ç´…è‰²ä¸”æ›´é†’ç›®çš„æŒ‰éˆ•æ¨£å¼ï¼‰ï¼Œä»¥å¹«åŠ©ä½¿ç”¨è€…åšå‡ºæ˜æ™ºçš„æ±ºç­–ã€‚

3.  **åé¥‹æ©Ÿåˆ¶ (Feedback Mechanism)**:
    *   åœ¨å ±å‘Šçš„åº•éƒ¨ï¼Œå¿…é ˆæœ‰ä¸€å€‹ç°¡å–®æ˜ç­çš„åé¥‹æ©Ÿåˆ¶ï¼ˆä¾‹å¦‚ï¼Œã€Œé€™å€‹åˆ†ææœ‰å¹«åŠ©å—ï¼Ÿ ğŸ‘ / ğŸ‘ã€ï¼‰ã€‚æ•ç²é€™äº›åé¥‹å°æ–¼ AI æ¨¡å‹çš„é•·æœŸæ”¹é€²è‡³é—œé‡è¦ã€‚

ç¸½ä¹‹ï¼Œæ­¤åŠŸèƒ½çš„è¨­è¨ˆæ‡‰å°‡ AI å¾ä¸€å€‹ã€Œé»‘ç›’å­ã€è½‰è®Šç‚ºä¸€å€‹é€æ˜ã€å¯é©—è­‰ã€å¯æ“ä½œçš„ SRE åŠ©æ‰‹ã€‚

#### å»ºç«‹éœéŸ³ [å»ºç«‹éœéŸ³](images/18-å½ˆçª—-äº‹ä»¶è¦å‰‡-å»ºç«‹éœéŸ³.png)

**åŠŸèƒ½æè¿°**ï¼š
- å¾å…·é«”æ´»èºäº‹ä»¶å¿«é€Ÿå»ºç«‹è‡¨æ™‚éœéŸ³è¦å‰‡çš„å½ˆçª—
- é¡¯ç¤ºè¦éœéŸ³çš„äº‹ä»¶åŸºæœ¬è³‡è¨Šä¾›ç¢ºèª
- æä¾›é è¨­çš„éœéŸ³æ™‚é•·é¸é …

**ç›¸é—œ API ç«¯é»**ï¼š
- `POST /api/v1/silence-rules` - å»ºç«‹æ–°çš„éœéŸ³è¦å‰‡

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¿«é€Ÿé¸é …**ï¼šæä¾›å¸¸ç”¨éœéŸ³æ™‚é•·çš„å¿«é€Ÿé¸æ“‡æŒ‰éˆ•ï¼ˆ15åˆ†é˜ã€1å°æ™‚ã€4å°æ™‚ã€24å°æ™‚ï¼‰
2. **å½±éŸ¿é è¦½**ï¼šé¡¯ç¤ºéœéŸ³è¦å‰‡å°‡å½±éŸ¿çš„å…¶ä»–ç›¸é—œäº‹ä»¶æ•¸é‡
3. **ç¯„åœé©—è­‰**ï¼šå³æ™‚é©—è­‰éœéŸ³è¦å‰‡çš„åŒ¹é…ç¯„åœï¼Œé¿å…éåº¦éœéŸ³
4. **å®šæ™‚æé†’**ï¼šæ”¯æ´è¨­å®šéœéŸ³åˆ°æœŸå‰çš„æé†’é€šçŸ¥
5. **åŸå› è¨˜éŒ„**ï¼šè¦æ±‚æˆ–å»ºè­°å¡«å¯«éœéŸ³åŸå› ï¼Œä¾¿æ–¼å¾ŒçºŒè¿½è¹¤å’Œåˆ†æ

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚æ­¤å°è©±æ¡†æ˜¯ SRE ç‚ºæ‡‰å°å‘Šè­¦æˆ–è¨ˆåŠƒæ€§ç¶­è­·è€Œæš«æ™‚é™å™ªçš„é—œéµã€é«˜é »å·¥ä½œæµç¨‹ã€‚å…¶è¨­è¨ˆå¿…é ˆå¿«é€Ÿã€æ¸…æ™°ä¸”å®‰å…¨ã€‚ç¾æœ‰çš„åˆ†ææº–ç¢ºåœ°æŒ‡å‡ºäº†å…¶æ ¸å¿ƒæ¶æ§‹ï¼šä½œç‚º Grafana API çš„ä¸€å€‹æ™ºæ…§ä»£ç†ã€‚æˆ‘å°‡æ­¤æ–¹å‘ç¢ºèªä¸¦ç´°åŒ–å¦‚ä¸‹ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**

1.  **æ ¸å¿ƒé‚è¼¯ï¼šä»£ç†è‡³ Grafana (Proxy to Grafana)**:
    æ ¹æ“š `docs/architecture.md`ï¼Œæœ¬å¹³å°ä½œç‚ºã€Œçµ±ä¸€ç®¡ç†å¹³é¢ã€ã€‚å› æ­¤ï¼Œç•¶ä½¿ç”¨è€…é»æ“Šã€Œå»ºç«‹éœéŸ³ã€æ™‚ï¼Œæœ¬å¹³å°å¾Œç«¯çš„ä¸»è¦è·è²¬æ˜¯**å‘¼å« Grafana çš„ `POST /api/v1/silences` ç«¯é»**ã€‚å¹³å°è‡ªèº«è³‡æ–™åº«åƒ…å„²å­˜æ­¤æ“ä½œçš„å¯©è¨ˆè¨˜éŒ„ï¼Œå°‡å…§éƒ¨çš„ `event_id`ã€`user_id` èˆ‡ Grafana å›å‚³çš„ `silence_id` é—œè¯èµ·ä¾†ã€‚

2.  **`POST /api/v1/silence-rules` - API è¨­è¨ˆ**:
    æ­¤ API ç”¨æ–¼å»ºç«‹ä¸€å€‹**ä¸€æ¬¡æ€§**çš„éœéŸ³è¦å‰‡ã€‚
    *   **Request Body**:
        ```json
        {
          "event_id": "evt_2a7d3e9f-8b4c-4f1a-9e2d-6c1f8a7b3e9f",
          "duration": "1h", // ä¾‹å¦‚ "15m", "4h", "24h"
          "comment": "æ­£åœ¨æ‰‹å‹•æ¸…ç†ç£ç¢Ÿç©ºé–“ï¼Œæš«æ™‚éœéŸ³ã€‚" // å¿…é ˆæä¾›
        }
        ```
    *   **å¾Œç«¯è™•ç†é‚è¼¯**:
        1.  æ¥æ”¶è«‹æ±‚ï¼Œé©—è­‰ `comment` ä¸å¾—ç‚ºç©ºã€‚
        2.  å¾è³‡æ–™åº«/å¿«å–ä¸­ç²å– `event_id` çš„å®Œæ•´è©³æƒ…ã€‚
        3.  **æ™ºæ…§åœ°å¾äº‹ä»¶è³‡æ–™ä¸­æå–é—œéµæ¨™ç±¤** (å¦‚ `alertname`, `instance`, `job`, `severity`)ï¼Œé€™äº›æ¨™ç±¤å°‡æ§‹æˆ Grafana éœéŸ³è¦å‰‡çš„ `matchers`ã€‚
        4.  è¨ˆç®— `startsAt` (ç•¶å‰æ™‚é–“) å’Œ `endsAt` (ç•¶å‰æ™‚é–“ + duration) çš„ ISO 8601 æ ¼å¼æ™‚é–“æˆ³ã€‚
        5.  å»ºæ§‹å‘¼å« Grafana API (`POST /api/v1/silences`) çš„ Payloadï¼Œå…¶ä¸­ `comment` æ¬„ä½ä¾†è‡ªè«‹æ±‚ã€‚
        6.  å‘¼å« Grafana APIï¼Œä¸¦è™•ç†å¯èƒ½çš„éŒ¯èª¤ã€‚
        7.  å„²å­˜å¯©è¨ˆè¨˜éŒ„ä¸¦å‘å‰ç«¯å›å‚³æˆåŠŸè¨Šæ¯ã€‚

3.  **å½±éŸ¿ç¯„åœé è¦½ API (`POST /api/v1/silence-rules/preview`)**:
    ç‚ºäº†å¯¦ç¾ã€Œå½±éŸ¿é è¦½ã€é€™å€‹é‡è¦çš„ UX åŠŸèƒ½ï¼Œéœ€è¦ä¸€å€‹ã€Œè©¦é‹è¡Œã€APIã€‚
    *   **Request Body**: åŒ…å«å¾äº‹ä»¶ä¸­æå–å‡ºçš„å»ºè­° `matchers`ã€‚
    *   **å¾Œç«¯é‚è¼¯**: å¾Œç«¯å°‡é€™äº› `matchers` è½‰ç™¼çµ¦ Prometheus/VictoriaMetrics çš„ `/api/v1/series` APIï¼Œä»¥ç²å–ç•¶å‰æ­£åœ¨è§¸ç™¼å‘Šè­¦ä¸”ç¬¦åˆæ¢ä»¶çš„æ™‚é–“åºåˆ—æ•¸é‡ã€‚
    *   **Response**: `{ "affected_series_count": 5 }`

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **å¼·åˆ¶è¦æ±‚ã€ŒåŸå› ã€ä¸¦æä¾›è¼¸å…¥æ¡† (Mandatory Reason Field)**: éœéŸ³å‘Šè­¦æ˜¯ä¸€å€‹é‡è¦æ“ä½œï¼Œå¿…é ˆè¿½è¹¤å…¶åŸå› ã€‚ç›®å‰çš„ UI è¨­è¨ˆç¼ºå°‘æ­¤æ¬„ä½ã€‚æ‡‰åœ¨ã€ŒéœéŸ³è¨­å®šã€å€å¡Šä¸­**æ–°å¢ä¸€å€‹å¿…å¡«çš„ã€ŒåŸå› ã€æ–‡å­—è¼¸å…¥æ¡†**ã€‚é€™å¼·åˆ¶äº†å•è²¬åˆ¶ï¼Œä¸¦ç‚ºåœ˜éšŠæˆå“¡å’Œæœªä¾†å¯©è¨ˆæä¾›äº†é—œéµä¸Šä¸‹æ–‡ã€‚

2.  **æ˜ç¢ºåŒ–ã€ŒéœéŸ³ç¯„åœã€ (Clarify Silence Scope)**: æ­¤å½ˆçª—**å¿…é ˆ**æ˜ç¢ºåœ°å‘ä½¿ç”¨è€…å±•ç¤ºå°‡ç”¨æ–¼éœéŸ³çš„æ¨™ç±¤ã€‚åœ¨ã€Œäº‹ä»¶è³‡è¨Šã€å€å¡Šä¸‹æ–¹ï¼Œæ–°å¢ä¸€å€‹åç‚ºã€Œ**éœéŸ³åŒ¹é…æ¢ä»¶**ã€çš„å€å¡Šï¼Œé¡¯ç¤ºå¾äº‹ä»¶ä¸­æå–çš„ç¢ºåˆ‡éµå€¼å° (ä¾‹å¦‚ï¼š`alertname = DiskSpaceLow`, `instance = srv-web-prod-02`)ã€‚é€™ç¨®é€æ˜åº¦å°æ–¼é˜²æ­¢ä½¿ç”¨è€…æ„å¤–åœ°éœéŸ³éå¤šå‘Šè­¦è‡³é—œé‡è¦ã€‚

3.  **å³æ™‚å½±éŸ¿é è¦½ (Live Impact Preview)**: ç•¶å½ˆçª—è¼‰å…¥æ™‚ï¼Œå‰ç«¯æ‡‰è‡ªå‹•å‘¼å« `POST /api/v1/silence-rules/preview` APIã€‚çµæœæ‡‰æ¸…æ™°åœ°é¡¯ç¤ºï¼Œä¾‹å¦‚ï¼šã€Œ**æ­¤è¦å‰‡å°‡å½±éŸ¿ç›®å‰ 5 æ¢æ´»èºå‘Šè­¦ã€‚**ã€ã€‚é€™è®“ä½¿ç”¨è€…åœ¨æäº¤å‰èƒ½ç«‹å³äº†è§£å…¶æ“ä½œçš„å½±éŸ¿ã€‚

4.  **æä¾›é€²éšé¸é … (Provide Advanced Options)**: åœ¨ã€ŒéœéŸ³åŒ¹é…æ¢ä»¶ã€å€å¡Šæ—ï¼Œæ–°å¢ä¸€å€‹ã€Œ**ç·¨è¼¯åŒ¹é…æ¢ä»¶**ã€çš„é€£çµæˆ–æŒ‰éˆ•ã€‚é»æ“Šå¾Œå…è¨±é«˜éšä½¿ç”¨è€…ä¿®æ”¹ `matchers`ï¼ˆä¾‹å¦‚ï¼Œé€éç§»é™¤ `instance` åŒ¹é…æ¢ä»¶ï¼Œå°‡éœéŸ³ç¯„åœå¾å–®ä¸€å¯¦ä¾‹æ“´å¤§åˆ°æ•´å€‹ `job`ï¼‰ï¼Œä»¥æ‡‰å°æ›´è¤‡é›œçš„å ´æ™¯ã€‚

#### ç·¨è¼¯äº‹ä»¶è¦å‰‡ - åŸºæœ¬è³‡è¨Š [ç·¨è¼¯äº‹ä»¶è¦å‰‡1-åŸºæœ¬è³‡è¨Š](images/19-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡1-åŸºæœ¬è³‡è¨Š.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬ä¸€æ­¥
- å®šç¾©è¦å‰‡åç¨±ã€æè¿°åŠç›£æ§è³‡æºæ¨™ç±¤
- æä¾›å¿«é€Ÿå¥—ç”¨ç¯„æœ¬åŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/event-rule-templates` - ç²å–å¯ç”¨çš„å¿«é€Ÿç¯„æœ¬åˆ—è¡¨

**UX æ”¹å–„å»ºè­°**ï¼š
1. **ç¯„æœ¬é è¦½**ï¼šæä¾›ç¯„æœ¬çš„è©³ç´°èªªæ˜å’Œé è¦½æ•ˆæœ
2. **æ™ºèƒ½æ¨è–¦**ï¼šåŸºæ–¼è³‡æºé¡å‹å’Œæ¥­å‹™å ´æ™¯æ¨è–¦é©åˆçš„ç¯„æœ¬
3. **è‡ªå®šç¾©ç¯„æœ¬**ï¼šæ”¯æ´å°‡å¸¸ç”¨é…ç½®å„²å­˜ç‚ºè‡ªå®šç¾©ç¯„æœ¬
4. **æ¨™ç±¤å»ºè­°**ï¼šæ ¹æ“šé¸æ“‡çš„è³‡æºè‡ªå‹•å»ºè­°ç›¸é—œæ¨™ç±¤
5. **é©—è­‰æª¢æŸ¥**ï¼šå³æ™‚é©—è­‰è³‡æºæ¨™ç±¤çš„æœ‰æ•ˆæ€§å’Œå­˜åœ¨æ€§

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚æ­¤ç²¾éˆæ˜¯å»ºç«‹å‘Šè­¦è¦å‰‡çš„ä¸»è¦ä»‹é¢ï¼Œå…¶æˆåŠŸèˆ‡å¦å–æ±ºæ–¼èƒ½å¦å°‡ Grafana PromQL/MetricQL çš„è¤‡é›œæ€§æŠ½è±¡åŒ–ï¼Œæä¾›ä¸€å€‹å¼•å°å¼ã€å®‰å…¨ä¸”ç›´è§€çš„é«”é©—ã€‚ç¬¬ä¸€æ­¥ã€ŒåŸºæœ¬è³‡è¨Šã€å°æ–¼å®šç¾©è¦å‰‡çš„èº«ä»½ï¼Œä»¥åŠæœ€é‡è¦çš„ã€Œç›£æ§ç¯„åœã€è‡³é—œé‡è¦ã€‚ç¾æœ‰çš„åˆ†æå·²ç‚ºæ­¤æä¾›äº†æ­£ç¢ºçš„è—åœ–ï¼Œæˆ‘å°‡å…¶è¨­è¨ˆç¢ºèªå¦‚ä¸‹ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**

1.  **æ ¸å¿ƒé‚è¼¯ - Grafana ä»£ç†**: å¿…é ˆæ˜ç¢ºï¼Œæ­¤ç²¾éˆæ•´é«”æ˜¯ä¸€å€‹å‹å–„çš„å‰ç«¯ï¼Œç”¨ä»¥å»ºæ§‹ä¸€å€‹è¤‡é›œçš„ JSON ç‰©ä»¶ï¼Œä¸¦æœ€çµ‚ç™¼é€åˆ° **Grafana Alerting API**ã€‚æ­¤è™•çš„ã€Œç›£æ§è³‡æºæ¨™ç±¤ã€å€å¡Šï¼Œå°±æ˜¯å»ºæ§‹ Grafana å‘Šè­¦è¦å‰‡ä¸­æ¨™ç±¤é¸æ“‡å™¨çš„ UIã€‚

2.  **ç¯„æœ¬ API (`GET /api/v1/event-rule-templates`)**:
    æ­¤ API æ˜¯ã€Œå¿«é€Ÿå¥—ç”¨ç¯„æœ¬ã€åŠŸèƒ½çš„é—œéµã€‚å…¶å›æ‡‰æ‡‰ç‚ºä¸€å€‹ç¯„æœ¬ç‰©ä»¶é™£åˆ—ï¼Œæ¯å€‹ç‰©ä»¶åŒ…å«**æ‰€æœ‰ç²¾éˆæ­¥é©Ÿ**çš„é è¨­è³‡æ–™ã€‚

    *   **Response Payload ç¯„ä¾‹**:
        ```json
        [
          {
            "id": "tpl_cpu_high",
            "name": "CPU ä½¿ç”¨ç‡éé«˜",
            "description": "ç•¶ CPU ä½¿ç”¨ç‡æŒçºŒè¶…é 90% æ™‚è§¸ç™¼ã€‚",
            "prefilled_data": {
              "rule_name": "CPU ä½¿ç”¨ç‡éé«˜ on {{ $labels.instance }}",
              "rule_description": "ç›£æ§ {{ $labels.instance }} çš„ CPU ä½¿ç”¨ç‡ã€‚",
              "scope_tags": [{ "key": "job", "value": "node_exporter" }],
              "trigger_conditions": { /* ...é è¨­çš„è§¸ç™¼æ¢ä»¶è³‡æ–™... */ },
              "event_content": { /* ...é è¨­çš„äº‹ä»¶å…§å®¹æ¨¡æ¿... */ },
              "automation_tasks": [ /* ...é è¨­çš„è‡ªå‹•åŒ–ä»»å‹™è¨­å®š... */ ]
            }
          }
        ]
        ```

3.  **æ¨™ç±¤é¸æ“‡å™¨ APIs (Tag Selector APIs)**:
    äº’å‹•å¼çš„ã€Œç›£æ§è³‡æºæ¨™ç±¤ã€UI éœ€è¦å…©å€‹ API ä¾†æä¾›æ™ºæ…§æç¤ºä¸¦é˜²æ­¢è¼¸å…¥éŒ¯èª¤ã€‚
    *   `GET /api/v1/tags/keys`: ç²å–ç›£æ§ç³»çµ±ä¸­æ‰€æœ‰å¯ç”¨çš„æ¨™ç±¤**éµ** (å¦‚ `["env", "app", "dc", "job", "instance"]`)ã€‚å¾Œç«¯é€é Prometheus/VictoriaMetrics çš„å…ƒæ•¸æ“š API (`/api/v1/labels`) å–å¾—æ­¤åˆ—è¡¨ã€‚
    *   `GET /api/v1/tags/values?key=env`: ç²å–æŒ‡å®šæ¨™ç±¤éµçš„æ‰€æœ‰å·²çŸ¥**å€¼**åŠå…¶ä½¿ç”¨æ¬¡æ•¸ã€‚å¾Œç«¯é€é `/api/v1/label/env/values` å–å¾—ã€‚
        ```json
        // GET /api/v1/tags/values?key=env
        [
          { "value": "production", "usage_count": 45 },
          { "value": "staging", "usage_count": 20 }
        ]
        ```

4.  **å‰ç«¯ç‹€æ…‹ç®¡ç† (Frontend State Management)**:
    ç•¶ä½¿ç”¨è€…é»æ“Šã€Œä¸‹ä¸€æ­¥ï¼šè§¸ç™¼è¨­å®šã€æ™‚ï¼Œ**ä¸æ‡‰**æœ‰å¾Œç«¯ API å‘¼å«ã€‚æ­¤è¡¨å–®çš„è³‡æ–™ (`rule_name`, `description`, `scope_tags`) æ‡‰å„²å­˜åœ¨å‰ç«¯çš„ç‹€æ…‹ç®¡ç†å™¨ä¸­ï¼Œä¸¦å‚³éçµ¦å¾ŒçºŒæ­¥é©Ÿã€‚æœ€çµ‚å®Œæ•´çš„è¦å‰‡ç‰©ä»¶åªåœ¨æœ€å¾Œä¸€æ­¥å®Œæˆæ™‚ï¼Œæ‰çµ„è£ä¸¦ç™¼é€åˆ°å¾Œç«¯ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **å³æ™‚ç¯„åœé è¦½ (Live Scope Preview)**: é€™æ˜¯ä¸€å€‹é«˜åƒ¹å€¼åŠŸèƒ½ã€‚ç•¶ä½¿ç”¨è€…åœ¨ã€Œç›£æ§è³‡æºæ¨™ç±¤ã€å€å¡Šæ–°å¢æˆ–ç§»é™¤æ¨™ç±¤æ™‚ï¼Œå‰ç«¯æ‡‰ä½¿ç”¨ debounce æ©Ÿåˆ¶å‘¼å«ä¸€å€‹æ–°çš„ `POST /api/v1/event-rules/scope-preview` ç«¯é»ã€‚æ­¤ API æ¥æ”¶ç›®å‰çš„ `matchers` ä¸¦å›å‚³å°‡è¢«ç›£æ§çš„è³‡æºæ•¸é‡ã€‚UI ä¸Šæ‡‰æ¸…æ™°åœ°é¡¯ç¤ºï¼šã€Œ**ç›®å‰çš„æ¨™ç±¤çµ„åˆå°‡ç›£æ§ 12 å€‹è³‡æºã€‚**ã€ï¼Œé€™èƒ½è®“ä½¿ç”¨è€…å°å…¶è¨­å®šçš„ç¯„åœæœ‰å³æ™‚çš„ä¿¡å¿ƒã€‚

2.  **ç¯„æœ¬é è¦½ (Template Preview)**: ç•¶ä½¿ç”¨è€…æ»‘é¼ æ‡¸åœåœ¨ã€Œå¿«é€Ÿå¥—ç”¨ç¯„æœ¬ã€ä¸­çš„æŸå€‹ç¯„æœ¬ä¸Šæ™‚ï¼Œæ‡‰å‡ºç¾ä¸€å€‹å·¥å…·æç¤ºæˆ–å°å‹å½ˆå‡ºè¦–çª—ï¼Œç¸½çµè©²ç¯„æœ¬å°‡åœ¨æ‰€æœ‰å››å€‹æ­¥é©Ÿä¸­é…ç½®çš„å…§å®¹ï¼Œå¹«åŠ©ä½¿ç”¨è€…åœ¨é»æ“Šå‰åšå‡ºæ˜æ™ºçš„é¸æ“‡ã€‚

3.  **æ¨™ç±¤è¼¸å…¥å¼•å° (Guided Tag Input)**: æ–°å¢æ¨™ç±¤çš„ UI å¾ˆä¸éŒ¯ã€‚æ‡‰é€²ä¸€æ­¥å¢å¼·ï¼Œé˜²æ­¢ä½¿ç”¨è€…é‡è¤‡æ–°å¢ç›¸åŒçš„æ¨™ç±¤éµã€‚ä¸€æ—¦å¦‚ `env` çš„éµè¢«åŠ å…¥ï¼Œå®ƒå°±æ‡‰è©²å¾å¯ç”¨éµçš„ä¸‹æ‹‰åˆ—è¡¨ä¸­ç§»é™¤ï¼Œä»¥é¿å…è¡çªã€‚

é€éé€™äº› API å’Œ UX è¨­è¨ˆï¼Œæˆ‘å€‘å¯ä»¥å°‡è¤‡é›œçš„å‘Šè­¦ç¯„åœå®šç¾©éç¨‹ï¼Œè½‰åŒ–ç‚ºä¸€å€‹å°ä½¿ç”¨è€…å‹å¥½ä¸”ä¸æ˜“å‡ºéŒ¯çš„å¼•å°å¼é«”é©—ã€‚

#### ç·¨è¼¯äº‹ä»¶è¦å‰‡ - è§¸ç™¼æ¢ä»¶ [ç·¨è¼¯äº‹ä»¶è¦å‰‡2-è§¸ç™¼æ¢ä»¶](images/20-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡2-è§¸ç™¼æ¢ä»¶.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬äºŒæ­¥
- å®šç¾©è§¸ç™¼äº‹ä»¶çš„å…·é«”æ¢ä»¶
- æ”¯æ´è¤‡é›œçš„é‚è¼¯é‹ç®—å¼

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/metrics` - ç²å–æ‰€æœ‰å¯ç”¨çš„ç›£æ§æŒ‡æ¨™åˆ—è¡¨

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¦–è¦ºåŒ–æ¢ä»¶ç·¨è¼¯å™¨**ï¼šæä¾›æ‹–æ‹½å¼çš„æ¢ä»¶ç·¨è¼¯å™¨ï¼Œé™ä½é…ç½®è¤‡é›œåº¦
2. **æ¢ä»¶æ¨¡æ“¬**ï¼šæ”¯æ´ä½¿ç”¨æ­·å²æ•¸æ“šæ¨¡æ“¬è§¸ç™¼æ¢ä»¶çš„æ•ˆæœ
3. **é–¾å€¼å»ºè­°**ï¼šåŸºæ–¼æ­·å²æ•¸æ“šåˆ†æï¼Œæä¾›æ™ºèƒ½é–¾å€¼å»ºè­°
4. **æ¢ä»¶é è¦½**ï¼šå³æ™‚é¡¯ç¤ºæ¢ä»¶é‚è¼¯çš„è‡ªç„¶èªè¨€æè¿°
5. **è¤‡é›œé‹ç®—å¼**ï¼šæ”¯æ´æ›´è¤‡é›œçš„é‚è¼¯é‹ç®—å’Œæ™‚é–“çª—å£é…ç½®

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚é€™æ˜¯è¦å‰‡å»ºç«‹ç²¾éˆä¸­æœ€æ ¸å¿ƒã€æŠ€è¡“ä¸Šæœ€è¤‡é›œçš„ä¸€æ­¥ã€‚å…¶ç›®æ¨™æ˜¯å°‡å¼·å¤§ä½†æ¥µå…¶è¤‡é›œçš„ PromQL/MetricQL æŸ¥è©¢ï¼ŒæŠ½è±¡æˆä¸€å€‹ä»»ä½• SRE æˆå“¡éƒ½èƒ½ç†è§£å’Œæ“ä½œçš„è¦–è¦ºåŒ–ä»‹é¢ã€‚ç¾æœ‰çš„åˆ†æå·²ç¶“ç‚ºæ­¤æŒ‘æˆ°æä¾›äº†éå¸¸å‡ºè‰²çš„è§£æ±ºæ–¹æ¡ˆï¼Œæˆ‘å°‡å…¶æ ¸å¿ƒé‚è¼¯èˆ‡ UX å¼·åŒ–å»ºè­°ç¢ºèªä¸¦ç´°åŒ–å¦‚ä¸‹ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**

1.  **æ ¸å¿ƒé‚è¼¯ - ç¿»è­¯ç‚º Grafana æŸ¥è©¢**:
    æ­¤ UI çš„çµæ§‹ (`(A AND B) OR (C)`) å®Œç¾åœ°å°æ‡‰ Grafana çµ±ä¸€å‘Šè­¦æ¨¡å‹ä¸­çš„å¤šå€‹æŸ¥è©¢å’Œæ¢ä»¶ã€‚å¾Œç«¯çš„æ ¸å¿ƒè·è²¬æ˜¯å°‡é€™å€‹ UI çµæ§‹**ç¿»è­¯**æˆ Grafana èƒ½ç†è§£çš„ API Payloadã€‚
    *   æ¯ä¸€å€‹ã€Œæ¢ä»¶ç¾¤çµ„ (OR)ã€å°æ‡‰åˆ° Grafana è¦å‰‡ä¸­çš„ä¸€å€‹ç¨ç«‹çš„ `data` æŸ¥è©¢ç‰©ä»¶ï¼Œæ“æœ‰è‡ªå·±çš„ `refId` (e.g., 'A', 'B')ã€‚
    *   ç¾¤çµ„å…§çš„ã€ŒAND æ¢ä»¶ã€æœƒè¢«å¾Œç«¯åˆä½µæˆä¸€å€‹å–®ä¸€çš„æŸ¥è©¢è¡¨é”å¼ã€‚ä¾‹å¦‚ï¼Œ`è¨˜æ†¶é«”ä½¿ç”¨ç‡ > 80%` å’Œ `è³‡æ–™åº«å»¶é² > 5s` æœƒè¢«ç¿»è­¯æˆé¡ä¼¼ `(mem_usage > 80) and (db_latency > 5)` çš„ PromQLã€‚
    *   æœ€çµ‚ï¼Œé‚„éœ€è¦ä¸€å€‹ `Expression` é¡å‹çš„ `data` ç‰©ä»¶ï¼Œå…¶è¡¨é”å¼ç‚º `A || B`ï¼Œç”¨ä»¥çµ„åˆæ‰€æœ‰çš„ OR æ¢ä»¶ç¾¤çµ„ã€‚
    *   æ¯å€‹ã€Œæ¢ä»¶ç¾¤çµ„ã€è¨­å®šçš„ã€Œäº‹ä»¶ç­‰ç´šã€(INFO/WARNING/CRITICAL)ï¼Œæœƒè¢«ä½œç‚º `label` é™„åŠ åˆ°å°æ‡‰çš„ Grafana `data` æŸ¥è©¢ç‰©ä»¶ä¸Šï¼Œé€™æ˜¯å¯¦ç¾å¤šç­‰ç´šå‘Šè­¦çš„é—œéµã€‚

2.  **æŒ‡æ¨™ API (`GET /api/v1/metrics`)**:
    æ­¤ API ç”¨æ–¼å¡«å……æŒ‡æ¨™ä¸‹æ‹‰é¸å–®ï¼Œå…¶å›å‚³çš„å…§å®¹å¿…é ˆæ˜¯çµæ§‹åŒ–çš„ï¼Œè€Œä¸åƒ…åƒ…æ˜¯åç¨±ã€‚å¾Œç«¯å„²å­˜ `query_template`ï¼Œä½¿å¾—æŸ¥è©¢é‚è¼¯çš„è¤‡é›œæ€§å°å‰ç«¯å®Œå…¨éš±è—ï¼Œæ¥µå¤§é™ä½äº†å‰ç«¯å¯¦ä½œçš„é›£åº¦ã€‚

    *   **Response Payload ç¯„ä¾‹**:
        ```json
        [
          {
            "id": "metric_cpu_usage",
            "name": "CPU ä½¿ç”¨ç‡ (%)",
            "description": "ä¸»æ©Ÿçš„å¹³å‡ CPU ä½¿ç”¨ç‡ã€‚",
            "unit": "%",
            "query_template": "100 - (avg by (instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)"
          }
          // ... more metrics
        ]
        ```

3.  **æ¢ä»¶æ¨¡æ“¬ API (`POST /api/v1/event-rules/preview-condition`)**:
    ç‚ºäº†å¯¦ç¾ã€Œæ¢ä»¶æ¨¡æ“¬ã€é€™å€‹å¼·å¤§çš„ UX åŠŸèƒ½ï¼Œéœ€è¦ä¸€å€‹ API ä¾†é è¦½æŸ¥è©¢æ•ˆæœã€‚
    *   **Request Body**: å‰ç«¯å°‡ç›®å‰ä½¿ç”¨è€…å»ºæ§‹çš„æ¢ä»¶ï¼Œè½‰æ›ç‚ºæŸ¥è©¢è¡¨é”å¼å¾Œç™¼é€çµ¦å¾Œç«¯ã€‚
    *   **å¾Œç«¯é‚è¼¯**: å¾Œç«¯æ‹¿è‘—é€™å€‹ `expression` å»æŸ¥è©¢æ™‚åºè³‡æ–™åº« (Prometheus/VictoriaMetrics)ã€‚
    *   **Response**: å›å‚³ç¹ªè£½åœ–è¡¨æ‰€éœ€çš„æ™‚åºæ•¸æ“šï¼Œå‰ç«¯æ”¶åˆ°å¾Œå¯ä»¥åœ¨ä¸€å€‹å°å‹é è¦½åœ–è¡¨ä¸­ï¼Œå°‡æŒ‡æ¨™æ›²ç·šå’Œé–¾å€¼ç·šä¸€åŒç¹ªè£½å‡ºä¾†ï¼Œè®“ä½¿ç”¨è€…ç›´è§€çœ‹åˆ°åœ¨éå» 24 å°æ™‚å…§ï¼Œæ­¤è¦å‰‡æœƒè§¸ç™¼å¤šå°‘æ¬¡ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **æ™ºæ…§é–¾å€¼æ¨è–¦ (Smart Threshold Suggestions)**: ç•¶ä½¿ç”¨è€…é¸æ“‡äº†ä¸€å€‹æŒ‡æ¨™ï¼ˆå¦‚ã€ŒCPU ä½¿ç”¨ç‡ã€ï¼‰å¾Œï¼Œç³»çµ±å¯ä»¥è‡ªå‹•å‘¼å« API åˆ†æè©²æŒ‡æ¨™åœ¨éå»ä¸€æ®µæ™‚é–“ï¼ˆå¦‚ä¸€é€±ï¼‰çš„ P95ã€P99 ç™¾åˆ†ä½æ•¸ï¼Œä¸¦å°‡é€™äº›æ•¸å€¼ä½œç‚ºå»ºè­°çš„ `WARNING` å’Œ `CRITICAL` é–¾å€¼æä¾›çµ¦ä½¿ç”¨è€…åƒè€ƒã€‚é€™æ˜¯å¾ã€Œå·¥å…·ã€åˆ°ã€ŒåŠ©æ‰‹ã€çš„é—œéµä¸€æ­¥ã€‚

2.  **è‡ªç„¶èªè¨€é è¦½ (Natural Language Preview)**: åœ¨é é¢åº•éƒ¨æˆ–å´é‚Šï¼Œæä¾›ä¸€å€‹å”¯è®€çš„æ–‡å­—å€å¡Šï¼Œç”¨äººé¡å¯è®€çš„èªè¨€å³æ™‚ç¸½çµä½¿ç”¨è€…å»ºç«‹çš„è¤‡é›œè¦å‰‡ã€‚ä¾‹å¦‚ï¼š
    > ã€Œç•¶ (**è¨˜æ†¶é«”ä½¿ç”¨ç‡** åœ¨ 5 åˆ†é˜å…§æŒçºŒ **> 80%**) ä¸” (**è³‡æ–™åº«è¤‡è£½å»¶é²** åœ¨ 5 åˆ†é˜å…§æŒçºŒ **> 5 ç§’**) æ™‚ï¼Œå°‡è§¸ç™¼ **WARNING** ç­‰ç´šçš„äº‹ä»¶ï¼›æˆ–è€…ç•¶ (**CPU ä½¿ç”¨ç‡** åœ¨ 5 åˆ†é˜å…§æŒçºŒ **> 85%**) æ™‚ï¼Œå°‡è§¸ç™¼ **CRITICAL** ç­‰ç´šçš„äº‹ä»¶ã€‚ã€

    é€™èƒ½æ¥µå¤§åœ°é™ä½ä½¿ç”¨è€…å› é‚è¼¯è¤‡é›œè€Œå‡ºéŒ¯çš„æ©Ÿç‡ï¼Œæ˜¯æå‡æ˜“ç”¨æ€§çš„é—œéµã€‚

3.  **éŒ¯èª¤èˆ‡è¡çªæª¢æŸ¥**: ç•¶ä½¿ç”¨è€…è¼¸å…¥é–¾å€¼æˆ–é¸æ“‡æŒ‡æ¨™æ™‚ï¼Œé€²è¡Œå³æ™‚çš„èªæ³•å’Œé‚è¼¯æª¢æŸ¥ï¼Œé˜²æ­¢ä¾‹å¦‚é–¾å€¼å–®ä½ä¸åŒ¹é…ç­‰åŸºæœ¬éŒ¯èª¤ã€‚

é€éé€™ç¨®æ–¹å¼ï¼Œæˆ‘å€‘å°‡ Grafana å¼·å¤§çš„èƒ½åŠ›ï¼Œé€éä¸€å€‹ç²¾å¿ƒè¨­è¨ˆçš„æŠ½è±¡å±¤ï¼Œå®‰å…¨ã€æœ‰æ•ˆåœ°æä¾›çµ¦äº†ä½¿ç”¨è€…ã€‚

#### ç·¨è¼¯äº‹ä»¶è¦å‰‡ - äº‹ä»¶å…§å®¹ [ç·¨è¼¯äº‹ä»¶è¦å‰‡3-äº‹ä»¶å…§å®¹](images/21-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡3-äº‹ä»¶å…§å®¹.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬ä¸‰æ­¥
- è‡ªè¨‚ç•¶äº‹ä»¶è¢«è§¸ç™¼æ™‚çš„æ¨™é¡Œå’Œå…§å®¹
- æ”¯æ´è®Šæ•¸æ›¿æ›å’ŒMarkdownèªæ³•

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/event-rules/template-variables` - ç²å–å¯ç”¨è®Šæ•¸åˆ—è¡¨

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¯¦æ™‚é è¦½**ï¼šæä¾›äº‹ä»¶å…§å®¹çš„å¯¦æ™‚é è¦½ï¼ŒåŒ…å«è®Šæ•¸æ›¿æ›æ•ˆæœ
2. **Markdown ç·¨è¼¯å™¨**ï¼šå…§å»º Markdown ç·¨è¼¯å™¨ï¼Œæ”¯æ´èªæ³•é«˜äº®å’Œå³æ™‚é è¦½
3. **è®Šæ•¸åŠ©æ‰‹**ï¼šæä¾›è®Šæ•¸æ’å…¥åŠ©æ‰‹ï¼Œæ”¯æ´æœå°‹å’Œåˆ†é¡ç€è¦½
4. **ç¯„æœ¬åº«**ï¼šå…§å»ºå¸¸ç”¨çš„äº‹ä»¶å…§å®¹ç¯„æœ¬
5. **å¤šèªè¨€æ”¯æ´**ï¼šæ”¯æ´ä¸åŒèªè¨€çš„äº‹ä»¶å…§å®¹ç¯„æœ¬

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚æ­¤æ­¥é©Ÿå®šç¾©äº†ç•¶å‘Šè­¦è§¸ç™¼æ™‚ï¼ŒOn-Call å·¥ç¨‹å¸«å°‡æœƒçœ‹åˆ°ã€Œä»€éº¼å…§å®¹ã€ã€‚ä¸€å€‹æ¸…æ™°ã€è³‡è¨Šè±å¯Œã€åŒ…å«ä¸Šä¸‹æ–‡çš„äº‹ä»¶å…§å®¹ï¼Œå°æ–¼å¿«é€ŸéŸ¿æ‡‰è‡³é—œé‡è¦ã€‚ç¾æœ‰çš„åˆ†æå·²æº–ç¢ºåœ°æŒ‡å‡ºäº†å¯¦ç¾æ­¤ç›®æ¨™çš„æ ¸å¿ƒï¼šæ‰“é€ ä¸€å€‹æ—¢æ˜“æ–¼ä½¿ç”¨ï¼Œåˆèƒ½ç›´æ¥æ˜ å°„åˆ° Grafana å¼•æ“çš„å¼·å¤§æ¨¡æ¿åŒ–é«”é©—ã€‚æˆ‘å°‡å…¶è¨­è¨ˆç¢ºèªå¦‚ä¸‹ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**

1.  **æ ¸å¿ƒé‚è¼¯ - æ˜ å°„è‡³ Grafana Annotations**:
    æ­¤ UI ç›´æ¥è¨­å®š Grafana å‘Šè­¦è¦å‰‡çš„ `annotations`ã€‚
    *   **äº‹ä»¶æ¨™é¡Œæ¨£æ¿**: æ­¤æ¬„ä½çš„å…§å®¹å°‡å¡«å…¥ Grafana è¦å‰‡çš„ `summary` annotationã€‚
    *   **äº‹ä»¶å…§å®¹æ¨£æ¿**: æ­¤æ¬„ä½çš„å…§å®¹å°‡å¡«å…¥ `description` annotationã€‚
    *   **è®Šæ•¸æ ¼å¼**: UI ä¸­ä½¿ç”¨çš„ `{{variable}}` èªæ³•ï¼Œå¾Œç«¯åœ¨ç™¼é€çµ¦ Grafana å‰ï¼Œæœƒå°‡å…¶ç¿»è­¯æˆ Grafana ç›¸å®¹çš„ Go æ¨¡æ¿èªæ³• (ä¾‹å¦‚ `{{ .Labels.instance }}`)ã€‚

2.  **è®Šæ•¸ API (`GET /api/v1/event-rules/template-variables`)**:
    æ­¤ API ç‚º UI çš„ã€Œå¯ç”¨è®Šæ•¸ã€å€å¡Šå’Œã€Œå³æ™‚é è¦½ã€åŠŸèƒ½æä¾›æ•¸æ“šã€‚å…¶å›æ‡‰å¿…é ˆæ˜¯çµæ§‹åŒ–çš„ï¼ŒåŒ…å«è®Šæ•¸åç¨±ã€æè¿°å’Œä¸€å€‹ç”¨æ–¼é è¦½çš„ç¯„ä¾‹å€¼ã€‚

    *   **Response Payload ç¯„ä¾‹**:
        ```json
        [
          {
            "name": "{{resource.name}}",
            "description": "è§¸ç™¼äº‹ä»¶çš„è³‡æºåç¨±ã€‚",
            "example_value": "db-mysql-prod-01"
          },
          {
            "name": "{{metric.value}}",
            "description": "è§¸ç™¼äº‹ä»¶æ™‚çš„æŒ‡æ¨™æ•¸å€¼ã€‚",
            "example_value": "92.5"
          },
          {
            "name": "{{threshold}}",
            "description": "è¦å‰‡ä¸­è¨­å®šçš„é–¾å€¼ã€‚",
            "example_value": "90"
          }
        ]
        ```

3.  **å‰ç«¯ç‹€æ…‹ç®¡ç†**:
    èˆ‡å‰å¹¾å€‹æ­¥é©Ÿç›¸åŒï¼Œæ­¤è™•è¼¸å…¥çš„æ‰€æœ‰è³‡æ–™ (`title_template`, `content_template`) éƒ½æœƒè¢«åŠ å…¥åˆ°æ­£åœ¨å‰ç«¯ç‹€æ…‹ä¸­å»ºæ§‹çš„è¦å‰‡ç‰©ä»¶è£¡ã€‚é€²å…¥ä¸‹ä¸€æ­¥æ™‚ç„¡éœ€å‘¼å« APIã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **å³æ™‚é è¦½ (Live Preview)**: é€™æ˜¯**ä¸å¯æˆ–ç¼ºçš„å¿…å‚™åŠŸèƒ½**ã€‚é é¢æ‡‰åŒ…å«ä¸€å€‹ã€Œé è¦½ã€é¢æ¿ï¼Œéš¨è‘—ä½¿ç”¨è€…åœ¨æ¨¡æ¿ä¸­è¼¸å…¥è€Œå³æ™‚æ›´æ–°ã€‚æ­¤é¢æ¿æ‡‰ä½¿ç”¨ API å›å‚³çš„ `example_value` ä¾†æ¸²æŸ“å‡ºæœ€çµ‚å‘Šè­¦çš„æ¨£è²Œï¼Œçµ¦äºˆä½¿ç”¨è€…æœ€ç›´æ¥çš„åé¥‹ï¼Œç¢ºä¿æ‰€è¦‹å³æ‰€å¾—ã€‚
    *   **é è¦½ç¯„ä¾‹**:
        > **æ¨™é¡Œ**: `db-mysql-prod-01 - CPU ä½¿ç”¨ç‡ (%) ç•°å¸¸`
        > **å…§å®¹**: `db-mysql-prod-01 çš„ CPU ä½¿ç”¨ç‡ (%) å·²æŒçºŒ 5 åˆ†é˜è¶…éé–¾å€¼ 90ã€‚ç›®å‰æ•¸å€¼ç‚º 92.5ã€‚è«‹ç«‹å³é—œæ³¨ï¼`

2.  **åˆ†ç´šäº‹ä»¶å…§å®¹ (Per-Severity Content)**: (é€²éšåŠŸèƒ½) ç›®å‰çš„ UI ç‚ºæ•´å€‹è¦å‰‡å®šç¾©äº†ä¸€å¥—æ¨™é¡Œ/å…§å®¹ã€‚ä¸€å€‹é‡è¦çš„åŠŸèƒ½å¢å¼·æ˜¯ï¼Œå…è¨±ä½¿ç”¨è€…ç‚ºä¸Šä¸€æ­¥ä¸­å®šç¾©çš„**ä¸åŒäº‹ä»¶ç­‰ç´šï¼ˆWARNING, CRITICALï¼‰è¨­å®šä¸åŒçš„æ¨¡æ¿**ã€‚
    *   UI å¯åœ¨ã€Œäº‹ä»¶å…§å®¹ã€å€å¡Šä¸­ä½¿ç”¨é ç±¤ (`WARNING`, `CRITICAL`) ä¾†åˆ‡æ›ã€‚
    *   é€™å°‡å¸¶ä¾†æ›´è±å¯Œçš„é€šçŸ¥ã€‚ä¾‹å¦‚ï¼Œ`CRITICAL` å‘Šè­¦çš„å…§å®¹å¯ä»¥è‡ªå‹•åŒ…å« On-Call æ‰‹å†Šçš„é€£çµå’Œ `@on-call-lead` çš„å‡ç´šè·¯å¾‘ï¼Œè€Œ `WARNING` å‘Šè­¦å¯èƒ½åªåŒ…å«å„€è¡¨æ¿çš„é€£çµã€‚

3.  **å…§å»º Markdown ç·¨è¼¯å™¨ (Built-in Markdown Editor)**: ã€Œäº‹ä»¶å…§å®¹æ¨£æ¿ã€çš„è¼¸å…¥æ¡†æ‡‰ç‚ºä¸€å€‹æ‰€è¦‹å³æ‰€å¾—ï¼ˆWYSIWYGï¼‰çš„ Markdown ç·¨è¼¯å™¨ï¼Œæä¾›åŸºç¤çš„æ ¼å¼åŒ–å·¥å…·ï¼ˆå¦‚ç²—é«”ã€æ–œé«”ã€åˆ—è¡¨ã€é€£çµï¼‰ï¼Œè®“éæŠ€è¡“ä½¿ç”¨è€…ä¹Ÿèƒ½è¼•é¬†å»ºç«‹è±å¯Œä¸”æ˜“è®€çš„å‘Šè­¦å…§å®¹ã€‚

ç¸½ä¹‹ï¼Œä¸€å€‹å…·å‚™å³æ™‚é è¦½å’Œè±å¯Œè®Šæ•¸æ”¯æ´çš„æ¨¡æ¿åŒ–ç³»çµ±ï¼Œæ˜¯ç¢ºä¿å‘Šè­¦é€šçŸ¥å“è³ªçš„é—œéµã€‚

#### ç·¨è¼¯äº‹ä»¶è¦å‰‡ - è‡ªå‹•åŒ– [ç·¨è¼¯äº‹ä»¶è¦å‰‡4-è‡ªå‹•åŒ–](images/22-å½ˆçª—-äº‹ä»¶è¦å‰‡-ç·¨è¼¯äº‹ä»¶è¦å‰‡4-è‡ªå‹•åŒ–.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬å››æ­¥
- è¨­å®šäº‹ä»¶è§¸ç™¼æ™‚çš„è‡ªå‹•åŒ–éŸ¿æ‡‰å‹•ä½œ
- æ”¯æ´è…³æœ¬åƒæ•¸é…ç½®å’Œæ¸¬è©¦åŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/scripts?compatible_with=event_rules` - ç²å–é©ç”¨è…³æœ¬åˆ—è¡¨
- `POST /api/v1/event-rules` - å»ºç«‹æˆ–æ›´æ–°å®Œæ•´çš„äº‹ä»¶è¦å‰‡

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è…³æœ¬æ¸¬è©¦**ï¼šæä¾›è…³æœ¬çš„æ¸¬è©¦åŸ·è¡ŒåŠŸèƒ½ï¼Œé©—è­‰åƒæ•¸å’ŒåŸ·è¡Œçµæœ
2. **åƒæ•¸æ˜ å°„**ï¼šæ™ºèƒ½æ˜ å°„äº‹ä»¶å±¬æ€§åˆ°è…³æœ¬åƒæ•¸
3. **åŸ·è¡Œæ¢ä»¶**ï¼šæ”¯æ´è¨­å®šè…³æœ¬çš„åŸ·è¡Œæ¢ä»¶å’Œå„ªå…ˆç´š
4. **çµæœè™•ç†**ï¼šé…ç½®è…³æœ¬åŸ·è¡Œçµæœçš„è™•ç†æ–¹å¼ï¼ˆæ›´æ–°äº‹ä»¶ç‹€æ…‹ã€ç™¼é€é€šçŸ¥ç­‰ï¼‰
5. **ä¾è³´ç®¡ç†**ï¼šæ”¯æ´è…³æœ¬é–“çš„ä¾è³´é—œä¿‚å’ŒåŸ·è¡Œé †åº

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚é€™æ˜¯å°‡å¹³å°å¾ä¸€å€‹è¢«å‹•çš„ç›£æ§å·¥å…·ï¼Œæå‡ç‚ºä¸€å€‹å…·å‚™ä¸»å‹•ä¿®å¾©èƒ½åŠ›çš„ã€Œè‡ªæ„ˆã€ç³»çµ±çš„é—œéµä¸€æ­¥ã€‚å…¶æ ¸å¿ƒæ˜¯å»ºç«‹äº‹ä»¶è¦å‰‡èˆ‡è‡ªå‹•åŒ–è…³æœ¬ä¹‹é–“æ¸…æ™°ã€å¯é ä¸”å®‰å…¨çš„ç¶å®šã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **æœ€çµ‚è¦å‰‡ Payload (`POST /api/v1/event-rules`)**:
    é€™æ˜¯ç²¾éˆçš„æœ€å¾Œä¸€æ­¥ã€‚ç•¶ä½¿ç”¨è€…é»æ“Šã€Œå®Œæˆã€æ™‚ï¼Œå‰ç«¯æ‡‰å°‡æ‰€æœ‰å››å€‹æ­¥é©Ÿçš„è³‡æ–™çµ„è£æˆä¸€å€‹å®Œæ•´çš„è¦å‰‡ç‰©ä»¶ã€‚å…¶ä¸­çš„ `automation` éƒ¨åˆ†æ‡‰å…·å‚™éˆæ´»çš„çµæ§‹ï¼Œä»¥æ”¯æ´éœæ…‹å’Œå‹•æ…‹åƒæ•¸ã€‚

    *   **Automation ç‰©ä»¶çµæ§‹ç¯„ä¾‹**:
        ```json
        // åŒ…å«åœ¨æœ€çµ‚äº‹ä»¶è¦å‰‡ç‰©ä»¶ä¸­çš„ automation æ¬„ä½
        "automation": {
          "enabled": true,
          "script_id": "scr_auto_scaling_for_web_servers",
          "parameters": [
            {
              "name": "instance_count",
              "value_type": "STATIC", 
              "value": "3"
            },
            {
              "name": "target_resource",
              "value_type": "DYNAMIC_FROM_EVENT",
              "value": "{{resource.name}}"
            }
          ]
        }
        ```

2.  **è…³æœ¬åˆ—è¡¨ API (`GET /api/v1/scripts`)**:
    æ­¤ API ç”¨æ–¼å¡«å……ã€Œé¸æ“‡è…³æœ¬ã€ä¸‹æ‹‰é¸å–®ï¼Œå…¶å›å‚³çš„å…§å®¹**å¿…é ˆ**åŒ…å«æ¯å€‹è…³æœ¬çš„åƒæ•¸å®šç¾©ï¼Œä»¥ä¾¿ UI å‹•æ…‹ç”Ÿæˆåƒæ•¸è¼¸å…¥æ¬„ä½ã€‚

    *   **Response Payload ç¯„ä¾‹**:
        ```json
        [
          {
            "id": "scr_auto_scaling_for_web_servers",
            "name": "Auto-scaling for Web Servers",
            "description": "å‹•æ…‹æ“´å±• Web ä¼ºæœå™¨å¯¦ä¾‹æ•¸é‡ã€‚",
            "parameters": [
              {
                "name": "instance_count",
                "type": "INTEGER",
                "required": true,
                "description": "æœŸæœ›çš„å¯¦ä¾‹ç¸½æ•¸ã€‚"
              },
              {
                "name": "target_resource_group",
                "type": "STRING",
                "required": true,
                "description": "è¦æ“´å±•çš„è³‡æºç¾¤çµ„åç¨±ã€‚"
              }
            ]
          }
        ]
        ```

3.  **å¾Œç«¯è§¸ç™¼é‚è¼¯**:
    ç•¶äº‹ä»¶è¦å‰‡è¢«è§¸ç™¼æ™‚ï¼Œäº‹ä»¶è™•ç†æœå‹™æœƒæª¢æŸ¥è¦å‰‡ä¸­æ˜¯å¦åŒ…å«å·²å•Ÿç”¨çš„ `automation` è¨­å®šã€‚å¦‚æœæœ‰ï¼Œå®ƒå°‡ï¼š
    a. è§£æ `parameters` é™£åˆ—ï¼Œå°‡ `DYNAMIC_FROM_EVENT` é¡å‹çš„åƒæ•¸å€¼ï¼ˆå¦‚ `{{resource.name}}`ï¼‰æ›¿æ›ç‚ºçœŸå¯¦çš„äº‹ä»¶å…§å®¹ã€‚
    b. å‘**è‡ªå‹•åŒ–åŸ·è¡Œæœå‹™**ç™¼é€ä¸€å€‹æ–°çš„åŸ·è¡Œä»»å‹™è«‹æ±‚ï¼ŒåŒ…å« `script_id` å’Œè§£æå¾Œçš„å®Œæ•´åƒæ•¸ã€‚
    c. è©²æ¬¡åŸ·è¡Œå°‡è¢«è¨˜éŒ„åˆ° `execution_logs` è¡¨ï¼Œä¸¦åŒ…å«è§¸ç™¼å®ƒçš„ `event_id`ï¼Œä»¥å¯¦ç¾å®Œæ•´çš„å¯è¿½æº¯æ€§ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **æ™ºæ…§åƒæ•¸æ˜ å°„ (Intelligent Parameter Mapping)**: é€™æ˜¯æ­¤ä»‹é¢çš„**æ ¸å¿ƒé«”é©—**ã€‚ç•¶ä½¿ç”¨è€…é¸æ“‡ä¸€å€‹è…³æœ¬å¾Œï¼ŒUI æ‡‰æ ¹æ“šè…³æœ¬çš„ `parameters` å®šç¾©ï¼Œç‚ºæ¯å€‹åƒæ•¸å‹•æ…‹ç”Ÿæˆä¸€å€‹è¼¸å…¥å…ƒä»¶ã€‚
    *   **æä¾›æ˜ å°„é¸é …**: æ¯å€‹åƒæ•¸è¼¸å…¥å…ƒä»¶æ—ï¼Œéƒ½æ‡‰æœ‰ä¸€å€‹åˆ‡æ›é–‹é—œæˆ–ä¸‹æ‹‰é¸å–®ï¼Œå…è¨±ä½¿ç”¨è€…åœ¨ã€Œ**éœæ…‹å€¼**ã€ï¼ˆæ‰‹å‹•è¼¸å…¥ï¼‰å’Œã€Œ**å¾äº‹ä»¶ä¸­ç²å–**ã€ä¹‹é–“é¸æ“‡ã€‚
    *   **å‹•æ…‹è®Šæ•¸é¸æ“‡**: ç•¶é¸æ“‡ã€Œå¾äº‹ä»¶ä¸­ç²å–ã€æ™‚ï¼Œæ‡‰æä¾›ä¸€å€‹åŒ…å«æ‰€æœ‰å¯ç”¨äº‹ä»¶è®Šæ•¸ï¼ˆå¦‚ `{{resource.name}}`, `{{metric.value}}`ï¼‰çš„ä¸‹æ‹‰é¸å–®ï¼Œä¾›ä½¿ç”¨è€…é¸æ“‡ã€‚
    *   **æ™ºæ…§æ¨è–¦**: å¦‚æœè…³æœ¬åƒæ•¸çš„åç¨±ï¼ˆå¦‚ `target_resource`ï¼‰èˆ‡äº‹ä»¶è®Šæ•¸çš„åç¨±ï¼ˆå¦‚ `resource.name`ï¼‰ç›¸ä¼¼ï¼Œç³»çµ±æ‡‰è‡ªå‹•æ¨è–¦æ­¤æ˜ å°„ï¼Œä»¥æ¸›å°‘ä½¿ç”¨è€…çš„é…ç½®è² æ“”ã€‚

2.  **å¢åŠ ç¢ºèªæ­¥é©Ÿ (Final Confirmation Step)**: åœ¨é»æ“Šã€Œå®Œæˆã€æŒ‰éˆ•ä¹‹å‰ï¼Œå¼·çƒˆå»ºè­°å¢åŠ ä¸€å€‹å”¯è®€çš„ã€Œ**ç¢ºèªè¨­å®š**ã€æ­¥é©Ÿã€‚æ­¤é é¢å°‡æ¸…æ™°åœ°åŒ¯ç¸½å‰å››æ­¥çš„æ‰€æœ‰é…ç½®ï¼Œè®“ä½¿ç”¨è€…åœ¨å„²å­˜å‰æœ‰æœ€å¾Œä¸€æ¬¡æ©Ÿæœƒå¯©æŸ¥æ•´å€‹è¦å‰‡ï¼Œç‰¹åˆ¥æ˜¯å°‡è¦åŸ·è¡Œçš„è‡ªå‹•åŒ–å‹•ä½œåŠå…¶åƒæ•¸ï¼Œé€™æ˜¯é˜²æ­¢éŒ¯èª¤é…ç½®çš„é—œéµå®‰å…¨æªæ–½ã€‚

3.  **æ¬Šé™èˆ‡å®‰å…¨ (Permissions & Security)**: `GET /api/v1/scripts` API å›å‚³çš„è…³æœ¬åˆ—è¡¨**å¿…é ˆ**åŸºæ–¼ç•¶å‰ä½¿ç”¨è€…çš„æ¬Šé™é€²è¡Œéæ¿¾ã€‚ä¸¦éæ‰€æœ‰ä½¿ç”¨è€…éƒ½æœ‰æ¬Šé™å°‡æ‰€æœ‰è…³æœ¬ï¼ˆç‰¹åˆ¥æ˜¯é«˜é¢¨éšªè…³æœ¬ï¼‰è¨­å®šç‚ºè‡ªå‹•åŸ·è¡Œã€‚

#### ç·¨è¼¯éœéŸ³è¦å‰‡ - åŸºæœ¬è³‡è¨Š [ç·¨è¼¯éœéŸ³è¦å‰‡1-åŸºæœ¬è³‡è¨Š](images/23-å½ˆçª—-éœéŸ³è¦å‰‡-ç·¨è¼¯éœéŸ³è¦å‰‡1-åŸºæœ¬è³‡è¨Š.png)

**åŠŸèƒ½æè¿°**ï¼š
- éœéŸ³è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬ä¸€æ­¥
- å®šç¾©è¦å‰‡åç¨±å’Œæè¿°
- æä¾›å¿«é€Ÿå¥—ç”¨ç¯„æœ¬åŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/silence-rule-templates` - ç²å–å¯ç”¨çš„å¿«é€Ÿç¯„æœ¬åˆ—è¡¨

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¸¸ç”¨ç¯„æœ¬**ï¼šæä¾›å¸¸ç”¨éœéŸ³å ´æ™¯çš„ç¯„æœ¬ï¼ˆç¶­è­·çª—å£ã€éƒ¨ç½²æœŸé–“ã€ç‡Ÿæ¥­æ™‚é–“å¤–ï¼‰
2. **ç¯„æœ¬è‡ªå®šç¾©**ï¼šæ”¯æ´å°‡ç›®å‰é…ç½®å„²å­˜ç‚ºç¯„æœ¬ï¼Œä¾›æœªä¾†é‡è¤‡ä½¿ç”¨
3. **åˆ†äº«æ©Ÿåˆ¶**ï¼šæ”¯æ´ç¯„æœ¬åœ¨åœ˜éšŠé–“çš„åˆ†äº«å’Œå”ä½œ
4. **ç¯„æœ¬é©—è­‰**ï¼šåœ¨æ‡‰ç”¨ç¯„æœ¬å‰é è¦½å…¶å½±éŸ¿ç¯„åœ
5. **æ¬Šé™æ§åˆ¶**ï¼šåŸºæ–¼è§’è‰²å’Œåœ˜éšŠæ§åˆ¶ç¯„æœ¬çš„ä½¿ç”¨æ¬Šé™

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚æ­¤ç²¾éˆæ˜¯ç”¨æ–¼å»ºç«‹**å¯é‡è¤‡ä½¿ç”¨çš„ã€é€±æœŸæ€§çš„éœéŸ³è¦å‰‡**ï¼Œé€™æ˜¯æœ¬å¹³å°çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œæ—¨åœ¨è§£æ±ºåŸç”Ÿ Grafana åŠŸèƒ½çš„ä¸è¶³ã€‚æ­¤ç¬¬ä¸€æ­¥çš„é‡é»åœ¨æ–¼å®šç¾©è¦å‰‡çš„æ¥­å‹™ç›®çš„ï¼Œä¸¦é€éç¯„æœ¬åŠ é€Ÿå¸¸è¦‹å ´æ™¯çš„è¨­å®šã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **æ ¸å¿ƒé‚è¼¯ - å¹³å°ç®¡ç†çš„æ’ç¨‹ä½œæ¥­**:
    é€±æœŸæ€§éœéŸ³è¦å‰‡æ˜¯æœ¬å¹³å°ç¨æœ‰çš„æ¦‚å¿µã€‚å¾Œç«¯**å¿…é ˆ**åœ¨è‡ªèº«è³‡æ–™åº«ä¸­å„²å­˜å®Œæ•´çš„è¦å‰‡å®šç¾©ï¼ˆåç¨±ã€æè¿°ã€CRON æ’ç¨‹ã€åŒ¹é…ç¯„åœç­‰ï¼‰ã€‚ä¸€å€‹ç¨ç«‹çš„**æ’ç¨‹å™¨æœå‹™**æœƒï¼š
    a. å®šæœŸæª¢æŸ¥æ‰€æœ‰å·²å•Ÿç”¨çš„é€±æœŸæ€§éœéŸ³è¦å‰‡ã€‚
    b. ç•¶åµæ¸¬åˆ°æŸå€‹è¦å‰‡é€²å…¥å…¶ç”Ÿæ•ˆæ™‚é–“æ™‚ï¼Œå‹•æ…‹åœ°**é€é Grafana API å»ºç«‹ä¸€å€‹æ¨™æº–çš„ä¸€æ¬¡æ€§éœéŸ³ (Silence)**ã€‚
    c. åœ¨è¦å‰‡çš„å¤±æ•ˆæ™‚é–“åˆ°é”æ™‚ï¼Œå†æ¬¡**é€é Grafana API åˆªé™¤**è©²æ¬¡æ€§éœéŸ³ã€‚

2.  **ç¯„æœ¬ API (`GET /api/v1/silence-rule-templates`)**:
    ã€Œå¿«é€Ÿå¥—ç”¨ç¯„æœ¬ã€åŠŸèƒ½æ˜¯æå‡æ•ˆç‡çš„é—œéµã€‚æ­¤ API çš„å›æ‡‰æ‡‰åŒ…å«èƒ½é å…ˆå¡«å¯«ç²¾éˆæ‰€æœ‰æ­¥é©Ÿçš„è³‡æ–™ã€‚

    *   **Response Payload ç¯„ä¾‹**:
        ```json
        [
          {
            "id": "tpl_weekend_maintenance",
            "name": "é€±æœ«ç¶­è­·çª—å£",
            "prefilled_data": {
              "rule_name": "é€±æœ«è³‡æ–™åº«ç¶­è­·çª—å£",
              "description": "æ¯é€±å…­å‡Œæ™¨ 2-4 é»çš„è³‡æ–™åº«ä¾‹è¡Œç¶­è­·ï¼ŒæœŸé–“éœéŸ³ç›¸é—œå‘Šè­¦ã€‚",
              "schedule": {
                "type": "RECURRING",
                "cron": "0 2 * * 6", // At 02:00 on Saturday
                "duration": "2h"
              },
              "scope": {
                "matchers": [
                  { "key": "service", "value": "user-database", "isRegex": false }
                ]
              }
            }
          }
        ]
        ```

3.  **å‰ç«¯ç‹€æ…‹ç®¡ç†**:
    èˆ‡äº‹ä»¶è¦å‰‡ç²¾éˆä¸€æ¨£ï¼Œé»æ“Šã€Œä¸‹ä¸€æ­¥ã€æ™‚**ä¸æ‡‰**å‘¼å« APIã€‚æ­¤æ­¥é©Ÿçš„è³‡æ–™ (`rule_name`, `description`) æ‡‰å„²å­˜åœ¨å®¢æˆ¶ç«¯ç‹€æ…‹ç®¡ç†å™¨ä¸­ï¼Œå¾…ç²¾éˆæœ€å¾Œä¸€æ­¥å®Œæˆæ™‚ï¼Œæ‰å°‡å®Œæ•´çš„è¦å‰‡ç‰©ä»¶çµ„è£ä¸¦ç™¼é€åˆ°å¾Œç«¯ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **ç¯„æœ¬å„ªå…ˆçš„å·¥ä½œæµç¨‹ (Template-First Workflow)**:
    æ­¤ä»‹é¢è¨­è¨ˆå·²ç¶“å¾ˆå¥½åœ°çªé¡¯äº†ç¯„æœ¬ã€‚å¯ä»¥é€²ä¸€æ­¥å¼·åŒ–ï¼Œä¾‹å¦‚åœ¨è¦–è¦ºä¸Šå°‡ç¯„æœ¬å€å¡Šç½®æ–¼æ›´æ ¸å¿ƒçš„ä½ç½®ï¼Œå¼•å°ä½¿ç”¨è€…å°‡å…¶ä½œç‚ºé¦–é¸çš„ã€æœ€å¿«çš„æ“ä½œè·¯å¾‘ã€‚

2.  **å…è¨±å„²å­˜è‡ªè¨‚ç¯„æœ¬ (Custom Templates)**:
    åœ¨ç²¾éˆçš„æœ€å¾Œç¢ºèªæ­¥é©Ÿä¸­ï¼Œæä¾›ä¸€å€‹ã€Œ**å¦å­˜ç‚ºç¯„æœ¬**ã€çš„æ ¸å–æ–¹å¡Šæˆ–æŒ‰éˆ•ã€‚é€™èƒ½è®“åœ˜éšŠå°‡è‡ªå·±å¸¸ç”¨çš„ç¶­è­·æ“ä½œï¼ˆå¦‚ã€Œæ¯æœˆçµç®—æ‰¹æ¬¡ä½œæ¥­ã€ï¼‰å„²å­˜èµ·ä¾†ï¼Œæ¥µå¤§æå‡æœªä¾†æ“ä½œçš„æ•ˆç‡å’Œä¸€è‡´æ€§ã€‚

3.  **å¼•å°å¼æ–‡å­— (Guiding Placeholder Text)**:
    ã€Œè¦å‰‡åç¨±ã€å’Œã€Œæè¿°ã€å°æ–¼æœªä¾†ç®¡ç†å’Œå¯©è¨ˆè‡³é—œé‡è¦ã€‚è¼¸å…¥æ¡†çš„é è¨­æç¤ºæ–‡å­—æ‡‰å¼•å°ä½¿ç”¨è€…æ’°å¯«æ¸…æ™°ã€æœ‰æ„ç¾©çš„å…§å®¹ï¼Œä¾‹å¦‚ï¼Œåœ¨ã€Œæè¿°ã€ä¸­æç¤ºï¼šã€Œè«‹ç°¡è¿°æ­¤éœéŸ³è¦å‰‡çš„ç›®çš„ã€ç¯„åœå’Œæ™‚é–“ï¼Œä»¥ä¾¿åœ˜éšŠå…¶ä»–æˆå“¡ç†è§£ã€‚ã€

#### ç·¨è¼¯éœéŸ³è¦å‰‡ - è¨­å®šæ’ç¨‹ [ç·¨è¼¯éœéŸ³è¦å‰‡2-è¨­å®šæ’ç¨‹](images/24-å½ˆçª—-éœéŸ³è¦å‰‡-ç·¨è¼¯éœéŸ³è¦å‰‡2-è¨­å®šæ’ç¨‹.png)

**åŠŸèƒ½æè¿°**ï¼š
- éœéŸ³è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬äºŒæ­¥
- å®šç¾©éœéŸ³è¦å‰‡çš„ç”Ÿæ•ˆæ™‚é–“
- æ”¯æ´å–®æ¬¡å’Œé€±æœŸæ€§éœéŸ³

**ç›¸é—œ API ç«¯é»**ï¼š
- ç„¡ç‰¹å®šAPIï¼Œè¨­å®šå€¼å°‡åºåˆ—åŒ–å„²å­˜

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¦–è¦ºåŒ–æ™‚é–“é¸æ“‡å™¨**ï¼šæä¾›æ—¥æ›†å’Œæ™‚é–“è»¸äº¤äº’å¼é¸æ“‡å™¨
2. **é è¨­æ™‚é–“æ®µ**ï¼šå…§å»ºå¸¸ç”¨æ™‚é–“æ®µï¼ˆå·¥ä½œæ™‚é–“ã€éå·¥ä½œæ™‚é–“ã€é€±æœ«ï¼‰
3. **æ™‚å€æ”¯æ´**ï¼šæ”¯æ´ä¸åŒæ™‚å€çš„æ™‚é–“è¨­å®šå’Œè½‰æ›
4. **æ’ç¨‹è¡çªæª¢æŸ¥**ï¼šè‡ªå‹•æª¢æŸ¥èˆ‡ç¾æœ‰éœéŸ³è¦å‰‡çš„æ™‚é–“è¡çª
5. **é‡è¦†é è¦½**ï¼šé¡¯ç¤ºåœ¨é¸å®šæ™‚é–“å…§çš„éœéŸ³è¦†è“‹æƒ…æ³

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚é€™æ˜¯é€±æœŸæ€§éœéŸ³è¦å‰‡åŠŸèƒ½çš„æ ¸å¿ƒï¼Œå…¶æŒ‘æˆ°åœ¨æ–¼æä¾›ä¸€å€‹ç°¡å–®æ˜“æ‡‚çš„ UIï¼ŒåŒæ™‚èƒ½åœ¨å¾Œç«¯è½‰è­¯ç‚ºç²¾ç¢ºçš„æ©Ÿå™¨å¯è®€æ’ç¨‹ (CRON è¡¨é”å¼)ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **æ ¸å¿ƒé‚è¼¯ - UI è‡³ CRON çš„ç¿»è­¯**:
    æ­¤æ­¥é©Ÿçš„è¨­å®šå°‡è¢«ä¿å­˜åœ¨å‰ç«¯ç‹€æ…‹ä¸­ï¼Œç›´åˆ°ç²¾éˆå®Œæˆçš„æœ€å¾Œä¸€æ­¥æ‰çµ±ä¸€æäº¤ã€‚å¾Œç«¯åœ¨æ”¶åˆ°æœ€çµ‚çš„è¦å‰‡ç‰©ä»¶æ™‚ï¼Œ**å¿…é ˆ**åŒ…å«ä¸€å€‹å¼·å¤§çš„ç¿»è­¯é‚è¼¯ï¼Œå°‡ UI ä¸­çš„èªæ„åŒ–é¸é …è½‰æ›ç‚ºæ¨™æº–çš„ CRON è¡¨é”å¼ã€‚

    *   **UI é¸é …**: `é‡è¤‡æ¨¡å¼: æ¯æœˆ`, `åŸ·è¡Œæ—¥æœŸ: æ¯æœˆæœ€å¾Œä¸€å¤©`, `éœéŸ³æ™‚æ®µ: 22:00`, `æŒçºŒæ™‚é–“: 8å°æ™‚`
        **å¾Œç«¯ç¿»è­¯** -> `cron: "0 22 L * *"` ä¸”æŒçºŒæ™‚é•·ç‚º `8h`ã€‚
    *   **UI é¸é …**: `é‡è¤‡æ¨¡å¼: æ¯é€±`, `åŸ·è¡Œæ—¥æœŸ: æ˜ŸæœŸä¸€, æ˜ŸæœŸä¸‰`, `éœéŸ³æ™‚æ®µ: 00:00`, `æŒçºŒæ™‚é–“: 1h`
        **å¾Œç«¯ç¿»è­¯** -> `cron: "0 0 * * 1,3"` ä¸”æŒçºŒæ™‚é•·ç‚º `1h`ã€‚

    å„²å­˜æ–¼å¹³å°è³‡æ–™åº«ä¸­çš„è¦å‰‡ï¼Œæ‡‰åŒæ™‚åŒ…å«èªæ„åŒ–é¸é …å’Œæœ€çµ‚ç”Ÿæˆçš„ CRON å­—ä¸²ï¼Œä»¥ä¾›æ’ç¨‹å™¨æœå‹™ä½¿ç”¨ã€‚

2.  **å‰ç«¯ç‹€æ…‹çš„ Payload çµæ§‹**:
    åœ¨å‰ç«¯ç‹€æ…‹ç®¡ç†å™¨ä¸­æ§‹å»ºçš„ `schedule` ç‰©ä»¶æ‡‰å…·å‚™å¦‚ä¸‹çµæ§‹ï¼š

    ```json
    "schedule": {
      "type": "RECURRING", // æˆ– "ONE_TIME"
      "recurrence": {
        "mode": "MONTHLY", // "DAILY", "WEEKLY", "MONTHLY"
        "day_of_month": "LAST_DAY", // æˆ– 1-31
        "day_of_week": null // æˆ– ["MON", "WED"]
      },
      "time_period": {
        "start_time": "22:00:00",
        "duration": "8h"
      },
      "validity": {
        "type": "PERMANENT", // "UNTIL_DATE", "EXECUTE_COUNT"
        "end_date": null,
        "count": null
      },
      "timezone": "Asia/Taipei" // å¿…é ˆæ˜ç¢ºæŒ‡å®šæ™‚å€
    }
    ```

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **è‡ªç„¶èªè¨€é è¦½ (Natural Language Preview)**:
    é€™æ˜¯æ­¤ä»‹é¢**ä¸å¯æˆ–ç¼º**çš„åŠŸèƒ½ã€‚é é¢ä¸­æ‡‰æœ‰ä¸€å€‹å”¯è®€çš„æ–‡å­—å€å¡Šï¼Œéš¨è‘—ä½¿ç”¨è€…è®Šæ›´é¸é …è€Œå³æ™‚æ›´æ–°ï¼Œç”¨äººé¡å¯è®€çš„èªè¨€ç¸½çµå…¶è¨­å®šã€‚
    *   **é è¦½ç¯„ä¾‹**: ã€Œæ­¤è¦å‰‡å°‡æ–¼**æ¯æœˆæœ€å¾Œä¸€å¤©**çš„ **22:00** é–‹å§‹ç”Ÿæ•ˆï¼Œä¸¦æŒçºŒ **8 å°æ™‚**ã€‚æ­¤æ’ç¨‹å°‡**æ°¸ä¹…æœ‰æ•ˆ**ã€‚ã€
    *   **æ ¸å¿ƒåƒ¹å€¼**: æä¾›å³æ™‚ã€æ¸…æ™°çš„è¨­å®šåé¥‹ï¼Œæ¥µå¤§åœ°é™ä½ä½¿ç”¨è€…å› èª¤è§£è€Œé…ç½®éŒ¯èª¤çš„é¢¨éšªã€‚

2.  **æ˜ç¢ºçš„æ™‚å€è™•ç† (Explicit Time Zone Handling)**:
    æ™‚å€æ˜¯æ’ç¨‹åŠŸèƒ½ä¸­æœ€å¸¸è¦‹çš„éŒ¯èª¤ä¾†æºã€‚
    *   **é¡¯ç¤ºç•¶å‰æ™‚å€**: UI **å¿…é ˆ**åœ¨æ™‚é–“è¨­å®šæ—æ¸…æ™°åœ°æ¨™ç¤ºå‡ºç•¶å‰æ‰€ä½¿ç”¨çš„æ™‚å€ï¼ˆä¾‹å¦‚ï¼šã€Œæ‰€æœ‰æ™‚é–“å‡ä»¥ **Asia/Taipei** æ™‚å€ç‚ºæº–ã€ï¼‰ã€‚
    *   **å…è¨±ä½¿ç”¨è€…é¸æ“‡**: ç†æƒ³æƒ…æ³ä¸‹ï¼Œæ‡‰æä¾›ä¸€å€‹ä¸‹æ‹‰é¸å–®è®“ä½¿ç”¨è€…é¸æ“‡ä»–å€‘æœŸæœ›çš„æ™‚å€ï¼Œä¸¦å°‡è©²å€¼ (`schedule.timezone`) æŒä¹…åŒ–ã€‚å¾ŒçºŒæ‰€æœ‰æ™‚é–“è¨ˆç®—æ‡‰ç”±å¾Œç«¯åŸºæ–¼æ­¤æ™‚å€é€²è¡Œã€‚

3.  **æ’ç¨‹è¡çªè¦–è¦ºåŒ– (Schedule Conflict Visualization)**:
    åœ¨å„²å­˜å‰ï¼Œç³»çµ±æ‡‰èƒ½æª¢æŸ¥ä¸¦æç¤ºæ½›åœ¨çš„æ’ç¨‹è¡çªã€‚
    *   **API å»ºè­°**: `POST /api/v1/silence-rules/check-conflict`ï¼Œæ­¤ API æ¥æ”¶ä¸€å€‹æ’ç¨‹è‰ç¨¿ï¼Œä¸¦å›å‚³èˆ‡ä¹‹é‡ç–Šçš„ç¾æœ‰è¦å‰‡åˆ—è¡¨ã€‚
    *   **UI æç¤º**: åœ¨ç²¾éˆçš„æœ€å¾Œç¢ºèªæ­¥é©Ÿä¸­ï¼Œé¡¯ç¤ºä¸€å€‹éé˜»æ–·å¼çš„è­¦å‘Šï¼šã€Œ**æ³¨æ„ï¼šæ­¤æ’ç¨‹èˆ‡ã€é€±æœ«ç¶­è­·ã€è¦å‰‡å­˜åœ¨éƒ¨åˆ†æ™‚é–“é‡ç–Šã€‚**ã€

4.  **æä¾›é€²éš CRON è¼¸å…¥æ¨¡å¼ (Advanced CRON Input)**:
    å°æ–¼é«˜éšä½¿ç”¨è€…ï¼Œæ‡‰æä¾›ä¸€å€‹åˆ‡æ›é–‹é—œï¼Œå…è¨±ä»–å€‘ç›´æ¥è¼¸å…¥æˆ–ç·¨è¼¯æ¨™æº–çš„ CRON å­—ä¸²ã€‚UI æ‡‰èƒ½é›™å‘åŒæ­¥ï¼šç°¡æ˜“æ¨¡å¼çš„é¸é …è®Šæ›´æ‡‰åæ˜ åœ¨ CRON å­—ä¸²ä¸Šï¼Œåä¹‹äº¦ç„¶ã€‚é€™èƒ½åŒæ™‚æ»¿è¶³ä¸åŒç¶“é©—æ°´å¹³ä½¿ç”¨è€…çš„éœ€æ±‚ã€‚

#### ç·¨è¼¯éœéŸ³è¦å‰‡ - è¨­å®šç¯„åœ [ç·¨è¼¯éœéŸ³è¦å‰‡3-è¨­å®šç¯„åœ](images/25-å½ˆçª—-éœéŸ³è¦å‰‡-ç·¨è¼¯éœéŸ³è¦å‰‡3-è¨­å®šç¯„åœ.png)

**åŠŸèƒ½æè¿°**ï¼š
- éœéŸ³è¦å‰‡ç·¨è¼¯ç²¾éˆçš„ç¬¬ä¸‰æ­¥
- å®šç¾©éœéŸ³è¦å‰‡å½±éŸ¿çš„ç¯„åœ
- æ”¯æ´è¤‡é›œçš„åŒ¹é…é‚è¼¯

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/resources/groups` - ç²å–è³‡æºç¾¤çµ„åˆ—è¡¨
- `GET /api/v1/tags/keys` - ç²å–æ‰€æœ‰å¯ç”¨çš„æ¨™ç±¤éµ
- `GET /api/v1/tags/values?key={key}` - ç²å–æŒ‡å®šæ¨™ç±¤éµçš„å¯ç”¨å€¼
- `POST /api/v1/silence-rules` - æäº¤å®Œæ•´çš„éœéŸ³è¦å‰‡ä»¥ä¾›å»ºç«‹

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ™ºèƒ½åŒ¹é…**ï¼šæ”¯æ´æ¨¡ç³ŠåŒ¹é…ã€æ­£å‰‡è¡¨é”å¼å’Œè¬ç”¨å­—å…ƒ
2. **ç¯„åœé è¦½**ï¼šå³æ™‚é¡¯ç¤ºåŒ¹é…æ¢ä»¶å°‡å½±éŸ¿çš„è³‡æºæ•¸é‡
3. **åˆ†çµ„ç®¡ç†**ï¼šæ”¯æ´å¤šå€‹åŒ¹é…çµ„å’Œé‚è¼¯é—œä¿‚ï¼ˆAND/ORï¼‰
4. **æ’é™¤æ¨¡å¼**ï¼šæ”¯æ´æ­£å‘å’Œåå‘åŒ¹é…çš„çµ„åˆ
5. **æ­·å²ç¯„åœ**ï¼šåŸºæ–¼æ­·å²ä½¿ç”¨çš„æ™ºèƒ½å»ºè­°å’Œå¿«æ·è¨­å®š

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤è¨­è¨ˆã€‚é€™æ˜¯éœéŸ³è¦å‰‡å»ºç«‹çš„æœ€å¾Œä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€é—œéµçš„ä¸€æ­¥ã€‚éŒ¯èª¤çš„ç¯„åœè¨­å®šå¯èƒ½å°è‡´éŒ¯éé—œéµå‘Šè­¦ï¼Œæˆ–æ„å¤–åœ°å°‡æ•´å€‹ç”Ÿç”¢ç’°å¢ƒéœéŸ³ã€‚å› æ­¤ï¼Œæ­¤ä»‹é¢çš„æ ¸å¿ƒç›®æ¨™å¿…é ˆæ˜¯**æ¸…æ™°åº¦**èˆ‡**å¯é æ¸¬æ€§**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š

1.  **æ ¸å¿ƒé‚è¼¯ - ç¿»è­¯ç‚º Grafana Matchers**:
    æ­¤ UI æ”¶é›†çš„ã€ŒéœéŸ³æ¢ä»¶ã€æœ€çµ‚æœƒè¢«ç¿»è­¯æˆ Grafana Silence API æ‰€éœ€çš„ `matchers` é™£åˆ—ã€‚
    *   **è³‡æºç¾¤çµ„**: é€™æ˜¯å¹³å°çš„ä¸€å€‹æŠ½è±¡æ¦‚å¿µã€‚ç•¶ä½¿ç”¨è€…é¸æ“‡ä¸€å€‹è³‡æºç¾¤çµ„ï¼ˆå¦‚ `monitoring`ï¼‰æ™‚ï¼Œå¾Œç«¯æ‡‰å°‡å…¶ç¿»è­¯ç‚ºä¸€å€‹æ¨™æº–çš„æ¨™ç±¤åŒ¹é…ï¼Œä¾‹å¦‚ `{ "name": "resource_group", "value": "monitoring", "isRegex": false }`ã€‚
    *   **è³‡æºæ¨™ç±¤**: é€™ç›´æ¥å°æ‡‰åˆ°ä¸€å€‹ matcherã€‚UI ä¸­é¡¯ç¤ºçš„ `è³‡æºæ¨™ç±¤ = staging`ï¼Œå°‡è¢«ç¿»è­¯ç‚º `{ "name": "env", "value": "staging", "isRegex": false }`ã€‚ï¼ˆæ³¨æ„ï¼šUI ä¸Šçš„ã€Œè³‡æºæ¨™ç±¤ã€æ‡‰æ”¹ç‚ºæ›´ç²¾ç¢ºçš„æ¨™ç±¤éµï¼Œå¦‚ `env`ï¼‰ã€‚

2.  **æœ€çµ‚è¦å‰‡ Payload (`POST /api/v1/silence-rules`)**:
    ç•¶ä½¿ç”¨è€…é»æ“Šã€Œå„²å­˜è¦å‰‡ã€æ™‚ï¼Œå‰ç«¯æœƒçµ„è£ä¾†è‡ªæ‰€æœ‰æ­¥é©Ÿçš„è³‡æ–™ã€‚`scope` å’Œ `options` éƒ¨åˆ†çš„çµæ§‹æ‡‰å¦‚ä¸‹æ‰€ç¤ºï¼š
    ```json
    // åŒ…å«åœ¨æœ€çµ‚éœéŸ³è¦å‰‡ç‰©ä»¶ä¸­çš„æ¬„ä½
    "scope": {
      "matchers": [
        { "name": "resource_group", "value": "monitoring", "isRegex": false },
        { "name": "env", "value": "staging", "isRegex": false } 
      ]
    },
    "options": {
        "start_immediately": true,
        "send_notification_on_start_end": false
    }
    ```
    å¾Œç«¯æ¥æ”¶åˆ°æ­¤ç‰©ä»¶å¾Œï¼Œå°‡å…¶å„²å­˜è‡³å¹³å°è³‡æ–™åº«ï¼Œä¸¦ç”±æ’ç¨‹å™¨æœå‹™æ ¹æ“šæ’ç¨‹ä¾†ç®¡ç† Grafana ä¸­çš„å¯¦éš›éœéŸ³ã€‚

3.  **æ”¯æ´æ€§ APIs**:
    *   `GET /api/v1/resource-groups`: ç²å–è³‡æºç¾¤çµ„åˆ—è¡¨ä»¥å¡«å……ä¸‹æ‹‰é¸å–®ã€‚
    *   `GET /api/v1/tags/keys`: ç²å–æ‰€æœ‰å¯ç”¨çš„æ¨™ç±¤**éµ**ä»¥å¡«å……ä¸‹æ‹‰é¸å–®ã€‚
    *   `GET /api/v1/tags/values?key=...`: ç²å–æŒ‡å®šæ¨™ç±¤éµçš„æ‰€æœ‰å·²çŸ¥**å€¼**ä»¥æä¾›è‡ªå‹•å®Œæˆå»ºè­°ã€‚
    *   `POST /api/v1/silence-rules/preview`: **(é—œéµ API)** æ­¤ API æ¥æ”¶ä¸€çµ„ `matchers`ï¼Œä¸¦å›å‚³å®ƒå€‘ç•¶å‰æœƒå½±éŸ¿çš„æ´»èºå‘Šè­¦æ•¸é‡ï¼Œä»¥å¯¦ç¾ã€Œå³æ™‚å½±éŸ¿é è¦½ã€ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š

1.  **å³æ™‚å½±éŸ¿é è¦½ (Live Impact Preview)**:
    é€™æ˜¯æ­¤ä»‹é¢**æœ€é‡è¦**çš„åŠŸèƒ½ï¼Œå¯ä»¥æ¥µå¤§æå‡ä½¿ç”¨è€…çš„ä¿¡å¿ƒä¸¦é˜²æ­¢éŒ¯èª¤ã€‚
    *   **å¯¦ç¾æ–¹å¼**: ç•¶ä½¿ç”¨è€…æ–°å¢ã€ç§»é™¤æˆ–ç·¨è¼¯ä»»ä½•ä¸€å€‹æ¢ä»¶æ™‚ï¼ŒUI æ‡‰ä½¿ç”¨ debounce æ©Ÿåˆ¶å‘¼å« `/api/v1/silence-rules/preview` APIã€‚
    *   **UI åé¥‹**: é é¢ä¸­æ‡‰æœ‰ä¸€å€‹æ¸…æ™°çš„æ–‡å­—å€åŸŸï¼Œå³æ™‚åé¥‹çµæœï¼Œä¾‹å¦‚ï¼šã€Œ**æ­¤ç¯„åœå°‡å½±éŸ¿ 15 å€‹è³‡æºä¸Šçš„ 23 æ¢æ´»èºå‘Šè­¦ã€‚**ã€

2.  **æä¾›å®Œæ•´çš„åŒ¹é…é‹ç®—å­ (Operator Flexibility)**:
    ç›®å‰çš„ UI åªé¡¯ç¤ºäº† `=` é‹ç®—å­ã€‚ç‚ºäº†ç™¼æ® Grafana çš„å…¨éƒ¨èƒ½åŠ›ï¼Œ**å¿…é ˆ**æ”¯æ´å…¶å®Œæ•´çš„é‹ç®—å­é›†ï¼š`!=` (ä¸ç­‰æ–¼), `=~` (æ­£å‰‡è¡¨é”å¼åŒ¹é…), å’Œ `!~` (æ­£å‰‡è¡¨é”å¼ä¸åŒ¹é…)ã€‚é€™å°æ–¼å»ºç«‹éˆæ´»ã€ç²¾ç¢ºçš„éœéŸ³è¦å‰‡è‡³é—œé‡è¦ã€‚

3.  **é€šçŸ¥é¸é …çš„æ¸…æ™°åŒ–**:
    ã€ŒéœéŸ³é–‹å§‹/çµæŸæ™‚ç™¼é€é€šçŸ¥ã€æ˜¯ä¸€å€‹å¾ˆå¥½çš„åŠŸèƒ½ã€‚å…¶æ¨™ç±¤æ–‡å­—æ‡‰æ›´å…·é«”ï¼Œä»¥ç®¡ç†ä½¿ç”¨è€…é æœŸï¼Œä¾‹å¦‚ï¼šã€Œ**éœéŸ³é–‹å§‹/çµæŸæ™‚ï¼Œå‘æˆ‘çš„é è¨­ç®¡é“ç™¼é€é€šçŸ¥**ã€ã€‚

### å‘Šè­¦è¦å‰‡ [äº‹ä»¶è¦å‰‡](images/11-é é¢-äº‹ä»¶è¦å‰‡.png)

**åŠŸèƒ½æè¿°**ï¼š
- äº‹ä»¶ç›£æ§è¦å‰‡é…ç½®ç®¡ç†
- è¦å‰‡åˆ—è¡¨ï¼šå•Ÿç”¨ç‹€æ…‹ã€è¦å‰‡åç¨±ã€ç›£æ§å°è±¡ã€è³‡æºæ¨™ç±¤ã€è§¸ç™¼æ¢ä»¶ã€é€šçŸ¥å°è±¡
- è¦å‰‡å•Ÿç”¨/åœç”¨é–‹é—œ
- æ‰¹æ¬¡æ“ä½œå’Œç¯©é¸åŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/event-rules` - ç²å–äº‹ä»¶è¦å‰‡åˆ—è¡¨
- `POST /api/v1/event-rules` - å‰µå»ºæ–°äº‹ä»¶è¦å‰‡
- `PUT /api/v1/event-rules/{id}` - æ›´æ–°äº‹ä»¶è¦å‰‡
- `DELETE /api/v1/event-rules/{id}` - åˆªé™¤äº‹ä»¶è¦å‰‡
- `PUT /api/v1/event-rules/{id}/toggle` - åˆ‡æ›è¦å‰‡å•Ÿç”¨ç‹€æ…‹

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¦å‰‡é è¦½**ï¼šå¢åŠ è¦å‰‡æ•ˆæœé è¦½åŠŸèƒ½
2. **æ¨¡æ¿åŒ–**ï¼šæä¾›å¸¸ç”¨è¦å‰‡æ¨¡æ¿å’Œå¿«é€Ÿé…ç½®
3. **ä¾è³´é—œä¿‚**ï¼šé¡¯ç¤ºè¦å‰‡ä¹‹é–“çš„ä¾è³´é—œä¿‚
4. **æ¸¬è©¦åŠŸèƒ½**ï¼šå¢åŠ è¦å‰‡æ¸¬è©¦å’Œé©—è­‰åŠŸèƒ½
5. **ä½¿ç”¨çµ±è¨ˆ**ï¼šé¡¯ç¤ºè¦å‰‡è§¸ç™¼é »ç‡å’Œæ•ˆæœçµ±è¨ˆ

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚å°‡æ­¤é é¢å®šä½ç‚º Grafana Alerting çš„ã€Œ**æ™ºæ…§å‹æŠ½è±¡å±¤**ã€æ˜¯å®Œå…¨æ­£ç¢ºçš„æ¶æ§‹æ±ºç­–ã€‚å…¶æ ¸å¿ƒåƒ¹å€¼ä¸åœ¨æ–¼é‡å»ºå‘Šè­¦å¼•æ“ï¼Œè€Œåœ¨æ–¼æä¾›**é è¶…åŸç”Ÿ Grafana çš„æ˜“ç”¨æ€§å’Œæ™ºæ…§åŒ–åŠŸèƒ½**ã€‚ä»¥ä¸‹å»ºè­°æ˜¯å¯¦ç¾æ­¤åƒ¹å€¼çš„é—œéµã€‚

æ­¤é é¢çš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼**æä¾›ä¸€å€‹æ¯”åŸç”Ÿ Grafana UI æ›´ç°¡å–®ã€æ›´å¼·å¤§ã€æ›´ç¬¦åˆ SRE å·¥ä½œæµç¨‹çš„è¦å‰‡ç®¡ç†é«”é©—**ã€‚å®ƒä¸æ˜¯è¦é‡å»ºå‘Šè­¦å¼•æ“ï¼Œè€Œæ˜¯è¦æˆç‚º Grafana Alerting çš„**æ™ºæ…§å‹æŠ½è±¡å±¤ (Intelligent Abstraction Layer)**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**ï¼š
1.  **æ ¸å¿ƒè·è²¬ï¼šç¿»è­¯èˆ‡ä»£ç†**ï¼šæœ¬æ¨¡çµ„çš„å¾Œç«¯æœå‹™ï¼Œå…¶æœ¬è³ªæ˜¯ä¸€å€‹**è«‹æ±‚ç¿»è­¯èˆ‡ä»£ç†å™¨**ã€‚å®ƒæ¥æ”¶ä¾†è‡ªå‰ç«¯çš„ã€ç°¡åŒ–éçš„è¦å‰‡å®šç¾©ï¼Œå°‡å…¶**ç¿»è­¯**æˆ Grafana API æ‰€è¦æ±‚çš„è¤‡é›œ JSON æ ¼å¼ï¼Œç„¶å¾Œé€é API å‘¼å« Grafana ä¾†å®Œæˆè¦å‰‡çš„å¢ã€åˆªã€æ”¹ã€æŸ¥ã€‚
2.  **API ç«¯é»å³ Grafana ä»£ç†**ï¼š
    *   `GET /api/v1/event-rules`ï¼šæ­¤ API æ‡‰å‘¼å« Grafana çš„ `GET /api/ruler/grafana/api/v1/rules`ï¼Œç²å–è¦å‰‡åˆ—è¡¨å¾Œï¼Œå°‡å…¶**åå‘ç¿»è­¯**æˆå‰ç«¯æ‰€éœ€çš„ç°¡åŒ–æ ¼å¼ã€‚
    *   `POST /api/v1/event-rules`ï¼šæ¥æ”¶å‰ç«¯çš„ç°¡æ˜“è¦å‰‡æ¨¡å‹ï¼Œè½‰æ›å¾Œå‘¼å« Grafana çš„ `POST /api/ruler/grafana/api/v1/rules/{Namespace}`ã€‚
    *   `PUT /api/v1/event-rules/{id}/toggle`ï¼šæœ¬è³ªä¸Šæ˜¯è®€å–å®Œæ•´çš„ Grafana è¦å‰‡ï¼Œä¿®æ”¹å…¶ `enabled` æ¬„ä½ï¼Œç„¶å¾Œå†å¯«å›å»ã€‚
3.  **è³‡æ–™åº«è§’è‰²ï¼šæ˜ å°„èˆ‡å¿«å–**ï¼šæœ¬åœ° PostgreSQL è³‡æ–™åº«ä¸æ‡‰å„²å­˜å®Œæ•´çš„è¦å‰‡å®šç¾©ï¼ˆSSOT åœ¨ Grafanaï¼‰ï¼Œè€Œæ‡‰ä¸»è¦ç”¨æ–¼å„²å­˜**å¹³å°å…§éƒ¨ ID èˆ‡ Grafana Rule UID çš„æ˜ å°„é—œä¿‚**ï¼Œä¸¦å¯é¸æ“‡æ€§åœ°å¿«å–éƒ¨åˆ†å…ƒæ•¸æ“šä»¥æé«˜åˆ—è¡¨é çš„è¼‰å…¥æ•ˆèƒ½ã€‚
4.  **ä¸€è‡´æ€§æ ¡é©—**ï¼šå¿…é ˆè¨­è¨ˆä¸€å€‹èƒŒæ™¯æ’ç¨‹ä½œæ¥­ï¼Œå®šæœŸï¼ˆå¦‚æ¯å°æ™‚ï¼‰å¾ Grafana å…¨é‡åŒæ­¥è¦å‰‡ï¼Œèˆ‡æœ¬åœ°æ˜ å°„è¡¨é€²è¡Œæ¯”å°ï¼Œä»¥åµæ¸¬ä¸¦ä¿®å¾©ä»»ä½•åœ¨ Grafana ä¸­æ‰‹å‹•ä¿®æ”¹è€Œå°è‡´çš„ç‹€æ…‹ä¸ä¸€è‡´ã€‚

**UX/UI å¼·åŒ–å»ºè­° (è¶…è¶ŠåŸç”Ÿ Grafana)**ï¼š
1.  **è¦–è¦ºåŒ–è¦å‰‡å»ºæ§‹å™¨**ï¼šé€™æ˜¯æœ€é‡è¦çš„åƒ¹å€¼æ‰€åœ¨ã€‚æä¾›ä¸€å€‹**å¼•å°å¼çš„ã€è¦–è¦ºåŒ–çš„è¦å‰‡å»ºæ§‹å™¨**ï¼Œè®“ä½¿ç”¨è€…é€éä¸‹æ‹‰é¸å–®é¸æ“‡æŒ‡æ¨™ã€é‹ç®—å­ã€èšåˆå‡½æ•¸ï¼Œä¸¦è¼¸å…¥é–¾å€¼ã€‚ç³»çµ±åœ¨èƒŒæ™¯è‡ªå‹•ç”Ÿæˆè¤‡é›œçš„ PromQL/MetricQL æŸ¥è©¢è¡¨é”å¼ã€‚
2.  **è¦å‰‡ã€Œè©¦é‹è¡Œã€èˆ‡å½±éŸ¿è©•ä¼° (Dry Run)**ï¼šåœ¨å„²å­˜è¦å‰‡å‰ï¼Œæä¾›ã€Œ**è©¦é‹è¡Œ**ã€åŠŸèƒ½ã€‚å¾Œç«¯æ¥æ”¶åˆ°è¦å‰‡å®šç¾©å¾Œï¼Œæ‹¿å®ƒå»æŸ¥è©¢éå»ä¸€æ®µæ™‚é–“ï¼ˆå¦‚ 24 å°æ™‚ï¼‰çš„æ™‚åºæ•¸æ“šï¼Œä¸¦åœ¨å‰ç«¯åœ–è¡¨ä¸Šç¹ªè£½å‡ºæŒ‡æ¨™æ›²ç·šã€é–¾å€¼ç·šï¼Œä»¥åŠæ‰€æœ‰**æ¨¡æ“¬è§¸ç™¼**çš„æ™‚é–“é»ã€‚é€™èƒ½è®“ä½¿ç”¨è€…åœ¨è¦å‰‡ä¸Šç·šå‰ï¼Œç›´è§€åœ°è©•ä¼°å…¶éˆæ•åº¦èˆ‡æº–ç¢ºæ€§ã€‚
3.  **å°ˆå®¶çŸ¥è­˜ç¯„æœ¬åŒ–**ï¼šå…§å»ºä¸€å€‹ç”±è³‡æ·± SRE ç¶­è­·çš„**è¦å‰‡ç¯„æœ¬åº«**ï¼Œæ¶µè“‹å¸¸è¦‹æ‡‰ç”¨ï¼ˆå¦‚ MySQL, Redis, Nginxï¼‰å’Œå¹³å°ï¼ˆå¦‚ Kubernetesï¼‰çš„æœ€ä½³ç›£æ§å¯¦è¸ã€‚ä½¿ç”¨è€…å¯ä¸€éµå¥—ç”¨ï¼Œä¸¦åƒ…éœ€å¡«å¯«å°‘é‡åƒæ•¸ï¼Œå³å¯å¿«é€Ÿå»ºç«‹èµ·ä¸€å¥—å¯é çš„ç›£æ§é«”ç³»ã€‚

### éœéŸ³è¦å‰‡ [éœéŸ³è¦å‰‡](images/12-é é¢-éœéŸ³è¦å‰‡.png)

**åŠŸèƒ½æè¿°**ï¼š
- é›†ä¸­ç®¡ç†æ‰€æœ‰å‘Šè­¦éœéŸ³è¦å‰‡çš„ä»‹é¢ã€‚
- éœéŸ³è¦å‰‡åˆ—è¡¨çš„æ¬„ä½åŒ…å«ï¼šå•Ÿç”¨é–‹é—œã€åç¨±ã€ç‹€æ…‹ã€é¡å‹ã€åŒ¹é…æ¢ä»¶ã€æ’ç¨‹ã€ä¸‹æ¬¡åŸ·è¡Œæ™‚é–“ã€å‰µå»ºè€…åŠæ“ä½œæŒ‰éˆ•ã€‚
- ã€Œç‹€æ…‹ã€æ¬„ä½ä½¿ç”¨ `é€±æœŸç”Ÿæ•ˆ`ã€`å³å°‡ç”Ÿæ•ˆ` ç­‰å½©è‰²å¾½ç« ï¼Œè¦–è¦ºåŒ–æ•ˆæœå¥½ã€‚
- ã€ŒåŒ¹é…æ¢ä»¶ã€ä»¥æ¨™ç±¤ï¼ˆTagsï¼‰çš„å½¢å¼æ¸…æ™°åœ°å±•ç¤ºäº†éœéŸ³çš„ç¯„åœã€‚
- ã€Œæ’ç¨‹ã€æ¬„ä½ä½¿ç”¨äº†å¦‚ `æ¯é€±å…­ 02:00-04:00` é€™æ¨£æ˜“æ–¼ç†è§£çš„æ–‡å­—æè¿°ã€‚
- æ”¯æ´åŸºæ–¼æ™‚é–“ï¼ˆå®šæ™‚ã€é€±æœŸï¼‰å’ŒåŸºæ–¼ç‰¹å®šæ¢ä»¶çš„éœéŸ³ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/silence-rules` - ç²å–éœéŸ³è¦å‰‡åˆ—è¡¨ï¼ˆæ”¯æ´ç¯©é¸å’Œåˆ†é ï¼‰ã€‚
- `POST /api/v1/silence-rules` - å‰µå»ºä¸€å€‹æ–°çš„éœéŸ³è¦å‰‡ã€‚
- `PUT /api/v1/silence-rules/{id}` - æ›´æ–°æŒ‡å®šçš„éœéŸ³è¦å‰‡ã€‚
- `DELETE /api/v1/silence-rules/{id}` - åˆªé™¤æŒ‡å®šçš„éœéŸ³è¦å‰‡ã€‚
- `PUT /api/v1/silence-rules/{id}/toggle` - å¿«é€Ÿå•Ÿç”¨æˆ–åœç”¨æŸå€‹è¦å‰‡ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¢åŠ æ—¥æ›†è¦–åœ–**ï¼šæä¾›ä¸€å€‹æ—¥æ›†è¦–åœ–ï¼Œå°‡æ‰€æœ‰éœéŸ³è¦å‰‡çš„ç”Ÿæ•ˆæ™‚é–“è¦–è¦ºåŒ–åœ°æ¨™ç¤ºå‡ºä¾†ï¼Œæ–¹ä¾¿ç®¡ç†è€…æŸ¥çœ‹æ’ç¨‹è¡çªæˆ–ç©ºæª”ã€‚
2. **å½±éŸ¿è©•ä¼°é è¦½**ï¼šåœ¨å»ºç«‹æˆ–ç·¨è¼¯è¦å‰‡æ™‚ï¼Œå¯ä»¥é è¦½æ­¤è¦å‰‡å¯èƒ½å½±éŸ¿åˆ°çš„å‘Šè­¦æ•¸é‡æˆ–è³‡æºç¯„åœã€‚
3. **è¦å‰‡è¡çªæª¢æ¸¬**ï¼šç•¶å»ºç«‹ä¸€å€‹æ–°çš„éœéŸ³è¦å‰‡æ™‚ï¼Œç³»çµ±æ‡‰è‡ªå‹•æª¢æ¸¬æ˜¯å¦èˆ‡ç¾æœ‰è¦å‰‡åœ¨æ™‚é–“æˆ–ç¯„åœä¸Šå­˜åœ¨é‡ç–Šæˆ–è¡çªï¼Œä¸¦çµ¦å‡ºæç¤ºã€‚
4. **æ“ä½œæ­·å²**ï¼šç‚ºæ¯å€‹è¦å‰‡å¢åŠ ä¸€å€‹æ“ä½œæ­·å²è¨˜éŒ„ï¼Œè¿½è¹¤èª°åœ¨ä½•æ™‚å°è¦å‰‡é€²è¡Œäº†å»ºç«‹ã€ä¿®æ”¹æˆ–åˆªé™¤ã€‚
5. **ç¯„æœ¬åŠŸèƒ½**ï¼šå°æ–¼å¸¸ç”¨çš„éœéŸ³å ´æ™¯ï¼ˆå¦‚ã€Œé€±æœ«è³‡æ–™åº«å‚™ä»½æœŸé–“ã€ï¼‰ï¼Œæä¾›å„²å­˜ç‚ºç¯„æœ¬çš„åŠŸèƒ½ï¼Œæ–¹ä¾¿å¿«é€Ÿå¥—ç”¨ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤åŠŸèƒ½æ˜¯æœ¬å¹³å°è¶…è¶ŠåŸç”Ÿ Grafana çš„**æ ¸å¿ƒåƒ¹å€¼**æ‰€åœ¨ã€‚åŸç”Ÿ Grafana åªæ”¯æ´ä¸€æ¬¡æ€§éœéŸ³ï¼Œè€Œæœ¬å¹³å°é€éè‡ªè¨‚æ’ç¨‹é‚è¼¯å¯¦ç¾çš„**é€±æœŸæ€§éœéŸ³**ï¼Œæ˜¯è§£æ±º SRE ä¾‹è¡Œç¶­è­·ç—›é»çš„é—œéµã€‚ä»¥ä¸‹æ¶æ§‹å’Œå»ºè­°æ˜¯å¯¦ç¾æ­¤åŠŸèƒ½çš„çµ•ä½³è—åœ–ã€‚

æ­¤åŠŸèƒ½æ˜¯æœ¬å¹³å°è¶…è¶ŠåŸç”Ÿ Grafana çš„**æ ¸å¿ƒåƒ¹å€¼**æ‰€åœ¨ã€‚Grafana Alerting åªæ”¯æ´ä¸€æ¬¡æ€§çš„éœéŸ³ï¼Œè€Œæœ¬å¹³å°é€éè‡ªè¨‚çš„æ’ç¨‹é‚è¼¯ï¼Œæä¾›äº†å¼·å¤§çš„**é€±æœŸæ€§éœéŸ³ (Recurring Silences)** åŠŸèƒ½ï¼Œé€™å°æ–¼ SRE é€²è¡Œä¾‹è¡Œç¶­è­·ï¼ˆå¦‚è³‡æ–™åº«å‚™ä»½ã€ç³»çµ±æ›´æ–°ï¼‰è‡³é—œé‡è¦ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (æ’ç¨‹å™¨ + Grafana ä»£ç†)**ï¼š
1.  **æ ¸å¿ƒå¼•æ“ï¼šè‡ªè¨‚æ’ç¨‹å™¨**ï¼š
    *   å¾Œç«¯**å¿…é ˆ**å¯¦ç¾ä¸€å€‹åŸºæ–¼ Cron çš„æ’ç¨‹å™¨ (Scheduler)ã€‚
    *   ç•¶ä½¿ç”¨è€…å»ºç«‹ä¸€å€‹ã€Œé€±æœŸæ€§ã€éœéŸ³è¦å‰‡æ™‚ï¼Œå¹³å°å°‡å…¶**æ’ç¨‹å®šç¾© (e.g., CRON è¡¨é”å¼ã€èµ·æ­¢æ™‚é–“)** å­˜å…¥è‡ªå·±çš„è³‡æ–™åº«ã€‚
    *   æ’ç¨‹å™¨æœƒå®šæœŸï¼ˆå¦‚æ¯åˆ†é˜ï¼‰æª¢æŸ¥æ‰€æœ‰é€±æœŸæ€§è¦å‰‡ã€‚ç•¶ç™¼ç¾æŸå€‹è¦å‰‡çš„ç”Ÿæ•ˆæ™‚é–“å·²åˆ°ï¼Œæ’ç¨‹å™¨æœƒ**å‹•æ…‹åœ°**å‘¼å« Grafana çš„ `POST /api/v1/silences` APIï¼Œ**å»ºç«‹ä¸€å€‹æ¨™æº–çš„ã€ä¸€æ¬¡æ€§çš„ Grafana Silence**ï¼Œå…¶èµ·æ­¢æ™‚é–“å°æ‡‰æœ¬æ¬¡é€±æœŸã€‚
2.  **ç‹€æ…‹è¨ˆç®—èˆ‡å‘ˆç¾**ï¼š
    *   UI ä¸Šé¡¯ç¤ºçš„ã€Œé€±æœŸç”Ÿæ•ˆã€ã€ã€Œå³å°‡ç”Ÿæ•ˆã€ç­‰ç‹€æ…‹ï¼Œæ˜¯**å¹³å°è¨ˆç®—çš„çµæœ**ï¼Œè€Œé Grafana çš„åŸç”Ÿç‹€æ…‹ã€‚
    *   `GET /api/v1/silence-rules` API åœ¨å›å‚³åˆ—è¡¨æ™‚ï¼Œéœ€è¦çµåˆè‡ªèº«è³‡æ–™åº«ä¸­çš„é€±æœŸè¨­å®šå’Œå¾ Grafana ç²å–çš„å³æ™‚éœéŸ³ç‹€æ…‹ï¼Œè¨ˆç®—å‡ºé€™äº›æ›´å‹å¥½çš„ç‹€æ…‹æ¨™ç±¤ã€‚
3.  **API è¨­è¨ˆ**ï¼š
    *   `POST /api/v1/silence-rules`ï¼šæ­¤ API çš„è«‹æ±‚é«” (Payload) éœ€åŒ…å« `type` (`one-time` æˆ– `recurring`) æ¬„ä½ã€‚å¦‚æœ `type` æ˜¯ `recurring`ï¼Œå‰‡å¿…é ˆåŒ…å« `schedule` (å¦‚ CRON å­—ä¸²) å’Œ `duration` (å¦‚ `2h`) ç­‰æ¬„ä½ã€‚
    *   `GET /api/v1/silence-rules`ï¼šAPI å›æ‡‰ä¸­ï¼Œå°æ–¼é€±æœŸæ€§è¦å‰‡ï¼Œæ‡‰åŒ…å« `next_execution_time` æ¬„ä½ï¼Œç”±å¾Œç«¯æ’ç¨‹å™¨è¨ˆç®—å¾—å‡ºã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **æ•´åˆçš„ SRE ç¶­é‹æ—¥æ›†**ï¼šå°‡ã€Œæ—¥æ›†è¦–åœ–ã€çš„å»ºè­°æå‡ç‚º**æ•´åˆçš„ã€ŒSRE ç¶­é‹æ—¥æ›†ã€**ã€‚åœ¨ä¸€å€‹çµ±ä¸€çš„æ—¥æ›†ä»‹é¢ä¸Šï¼Œç–ŠåŠ é¡¯ç¤º**éœéŸ³æ’ç¨‹**ã€**åœ˜éšŠå€¼ç­è¡¨ (On-Call)** å’Œ**å·²è¦åŠƒçš„éƒ¨ç½²/è®Šæ›´äº‹ä»¶**ã€‚é€™å°‡æˆç‚ºåœ˜éšŠè¦åŠƒå’Œå”èª¿å·¥ä½œçš„å–®ä¸€äº‹å¯¦ä¾†æº (SSOT)ã€‚
2.  **å³æ™‚çš„ã€Œå½±éŸ¿è©•ä¼°ã€**ï¼šåœ¨å»ºç«‹æˆ–ç·¨è¼¯éœéŸ³è¦å‰‡æ™‚ï¼Œæ ¹æ“šä½¿ç”¨è€…è¼¸å…¥çš„åŒ¹é…æ¢ä»¶ï¼Œå¾Œç«¯æ‡‰**å³æ™‚æŸ¥è©¢ Elasticsearch**ï¼Œä¸¦åœ¨å‰ç«¯åé¥‹ã€Œæ­¤è¦å‰‡åœ¨éå» 24 å°æ™‚å…§å¯èƒ½å½±éŸ¿äº† X æ¢å‘Šè­¦ã€ï¼Œä»¥å¹«åŠ©ä½¿ç”¨è€…ç²¾æº–è¨­å®šç¯„åœï¼Œé¿å…éåº¦éœéŸ³ã€‚
3.  **å¾ã€Œäº‹ä»¶ã€ä¸€éµå‰µå»º**ï¼šæ‡‰æä¾›å¾ã€Œäº‹ä»¶åˆ—è¡¨ã€é é¢ç‚ºæŸå€‹æ´»èºäº‹ä»¶**ä¸€éµå‰µå»ºéœéŸ³**çš„å¿«æ·æ“ä½œã€‚ç³»çµ±éœ€èƒ½è‡ªå‹•æå–äº‹ä»¶çš„æ¨™ç±¤ä½œç‚ºé å¡«çš„åŒ¹é…æ¢ä»¶ï¼Œä¸¦æä¾›ã€ŒéœéŸ³ 1 å°æ™‚ã€ã€ã€ŒéœéŸ³ 24 å°æ™‚ã€ã€ã€Œå»ºç«‹é€±æœŸæ€§éœéŸ³ã€ç­‰å¿«é€Ÿé¸é …ï¼Œæ¥µå¤§æå‡æ‡‰æ€¥éŸ¿æ‡‰æ•ˆç‡ã€‚

---

## 2.è³‡æºç®¡ç†

### è³‡æºåˆ—è¡¨ [è³‡æºåˆ—è¡¨](images/30-é é¢-è³‡æºåˆ—è¡¨.png)

**åŠŸèƒ½æè¿°**ï¼š
- åŸºç¤è¨­æ–½è³‡æºçµ±ä¸€ç®¡ç†ä»‹é¢
- è³‡æºçµ±è¨ˆ KPIï¼šç¸½è³‡æºæ•¸ã€å¥åº·è³‡æºã€å‘Šè­¦è³‡æºã€è³‡æºç¾¤çµ„
- åˆ†é è¦–åœ–ï¼šè³‡æºåˆ—è¡¨ã€è³‡æºç¾¤çµ„ã€æ‹“æ’²è¦–åœ–
- è³‡æºè¡¨æ ¼ï¼šç‹€æ…‹ã€åç¨±ã€IP ä½å€ã€ä½ç½®ã€æ‰€å±¬åœ–åƒã€è³‡æºé¡å‹ã€æ¨™ç±¤ã€é—œè¯äº‹ä»¶ã€CPU/è¨˜æ†¶é«”ä½¿ç”¨ç‡
- æœå°‹ã€ç¯©é¸ã€æ‰¹æ¬¡æ“ä½œåŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/resources` - ç²å–è³‡æºåˆ—è¡¨ï¼ˆæ”¯æ´åˆ†é ã€ç¯©é¸ã€æ’åºï¼‰
- `GET /api/v1/resources/{id}` - ç²å–è³‡æºè©³æƒ…
- `PUT /api/v1/resources/{id}` - æ›´æ–°è³‡æºè³‡è¨Š
- `DELETE /api/v1/resources/{id}` - åˆªé™¤è³‡æº
- `GET /api/v1/resources/statistics` - è³‡æºçµ±è¨ˆæ•¸æ“š
- `GET /api/v1/resources/{id}/metrics` - ç²å–è³‡æºæŒ‡æ¨™

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å³æ™‚æŒ‡æ¨™**ï¼šCPU/è¨˜æ†¶é«”ä½¿ç”¨ç‡æ‡‰ä½¿ç”¨å‹•æ…‹åœ–è¡¨é¡¯ç¤ºæ­·å²è¶¨å‹¢
2. **ç‹€æ…‹è¦–è¦ºåŒ–**ï¼šä½¿ç”¨æ›´ç›´è§€çš„å¥åº·ç‹€æ…‹æŒ‡ç¤ºå™¨ï¼ˆå¿ƒè·³åœ–ç¤ºã€è‰²å½©ç·¨ç¢¼ï¼‰
3. **å¿«é€Ÿæ“ä½œ**ï¼šå¢åŠ è³‡æºå¿«é€Ÿé‡å•Ÿã€é€£ç·šã€æŸ¥çœ‹æ—¥èªŒç­‰æ“ä½œ
4. **æ™ºèƒ½åˆ†çµ„**ï¼šæ”¯æ´æŒ‰ä½ç½®ã€é¡å‹ã€ç‹€æ…‹ç­‰ç¶­åº¦çš„æ™ºèƒ½åˆ†çµ„
5. **å‘Šè­¦æ•´åˆ**ï¼šåœ¨è³‡æºåˆ—è¡¨ä¸­ç›´æ¥é¡¯ç¤ºç›¸é—œå‘Šè­¦æ•¸é‡å’Œåš´é‡æ€§

#### ç·¨è¼¯è³‡æº [ç·¨è¼¯è³‡æº](images/33-å½ˆçª—-è³‡æºåˆ—è¡¨-ç·¨è¼¯è³‡æº.png)

**åŠŸèƒ½æè¿°**ï¼š
- è³‡æºç·¨è¼¯å½ˆçª—
- ä¿®æ”¹è³‡æºçš„åŸºæœ¬è³‡è¨Šå’Œé…ç½®
- æ”¯æ´è³‡æºå±¬æ€§æ›´æ–°å’Œæ¨™ç±¤ç®¡ç†

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/resources/{id}` - æ›´æ–°è³‡æºè³‡è¨Š

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¡¨å–®é©—è­‰**ï¼šå³æ™‚é©—è­‰è³‡æºé…ç½®çš„æœ‰æ•ˆæ€§å’Œæ ¼å¼
2. **æ‰¹é‡ç·¨è¼¯**ï¼šæ”¯æ´å¤šå€‹è³‡æºçš„æ‰¹é‡å±¬æ€§ä¿®æ”¹
3. **è®Šæ›´é è¦½**ï¼šåœ¨å„²å­˜å‰é¡¯ç¤ºè®Šæ›´å°æ¯”å’Œå½±éŸ¿åˆ†æ
4. **æ¨™ç±¤ç®¡ç†**ï¼šæä¾›ç›´è§€çš„æ¨™ç±¤ç·¨è¼¯å™¨ï¼Œæ”¯æ´æ‹–æ‹½å’Œæœå°‹
5. **é…ç½®æ¨¡æ¿**ï¼šç‚ºä¸åŒé¡å‹çš„è³‡æºæä¾›é…ç½®æ¨¡æ¿

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤å½ˆçª—æ˜¯**ç¶­è­· CMDB è³‡æ–™å“è³ª**çš„é—œéµäº’å‹•é»ã€‚åœ–ç‰‡ä¸­å±•ç¤ºçš„ã€Œæ¨™ç±¤ã€ç·¨è¼¯ä»‹é¢å°¤å…¶å‡ºè‰²ï¼Œå®ƒé€éæä¾›å»ºè­°ã€æè¿°å’Œä½¿ç”¨æ¬¡æ•¸ï¼Œæ¥µå¤§åœ°æå‡äº†ä½¿ç”¨è€…é«”é©—å’Œè³‡æ–™ä¸€è‡´æ€§ã€‚æˆ‘çš„å»ºè­°å°‡èšç„¦æ–¼**è³‡æ–™æ²»ç†**å’Œ**æ™ºæ…§åŒ–**çš„æ·±åŒ–ã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šè³‡æ–™æ²»ç†èˆ‡é©—è­‰**
1.  **è™•ç†æ‰‹å‹•èˆ‡è‡ªå‹•åŒ–çš„è¡çª**ï¼šè¡¨å–®ä¸­çš„æ¬„ä½ï¼ˆå¦‚ `IP ä½å€`, `é¡å‹`ï¼‰å¯èƒ½ç”±è‡ªå‹•åŒ–æ¢ç´¢å·¥å…·å¡«å……ã€‚å¹³å°å¿…é ˆæœ‰æ˜ç¢ºçš„**è³‡æ–™ä¾†æºå„ªå…ˆç´šç­–ç•¥**ã€‚
    *   **å»ºè­°ç­–ç•¥**ï¼šç”±è‡ªå‹•åŒ–æ¢ç´¢ç™¼ç¾çš„æ¬„ä½æ‡‰é è¨­ç‚º**å”¯è®€ (Read-only)**ï¼Œä¸¦åœ¨ UI ä¸Šç”¨ä¸€å€‹å°åœ–ç¤ºï¼ˆå¦‚ ğŸ”—ï¼‰æ¨™ç¤ºå…¶ä¾†æºã€‚è‹¥ä½¿ç”¨è€…ç¢ºå¯¦éœ€è¦è¦†å¯«ï¼Œå¯ä»¥æä¾›ä¸€å€‹ã€Œè§£é–ã€æˆ–ã€Œè¦†å¯«ã€æŒ‰éˆ•ï¼Œä½†æ­¤æ“ä½œå¿…é ˆ**è¨˜éŒ„æ˜ç¢ºçš„å¯©è¨ˆæ—¥èªŒ**ï¼Œèªªæ˜æ˜¯èª°åœ¨ä½•æ™‚è¦†å¯«äº†è‡ªå‹•å€¼ã€‚
    *   å¾Œç«¯ API (`PUT /api/v1/resources/{id}`) å¿…é ˆèƒ½è™•ç†é€™ç¨®å¸¶æœ‰ã€Œè¦†å¯«ã€æ¨™è¨˜çš„æ›´æ–°è«‹æ±‚ã€‚
2.  **å¼·åŒ–çš„å¾Œç«¯é©—è­‰**ï¼šAPI å¿…é ˆåŸ·è¡Œåš´æ ¼çš„è³‡æ–™é©—è­‰ï¼Œä¾‹å¦‚ï¼š
    *   `ip_address` å¿…é ˆç¬¦åˆæœ‰æ•ˆçš„ IP æ ¼å¼ã€‚
    *   `type` å¿…é ˆæ˜¯å¾Œå°é å…ˆå®šç¾©å¥½çš„æšèˆ‰å€¼ä¹‹ä¸€ã€‚
    *   æ‰€æœ‰å‚³å…¥çš„æ¨™ç±¤éµå’Œå€¼ï¼Œéƒ½æ‡‰èˆ‡ã€Œæ¨™ç±¤ç®¡ç†ã€æ¨¡çµ„ä¸­å®šç¾©çš„è¦å‰‡é€²è¡Œæ ¡é©—ã€‚
3.  **æ™ºæ…§æ¨™ç±¤ç³»çµ±çš„å¾Œç«¯æ”¯æ’**ï¼šç‚ºäº†å¯¦ç¾åœ–ç‰‡ä¸­å„ªç§€çš„æ¨™ç±¤ UIï¼Œå¾Œç«¯éœ€è¦æä¾›ï¼š
    *   `GET /api/v1/tags/keys`: ç²å–æ‰€æœ‰å·²å®šç¾©çš„æ¨™ç±¤**éµ**ï¼ŒåŠå…¶æè¿°ã€‚
    *   `GET /api/v1/tags/values?key=...`: æ ¹æ“šæ¨™ç±¤**éµ**ï¼Œç²å–æ‰€æœ‰æ¨è–¦çš„**å€¼**åŠå…¶ä½¿ç”¨æ¬¡æ•¸ã€‚
    *   **å¼·åˆ¶è©å½™è¡¨ (Enforced Vocabulary)**ï¼šã€Œæ¨™ç±¤ç®¡ç†ã€æ¨¡çµ„æ‡‰å…è¨±ç®¡ç†å“¡è¨­å®šæŸå€‹æ¨™ç±¤éµï¼ˆå¦‚ `env`ï¼‰çš„å€¼**åªèƒ½**å¾ä¸€å€‹é è¨­åˆ—è¡¨ï¼ˆ`production`, `staging`, `test`ï¼‰ä¸­é¸æ“‡ã€‚ç•¶ UI åµæ¸¬åˆ°é€™ç¨®å¼·åˆ¶æ€§æ¨™ç±¤æ™‚ï¼Œæ‡‰è‡ªå‹•å°‡å€¼çš„è¼¸å…¥æ¡†å¾ã€Œè‡ªç”±è¼¸å…¥ã€è½‰æ›ç‚ºã€Œ**ä¸‹æ‹‰é¸å–®**ã€ï¼Œå¾æºé ­ä¸Šä¿è­‰è³‡æ–™çš„ä¸€è‡´æ€§ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šæå‡ç¢ºå®šæ€§èˆ‡å¯è¿½æº¯æ€§**
1.  **å®Œæ•´çš„å¯©è¨ˆè¿½è¹¤ (Audit Trail)**ï¼šæ¯ä¸€æ¬¡é€éæ­¤å½ˆçª—é€²è¡Œçš„å„²å­˜æ“ä½œï¼Œéƒ½**å¿…é ˆ**ç”¢ç”Ÿä¸€æ¢è©³ç´°çš„**å¯©è¨ˆæ—¥èªŒ**ã€‚æ—¥èªŒæ‡‰è¨˜éŒ„ `resource_id`ã€æ“ä½œè€…ã€æ™‚é–“ã€**æ‰€æœ‰è¢«è®Šæ›´æ¬„ä½çš„å‰å¾Œå€¼å°æ¯”**ã€‚åœ¨å½ˆçª—çš„åº•éƒ¨ï¼Œå¯ä»¥å¢åŠ ä¸€å€‹ã€ŒæŸ¥çœ‹è®Šæ›´æ­·å²ã€çš„é€£çµï¼Œç›´æ¥å°å‘è©²è³‡æºçš„å¯©è¨ˆæ­·å²è¨˜éŒ„ã€‚
2.  **è¦–è¦ºåŒ–å€åˆ†è³‡æ–™ä¾†æº**ï¼šå¦‚ä¸Šæ‰€è¿°ï¼Œæ‡‰åœ¨ UI ä¸Šæ¸…æ™°åœ°æ¨™ç¤ºå‡ºå“ªäº›æ¬„ä½æ˜¯ä½¿ç”¨è€…æ‰‹å‹•è¼¸å…¥çš„ï¼Œå“ªäº›æ˜¯ç”±ç³»çµ±è‡ªå‹•åŒæ­¥çš„ã€‚é€™æœ‰åŠ©æ–¼ä½¿ç”¨è€…ç†è§£è³‡æ–™çš„ç”Ÿå‘½é€±æœŸï¼Œé¿å…æ··æ·†ã€‚
3.  **æ™ºæ…§æ¨è–¦è³‡æºç¾¤çµ„**ï¼šç›®å‰æ˜¯æ‰‹å‹•å‹¾é¸æ‰€å±¬ç¾¤çµ„ã€‚å¯ä»¥åŸºæ–¼è©²è³‡æºçš„**æ¨™ç±¤**é€²è¡Œæ™ºæ…§æ¨è–¦ã€‚ä¾‹å¦‚ï¼Œä¸€æ—¦ä¸€å€‹è³‡æºè¢«æ‰“ä¸Šäº† `app:database` å’Œ `env:production` çš„æ¨™ç±¤ï¼Œç³»çµ±å¯ä»¥è‡ªå‹•**å»ºè­°æˆ–é å…ˆå‹¾é¸**ã€ŒProduction Databaseã€é€™å€‹è³‡æºç¾¤çµ„ï¼Œæ¸›å°‘ä½¿ç”¨è€…çš„æ“ä½œè² æ“”ã€‚

### è³‡æºç¾¤çµ„ [è³‡æºç¾¤çµ„](images/31-é é¢-è³‡æºç¾¤çµ„.png)

**åŠŸèƒ½æè¿°**ï¼š
- è³‡æºé‚è¼¯åˆ†çµ„ç®¡ç†
- ç¾¤çµ„çµ±è¨ˆè³‡è¨Šé¡¯ç¤º
- ç¾¤çµ„åˆ—è¡¨ï¼šåç¨±ã€æè¿°ã€è² è²¬åœ˜éšŠã€è³‡æºæ•¸é‡ã€å¥åº·ç‹€æ…‹çµ±è¨ˆ
- ç¾¤çµ„å¥åº·ç‹€æ…‹åˆ†ä½ˆï¼ˆHealthy/Warning/Criticalï¼‰

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/resource-groups` - ç²å–è³‡æºç¾¤çµ„åˆ—è¡¨
- `POST /api/v1/resource-groups` - å‰µå»ºè³‡æºç¾¤çµ„
- `PUT /api/v1/resource-groups/{id}` - æ›´æ–°è³‡æºç¾¤çµ„
- `DELETE /api/v1/resource-groups/{id}` - åˆªé™¤è³‡æºç¾¤çµ„
- `GET /api/v1/resource-groups/{id}/resources` - ç²å–ç¾¤çµ„å…§è³‡æº
- `POST /api/v1/resource-groups/{id}/resources` - å‘ç¾¤çµ„æ·»åŠ è³‡æº

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¦–è¦ºåŒ–å„€è¡¨æ¿**ï¼šç‚ºæ¯å€‹ç¾¤çµ„æä¾›è¿·ä½ å„€è¡¨æ¿é¡¯ç¤ºé—œéµæŒ‡æ¨™
2. **æ‹–æ‹½åˆ†çµ„**ï¼šæ”¯æ´æ‹–æ‹½æ–¹å¼å°‡è³‡æºåˆ†é…åˆ°ä¸åŒç¾¤çµ„
3. **éšå±¤å¼çµæ§‹**ï¼šæ”¯æ´å·¢ç‹€ç¾¤çµ„å’Œå­ç¾¤çµ„ç®¡ç†
4. **æ¬Šé™ç®¡ç†**ï¼šèˆ‡åœ˜éšŠæ¬Šé™ç³»çµ±æ•´åˆï¼Œæ§åˆ¶ç¾¤çµ„è¨ªå•æ¬Šé™
5. **è‡ªå‹•åˆ†çµ„**ï¼šåŸºæ–¼æ¨™ç±¤æˆ–è¦å‰‡çš„è‡ªå‹•åˆ†çµ„åŠŸèƒ½

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚è³‡æºç¾¤çµ„æ˜¯å¯¦ç¾**ã€Œè²¬ä»»åˆ°äººã€**å’Œ**ã€Œè¦æ¨¡åŒ–ç®¡ç†ã€**çš„é—œéµæ©Ÿåˆ¶ã€‚å®ƒä¸åƒ…æ˜¯è³‡æºçš„å®¹å™¨ï¼Œæ›´æ˜¯ç­–ç•¥ã€æ¬Šé™å’Œç›£æ§çš„**ä½œç”¨åŸŸ (Scope)**ã€‚æ­¤è™•çš„è¨­è¨ˆç‚ºå¾ŒçºŒçš„æ·±åº¦æ•´åˆå¥ å®šäº†è‰¯å¥½åŸºç¤ã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šéœæ…‹èˆ‡å‹•æ…‹çµåˆ**
1.  **æ”¯æ´å…©ç¨®ç¾¤çµ„é¡å‹**ï¼šå¹³å°å¿…é ˆåŒæ™‚æ”¯æ´å…©ç¨®ç¾¤çµ„æ¨¡å¼ï¼Œä»¥æ‡‰å°ä¸åŒçš„ç®¡ç†éœ€æ±‚ã€‚
    *   **éœæ…‹ç¾¤çµ„ (Static Group)**ï¼šç”±ä½¿ç”¨è€…**æ‰‹å‹•**å°‡è³‡æºåŠ å…¥æˆ–ç§»é™¤ã€‚é©ç”¨æ–¼é‚Šç•Œæ¸…æ™°ã€æˆå“¡å›ºå®šçš„æ¥­å‹™æœå‹™ã€‚
    *   **å‹•æ…‹ç¾¤çµ„ (Dynamic Group)**ï¼šåŸºæ–¼ä¸€çµ„**æ¨™ç±¤åŒ¹é…è¦å‰‡**è‡ªå‹•æ›´æ–°æˆå“¡ã€‚ä¾‹å¦‚ï¼Œä¸€å€‹ã€Œç”Ÿç”¢ç’°å¢ƒ Nginxã€ç¾¤çµ„å¯ä»¥ç”±è¦å‰‡ `tags.env == "production" AND tags.app == "nginx"` ä¾†å®šç¾©ã€‚ä»»ä½•ç¬¦åˆæ­¤è¦å‰‡çš„æ–°è³‡æºéƒ½æœƒè¢«**è‡ªå‹•ç´å…¥**ã€‚
    *   åœ¨ã€Œæ–°å¢/ç·¨è¼¯ç¾¤çµ„ã€çš„å½ˆçª—ä¸­ï¼Œæ‡‰æä¾›ä¸€å€‹åˆ‡æ›é–‹é—œä¾†é¸æ“‡ç¾¤çµ„é¡å‹ã€‚
2.  **å¾Œç«¯å¯¦ç¾**ï¼š
    *   `resource_groups` è³‡æ–™è¡¨ä¸­éœ€è¦ä¸€å€‹ `type` æ¬„ä½ (`static` æˆ– `dynamic`) å’Œä¸€å€‹ `rules` æ¬„ä½ (JSONBï¼Œç”¨æ–¼å„²å­˜å‹•æ…‹è¦å‰‡)ã€‚
    *   ä¸€å€‹èƒŒæ™¯ä½œæ¥­éœ€è¦å®šæœŸåŸ·è¡Œï¼Œæƒææ‰€æœ‰å‹•æ…‹ç¾¤çµ„çš„è¦å‰‡ï¼Œä¸¦æ›´æ–°å…¶æˆå“¡é—œä¿‚å¿«å–ã€‚
3.  **API æ•ˆèƒ½**ï¼š
    *   `GET /api/v1/resource-groups` API å›æ‡‰ä¸­çš„ã€Œç‹€æ…‹ã€çµ±è¨ˆï¼ˆå¥åº·ã€è­¦å‘Šã€åš´é‡ï¼‰**çµ•ä¸èƒ½**å³æ™‚è¨ˆç®—ã€‚é€™å¿…é ˆç”±ä¸€å€‹éåŒæ­¥çš„èƒŒæ™¯ä½œæ¥­ï¼ˆå¦‚æ¯ 5 åˆ†é˜ï¼‰é å…ˆè¨ˆç®—ä¸¦å¿«å–ã€‚å³æ™‚è¨ˆç®—æœƒå°è‡´åš´é‡çš„æ•ˆèƒ½å•é¡Œã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šç¾¤çµ„å³æ˜¯è¿·ä½ å„€è¡¨æ¿**
1.  **è®“çµ±è¨ˆæ•¸å­—å¯æ“ä½œ**ï¼šç¾¤çµ„åˆ—è¡¨ä¸­çš„ã€Œç‹€æ…‹ã€æ¬„ä½ï¼ˆå¦‚ `Healthy: 1`, `Warning: 0`, `Critical: 0`ï¼‰ä¸åƒ…æ˜¯æ•¸å­—ï¼Œæ›´æ‡‰æ˜¯**å¯é»æ“Šçš„ç¯©é¸å™¨**ã€‚é»æ“Š `Critical: 0` æ‡‰ç›´æ¥è·³è½‰åˆ°è³‡æºåˆ—è¡¨é ï¼Œä¸¦è‡ªå‹•ç¯©é¸å‡ºå±¬æ–¼ã€ŒProduction Databaseã€ç¾¤çµ„ä¸”ç‹€æ…‹ç‚ºã€ŒCriticalã€çš„è³‡æºã€‚
2.  **å¢åŠ è¶¨å‹¢èˆ‡ SLO è¦–åœ–**ï¼š
    *   åœ¨æ¯ä¸€è¡Œå¢åŠ ä¸€å€‹**è¿·ä½ è¶¨å‹¢åœ–**ï¼Œé¡¯ç¤ºè©²ç¾¤çµ„å…§ `Critical` äº‹ä»¶åœ¨éå» 24 å°æ™‚çš„è®ŠåŒ–è¶¨å‹¢ã€‚
    *   å¦‚æœè©²ç¾¤çµ„é—œè¯äº†æœå‹™ç­‰ç´šç›®æ¨™ (SLO)ï¼Œæ‡‰åœ¨æ­¤è™•ç°¡æ½”åœ°é¡¯ç¤ºå…¶**éŒ¯èª¤é ç®— (Error Budget)** çš„å‰©é¤˜ç™¾åˆ†æ¯”ã€‚é€™èƒ½ç‚º SRE æä¾›æ¥µå…¶é‡è¦çš„æ±ºç­–ä¾æ“šã€‚
3.  **ç¾¤çµ„ä½œç‚ºå…¨åŸŸç¯©é¸å™¨**ï¼šè³‡æºç¾¤çµ„æ‡‰æˆç‚ºå¹³å°ä¸­ä¸€å€‹**é€šç”¨ã€ä¸€è‡´çš„ç¯©é¸ç¶­åº¦**ã€‚åœ¨ã€Œäº‹ä»¶åˆ—è¡¨ã€ã€ã€Œå„€è¡¨æ¿ã€ã€ã€Œè‡ªå‹•åŒ–æ—¥èªŒã€ç­‰æ‰€æœ‰ç›¸é—œé é¢ï¼Œéƒ½æ‡‰æä¾›æŒ‰ã€Œè³‡æºç¾¤çµ„ã€é€²è¡Œç¯©é¸çš„åŠŸèƒ½ã€‚
4.  **å¼·åŒ–è²¬ä»»æ­¸å±¬**ï¼š
    *   ã€Œè² è²¬åœ˜éšŠã€æ¬„ä½æ‡‰æ˜¯ä¸€å€‹è¶…é€£çµï¼Œé»æ“Šå¾Œå¯è·³è½‰åˆ°è©²åœ˜éšŠçš„è©³ç´°è³‡æ–™é é¢ã€‚
    *   æ‡‰èˆ‡é€šçŸ¥ç³»çµ±æ•´åˆï¼Œå…è¨±ç›´æ¥å‘æŸå€‹ç¾¤çµ„çš„ã€Œè² è²¬åœ˜éšŠã€ç™¼é€é€šçŸ¥ã€‚

#### ç·¨è¼¯ç¾¤çµ„ [ç·¨è¼¯ç¾¤çµ„](images/34-å½ˆçª—-è³‡æºç¾¤çµ„-ç·¨è¼¯ç¾¤çµ„.png)

**åŠŸèƒ½æè¿°**ï¼š
- è³‡æºç¾¤çµ„ç·¨è¼¯å½ˆçª—
- ä¿®æ”¹ç¾¤çµ„çš„åŸºæœ¬è³‡è¨Šå’Œæˆå“¡é…ç½®
- æ”¯æ´ç¾¤çµ„å±¬æ€§æ›´æ–°å’Œè³‡æºåˆ†é…

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/resource-groups/{id}` - æ›´æ–°è³‡æºç¾¤çµ„

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æˆå“¡ç®¡ç†**ï¼šæä¾›ç›´è§€çš„æˆå“¡æ·»åŠ /ç§»é™¤ç•Œé¢ï¼Œæ”¯æ´æ‹–æ‹½æ“ä½œ
2. **æ¬Šé™ç¹¼æ‰¿**ï¼šä¿®æ”¹ç¾¤çµ„æ¬Šé™æ™‚æ¸…æ¥šé¡¯ç¤ºå°æˆå“¡çš„å½±éŸ¿
3. **ä¾è³´é—œä¿‚**ï¼šé¡¯ç¤ºå’Œç®¡ç†ç¾¤çµ„é–“çš„ä¾è³´é—œä¿‚
4. **å·¢ç‹€çµæ§‹**ï¼šæ”¯æ´çˆ¶å­ç¾¤çµ„çš„éšå±¤å¼ç®¡ç†
5. **æ´»å‹•æ—¥èªŒ**ï¼šè¨˜éŒ„å’Œé¡¯ç¤ºç¾¤çµ„çš„è®Šæ›´æ­·å²

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤å½ˆçª—æ˜¯å®šç¾©**ç®¡ç†é‚Šç•Œ**å’Œ**è²¬ä»»ç¯„åœ**çš„æ ¸å¿ƒä»‹é¢ã€‚åœ–ç‰‡ä¸­å±•ç¤ºçš„é›™æ¬„é¸æ“‡å™¨ (Dual Listbox) æ˜¯ç®¡ç†**éœæ…‹ç¾¤çµ„**æˆå“¡çš„ç¶“å…¸ä½œæ³•ã€‚æˆ‘çš„å»ºè­°æ—¨åœ¨å¼•å…¥**å‹•æ…‹ç¾¤çµ„**çš„é…ç½®èƒ½åŠ›ï¼Œä¸¦æå‡å¤§è¦æ¨¡ç’°å¢ƒä¸‹çš„å¯ç”¨æ€§ã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šå¼•å…¥å‹•æ…‹ç¾¤çµ„çš„é…ç½®**
1.  **å¼•å…¥æ¨¡å¼åˆ‡æ› (Mode Switcher)**ï¼šé€™æ˜¯æœ€é‡è¦çš„æ¶æ§‹å‡ç´šã€‚åœ¨å½ˆçª—é ‚éƒ¨ï¼Œæ‡‰å¢åŠ ä¸€å€‹**æ¨¡å¼åˆ‡æ›å™¨**ï¼ˆå¦‚åˆ†æ®µæ§åˆ¶å™¨ï¼‰ï¼ŒåŒ…å«å…©å€‹é¸é …ï¼š
    *   **ã€Œæ‰‹å‹•ç®¡ç†ã€**ï¼šé¸ä¸­æ™‚ï¼Œé¡¯ç¤ºåœ–ç‰‡ä¸­ç¾æœ‰çš„é›™æ¬„é¸æ“‡å™¨ï¼Œç”¨æ–¼æ‰‹å‹•æ·»åŠ /ç§»é™¤è³‡æºã€‚
    *   **ã€Œè¦å‰‡ç®¡ç†ã€**ï¼šé¸ä¸­æ™‚ï¼Œé›™æ¬„é¸æ“‡å™¨æ‡‰è¢«**æ›¿æ›**ç‚ºä¸€å€‹**è¦å‰‡ç”¢ç”Ÿå™¨ (Rule Builder)** ä»‹é¢ã€‚æ­¤ä»‹é¢å…è¨±ä½¿ç”¨è€…å®šç¾©ä¸€çµ„åŸºæ–¼**æ¨™ç±¤**çš„åŒ¹é…æ¢ä»¶ï¼ˆå¦‚ `tags.env == "production" AND tags.app == "database"`ï¼‰ã€‚
2.  **è¦å‰‡ç®¡ç†çš„å³æ™‚é è¦½**ï¼šåœ¨ã€Œè¦å‰‡ç®¡ç†ã€æ¨¡å¼ä¸‹ï¼Œä»‹é¢ä¸‹æ–¹æ‡‰æœ‰ä¸€å€‹å€åŸŸ**å³æ™‚é è¦½**ç›®å‰ç¬¦åˆè¦å‰‡çš„è³‡æºåˆ—è¡¨ã€‚é€™èƒ½è®“ä½¿ç”¨è€…åœ¨å„²å­˜å‰ï¼Œé©—è­‰å…¶è¦å‰‡çš„æº–ç¢ºæ€§ã€‚
3.  **éˆæ´»çš„å¾Œç«¯ API**ï¼š`PUT /api/v1/resource-groups/{id}` API çš„è«‹æ±‚é«” (Payload) å¿…é ˆèƒ½å¤ éˆæ´»è™•ç†å…©ç¨®æ¨¡å¼ï¼š
    *   è‹¥ç‚ºæ‰‹å‹•æ¨¡å¼ï¼ŒPayload æ‡‰åŒ…å«ä¸€å€‹ `resource_ids` é™£åˆ—ã€‚
    *   è‹¥ç‚ºè¦å‰‡æ¨¡å¼ï¼ŒPayload å‰‡æ‡‰åŒ…å«ä¸€å€‹ `rules` ç‰©ä»¶ï¼ˆä¾‹å¦‚ `{"operator": "AND", "conditions": [{"key": "tags.env", "op": "==", "value": "production"}]}`ï¼‰ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šæ‡‰å°è¦æ¨¡åŒ–æŒ‘æˆ°**
1.  **é›™æ¬„é¸æ“‡å™¨çš„å»¶å±•æ€§ (Scalability)**ï¼šç•¶ã€Œå¯ç”¨è³‡æºã€æ•¸é‡é¾å¤§æ™‚ï¼ˆæ•¸åƒå€‹ï¼‰ï¼Œç›®å‰çš„ UI æœƒå¤±æ•ˆã€‚å¿…é ˆé€²è¡Œå¼·åŒ–ï¼š
    *   **å¾Œç«¯åˆ†é èˆ‡æœå°‹**ï¼šå…©å€‹åˆ—è¡¨éƒ½å¿…é ˆå¯¦ç¾**å¾Œç«¯åˆ†é **ã€‚ä½¿ç”¨è€…çš„æ²å‹•æˆ–é»æ“Šé ç¢¼æ™‚ï¼Œæ‰å‘å¾Œç«¯è«‹æ±‚ä¸‹ä¸€é è³‡æ–™ã€‚
    *   **é€²éšç¯©é¸**ï¼šã€Œå¯ç”¨è³‡æºã€åˆ—è¡¨ä¸Šæ–¹çš„æœå°‹æ¡†ï¼Œä¸æ‡‰åªæ˜¯ä¸€å€‹ç°¡å–®çš„æ–‡å­—æœå°‹ã€‚å®ƒæ‡‰è©²æ˜¯ä¸€å€‹**é€²éšç¯©é¸å™¨**ï¼Œå…è¨±ä½¿ç”¨è€…æŒ‰è³‡æº**é¡å‹ã€ç‹€æ…‹ã€æ¨™ç±¤**ç­‰é€²è¡Œç¯©é¸ï¼Œä»¥å¿«é€Ÿæ‰¾åˆ°ä»–å€‘æƒ³è¦æ·»åŠ çš„è³‡æºã€‚
2.  **æ˜ç¢ºåŒ–ã€Œè² è²¬åœ˜éšŠã€çš„æ¬Šè²¬**ï¼šè®Šæ›´ã€Œè² è²¬åœ˜éšŠã€æ˜¯ä¸€å€‹é«˜é¢¨éšªæ“ä½œï¼Œå®ƒç›´æ¥å½±éŸ¿åˆ°æ¬Šé™å’Œé€šçŸ¥ã€‚ç•¶ä½¿ç”¨è€…è©¦åœ–ä¿®æ”¹æ­¤æ¬„ä½æ™‚ï¼Œæ‡‰å½ˆå‡ºä¸€å€‹**ç¢ºèªå°è©±æ¡†**ï¼Œæ˜ç¢ºå‘ŠçŸ¥å…¶å¾Œæœï¼Œä¾‹å¦‚ï¼šã€Œæ‚¨ç¢ºå®šè¦å°‡è² è²¬åœ˜éšŠè®Šæ›´ç‚ºã€è³‡æ–™åº«åœ˜éšŠã€å—ï¼Ÿè©²åœ˜éšŠçš„æˆå“¡å°‡ç²å¾—æ­¤ç¾¤çµ„å…§æ‰€æœ‰è³‡æºçš„ç®¡ç†æ¬Šé™ã€‚ã€
3.  **èˆ‡æ‹“æ’²è¦–åœ–çš„è¯å‹•**ï¼šåœ¨å½ˆçª—åº•éƒ¨å¢åŠ ä¸€å€‹ã€Œ**åœ¨æ‹“æ’²åœ–ä¸­é è¦½**ã€æŒ‰éˆ•ã€‚é»æ“Šå¾Œï¼Œå¯ä»¥åœ¨èƒŒæ™¯æ‰“é–‹æ‹“æ’²è¦–åœ–ï¼Œä¸¦é«˜äº®é¡¯ç¤ºç•¶å‰ç¾¤çµ„çš„æ‰€æœ‰æˆå“¡åŠå…¶ç›¸äº’é—œä¿‚ã€‚é€™æœ‰åŠ©æ–¼ä½¿ç”¨è€…å¾æ¶æ§‹çš„è§’åº¦ï¼Œå¯©è¦–ç¾¤çµ„æˆå“¡çš„åˆç†æ€§ã€‚

### è³‡æºæ‹“æ’² [æ‹“æ’²è¦–åœ–](images/32-é é¢-æ‹“æ’²è¦–åœ–.png)

**åŠŸèƒ½æè¿°**ï¼š
- è³‡æºé—œä¿‚æ‹“æ’²åœ–è¦–è¦ºåŒ–
- äº’å‹•å¼ç¶²çµ¡åœ–é¡¯ç¤ºè³‡æºä¾è³´é—œä¿‚
- ç¯€é»é¡å‹è‰²å½©ç·¨ç¢¼ï¼ˆè³‡æ–™åº«ã€ä¼ºæœå™¨ã€ç¶²è·¯ã€å¿«å–ã€ç›£æ§ç­‰ï¼‰
- åŠ›å°å‘ä½ˆå±€æ¼”ç®—æ³•
- æ“ä½œèªªæ˜å’Œåœ–ä¾‹

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/topology/nodes` - ç²å–æ‹“æ’²ç¯€é»æ•¸æ“š
- `GET /api/v1/topology/edges` - ç²å–æ‹“æ’²é€£æ¥é—œä¿‚
- `GET /api/v1/topology/layout/{type}` - ç²å–ç‰¹å®šä½ˆå±€çš„æ‹“æ’²æ•¸æ“š
- `POST /api/v1/topology/analyze` - åŸ·è¡Œæ‹“æ’²åˆ†æ

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¤šå±¤ç´šè¦–åœ–**ï¼šæ”¯æ´ç¸®æ”¾æŸ¥çœ‹ä¸åŒå±¤ç´šçš„æ‹“æ’²è©³æƒ…
2. **å¯¦æ™‚ç‹€æ…‹**ï¼šç¯€é»é¡è‰²å³æ™‚åæ˜ å¥åº·ç‹€æ…‹å’Œå‘Šè­¦
3. **è·¯å¾‘åˆ†æ**ï¼šé»æ“Šç¯€é»é¡¯ç¤ºå½±éŸ¿è·¯å¾‘å’Œä¾è³´éˆ
4. **ä½ˆå±€é¸é …**ï¼šæä¾›å¤šç¨®ä½ˆå±€æ¼”ç®—æ³•é¸æ“‡ï¼ˆæ¨¹ç‹€ã€ç’°å½¢ã€å±¤æ¬¡ç­‰ï¼‰
5. **ç¯©é¸åŠŸèƒ½**ï¼šæ”¯æ´æŒ‰é¡å‹ã€ç‹€æ…‹ã€åœ˜éšŠç­‰æ¢ä»¶ç¯©é¸é¡¯ç¤ºç¯€é»

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ‹“æ’²è¦–åœ–ä¸æ‡‰åªæ˜¯ä¸€å€‹éœæ…‹çš„æ¶æ§‹åœ–ï¼Œè€Œæ‡‰æ˜¯ä¸€å€‹**å³æ™‚çš„ã€äº’å‹•å¼çš„è¨ºæ–·å„€è¡¨æ¿**ã€‚å®ƒçš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼å°‡**æŠ½è±¡çš„ä¾è³´é—œä¿‚**èˆ‡**å³æ™‚çš„å¥åº·ç‹€æ…‹**çµåˆï¼Œå¹«åŠ© SRE å¿«é€Ÿå®šä½å•é¡Œæ ¹æºå’Œè©•ä¼°å½±éŸ¿ç¯„åœã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šCMDB ä½œç‚ºå–®ä¸€äº‹å¯¦ä¾†æº (SSOT)**
1.  **æ•¸æ“šä¾†æºå¿…é ˆæ˜¯ CMDB**ï¼šæ­¤æ‹“æ’²åœ–çš„å“è³ªå®Œå…¨å–æ±ºæ–¼ CMDB ä¸­**é—œä¿‚è³‡æ–™**çš„æº–ç¢ºæ€§ã€‚å¾Œç«¯å¿…é ˆæœ‰ä¸€å€‹æ¸…æ™°çš„è³‡æ–™åº«æ¨¡å‹ä¾†å„²å­˜ç¯€é»ï¼ˆ`nodes`ï¼Œå³ `resources` è¡¨ä¸­çš„è³‡æºï¼‰å’Œé‚Šï¼ˆ`edges`ï¼‰ã€‚`edges` è¡¨æ‡‰è‡³å°‘åŒ…å« `source_resource_id`, `target_resource_id` å’Œ `relationship_type`ï¼ˆå¦‚ `CONNECTS_TO`, `DEPENDS_ON`ï¼‰ç­‰æ¬„ä½ã€‚
2.  **é—œä¿‚çš„ç¶­è­·**ï¼šå¹³å°å¿…é ˆæä¾›ç¶­è­·é€™äº›é—œä¿‚è³‡æ–™çš„æ©Ÿåˆ¶ï¼Œç†æƒ³æƒ…æ³ä¸‹æ‡‰çµåˆï¼š
    *   **æ‰‹å‹•ç·¨è¼¯ä»‹é¢**ï¼šå…è¨±æ¶æ§‹å¸«æˆ– SRE æ‰‹å‹•å®šç¾©æœå‹™é–“çš„ä¾è³´é—œä¿‚ã€‚
    *   **è‡ªå‹•åŒ–æ¢ç´¢ API**ï¼šæä¾› API ç«¯é»ï¼Œè®“å¤–éƒ¨çš„æœå‹™ç¶²æ ¼ (Service Mesh) æˆ–ç¶²è·¯ç›£æ§å·¥å…·å¯ä»¥å°‡è‡ªå‹•æ¢ç´¢åˆ°çš„ä¾è³´é—œä¿‚æ¨é€è‡³ CMDBã€‚
3.  **API è¨­è¨ˆï¼šåˆ†é›¢éœæ…‹èˆ‡å‹•æ…‹è³‡æ–™**ï¼š
    *   `GET /api/v1/topology?resource_group=...`ï¼šæ­¤ API æ‡‰ç”¨æ–¼ç²å–**éœæ…‹**çš„æ‹“æ’²çµæ§‹ï¼ˆç¯€é»å’Œé‚Šï¼‰ã€‚å®ƒå¿…é ˆæ”¯æ´æŒ‰ã€Œè³‡æºç¾¤çµ„ã€é€²è¡Œç¯©é¸ï¼Œå› ç‚ºå…¨åŸŸæ‹“æ’²åœ–é€šå¸¸è³‡è¨Šé‡éå¤§è€Œé›£ä»¥ä½¿ç”¨ã€‚
    *   **å³æ™‚ç‹€æ…‹æ¨é€ (WebSocket)**ï¼šå‰ç«¯åœ¨ç¹ªè£½å‡ºéœæ…‹æ‹“æ’²åœ–å¾Œï¼Œæ‡‰é€é WebSocket è¨‚é–±å¯è¦‹ç¯€é»çš„**å¥åº·ç‹€æ…‹æ›´æ–°**ã€‚å¾Œç«¯çš„ä¸€å€‹æœå‹™æœƒæŒçºŒç›£æ§è³‡æºç‹€æ…‹ï¼Œä¸¦åœ¨ç‹€æ…‹è®Šæ›´æ™‚ï¼Œå°‡æ›´æ–°å³æ™‚æ¨é€çµ¦å‰ç«¯ã€‚é€™ç¨®æ–¹å¼é å„ªæ–¼å‰ç«¯çš„è¼ªè©¢ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šå¾ã€Œçœ‹åœ–ã€åˆ°ã€Œè¨ºæ–·ã€**
1.  **å¥åº·ç‹€æ…‹æ˜¯ç¬¬ä¸€è¦–è¦ºå…ƒç´ **ï¼šç¯€é»çš„é¡è‰²**ä¸æ‡‰**å›ºå®šç‚ºå…¶é¡å‹é¡è‰²ã€‚ç¯€é»çš„**é‚Šæ¡†é¡è‰²**æ‡‰å‹•æ…‹åæ˜ å…¶**å³æ™‚å¥åº·ç‹€æ…‹**ï¼š`ç¶ è‰²`ä»£è¡¨å¥åº·ï¼Œ`é»ƒè‰²`ä»£è¡¨è­¦å‘Šï¼Œ`ç´…è‰²`ä¸”**å¸¶æœ‰è„ˆè¡å‹•ç•«**ä»£è¡¨åš´é‡ã€‚é€™èƒ½è®“ SRE åœ¨ä¸€ç§’å…§è­˜åˆ¥å‡ºå•é¡Œç¯€é»ã€‚ç¯€é»ä¸­å¿ƒçš„åœ–ç¤ºå‰‡å¯ä»¥ä¿ç•™å…¶é¡å‹æ¨™è­˜ã€‚
2.  **äº’å‹•å¼æ•…éšœåˆ†æ**ï¼šé€™æ˜¯æ‹“æ’²åœ–çš„æ ¸å¿ƒåƒ¹å€¼ã€‚ç•¶ä½¿ç”¨è€…é»æ“Šä¸€å€‹**ç´…è‰²**ç¯€é»æ™‚ï¼š
    *   **è¦–è¦ºåŒ–çˆ†ç‚¸åŠå¾‘ (Blast Radius)**ï¼šåœ–ä¸­æ‰€æœ‰èˆ‡è©²æ•…éšœç¯€é»**ç„¡é—œ**çš„ç¯€é»å’Œé€£ç·šéƒ½æ‡‰**è®Šæš—**ã€‚æ‰€æœ‰**ä¸‹æ¸¸**çš„ä¾è³´ç¯€é»æ‡‰è¢«é«˜äº®ï¼Œæ¸…æ™°åœ°å±•ç¤ºå‡ºæ­¤æ¬¡æ•…éšœçš„**å½±éŸ¿ç¯„åœ**ã€‚
    *   **è¦–è¦ºåŒ–ä¸Šæ¸¸ä¾è³´ (Upstream Dependencies)**ï¼šåŒæ™‚ï¼Œæ‰€æœ‰**ä¸Šæ¸¸**çš„ä¾è³´ç¯€é»ä¹Ÿæ‡‰è¢«é«˜äº®ï¼Œä½†ä½¿ç”¨ä¸åŒçš„æ¨£å¼ï¼ˆä¾‹å¦‚è™›ç·šé«˜äº®ï¼‰ã€‚é€™ç‚º SRE æä¾›äº†å°‹æ‰¾**æ ¹æœ¬åŸå› **çš„ç·šç´¢ã€‚
3.  **é‚Š (Edge) ä¹Ÿæ˜¯è³‡è¨Šè¼‰é«”**ï¼šä¸åƒ…ç¯€é»ï¼Œç¯€é»ä¹‹é–“çš„é€£ç·šä¹Ÿæ‡‰æ‰¿è¼‰è³‡è¨Šã€‚æ»‘é¼ æ‡¸åœåœ¨é€£ç·šä¸Šæ™‚ï¼Œæ‡‰é¡¯ç¤ºä¸€å€‹å°å½ˆçª—ï¼Œå±•ç¤ºå…©å€‹æœå‹™é–“çš„é—œéµæŒ‡æ¨™ï¼Œå¦‚**æµé‡ (RPM)**ã€**éŒ¯èª¤ç‡ (%)** å’Œ **å»¶é² (Latency)**ã€‚é€™äº›è³‡æ–™å¯ä»¥å¾æœå‹™ç¶²æ ¼æˆ– APM ç³»çµ±ä¸­ç²å–ã€‚
4.  **æä¾›ã€Œæ™‚é–“æ—…è¡Œã€åŠŸèƒ½**ï¼šåœ¨ä»‹é¢ä¸‹æ–¹å¢åŠ ä¸€å€‹æ™‚é–“æ»‘æ¡¿ï¼Œå…è¨±ä½¿ç”¨è€…å›æº¯åˆ°éå»çš„æŸå€‹æ™‚é–“é»ï¼ˆä¾‹å¦‚ï¼Œäº‹æ•…ç™¼ç”Ÿæ™‚ï¼‰ï¼ŒæŸ¥çœ‹ç•¶æ™‚çš„æ‹“æ’²å¥åº·ç‹€æ…‹å¿«ç…§ã€‚é€™å°æ–¼äº‹å¾Œè¤‡ç›¤å’Œç†è§£æ•…éšœæ¼”è®Šéç¨‹éå¸¸æœ‰å¹«åŠ©ã€‚

---

## 3.å„€è¡¨æ¿

### å„€è¡¨æ¿ç®¡ç† [å„€è¡¨æ¿ç®¡ç†](images/40-é é¢-å„€è¡¨æ¿ç®¡ç†.png)

**åŠŸèƒ½æè¿°**ï¼š
- å„€è¡¨æ¿ç®¡ç†å…¥å£é é¢
- é è¨­å„€è¡¨æ¿ï¼šåŸºç¤è¨­æ–½æ´å¯Ÿ
- æ¥­å‹™å„€è¡¨æ¿ï¼šSRE æˆ°æƒ…å®¤

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/dashboards` - ç²å–å„€è¡¨æ¿åˆ—è¡¨
- `GET /api/v1/dashboards/{id}` - ç²å–ç‰¹å®šå„€è¡¨æ¿
- `POST /api/v1/dashboards` - å‰µå»ºæ–°å„€è¡¨æ¿
- `PUT /api/v1/dashboards/{id}` - æ›´æ–°å„€è¡¨æ¿
- `DELETE /api/v1/dashboards/{id}` - åˆªé™¤å„€è¡¨æ¿

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¡ç‰‡è¨­è¨ˆå„ªåŒ–**ï¼šå¢åŠ å„€è¡¨æ¿é è¦½åœ–æˆ–åœ–ç¤º
2. **å¿«æ·æ“ä½œ**ï¼šå¢åŠ ã€Œè¨­ç‚ºé è¨­ã€ã€ã€Œè¤‡è£½ã€ã€ã€Œåˆ†äº«ã€ç­‰å¿«æ·æ“ä½œ
3. **åˆ†é¡ç®¡ç†**ï¼šæ”¯æ´å„€è¡¨æ¿åˆ†é¡å’Œæ¨™ç±¤åŠŸèƒ½
4. **æœå°‹åŠŸèƒ½**ï¼šå¢åŠ å„€è¡¨æ¿æœå°‹å’Œéæ¿¾åŠŸèƒ½
5. **ä½¿ç”¨çµ±è¨ˆ**ï¼šé¡¯ç¤ºå„€è¡¨æ¿ä½¿ç”¨é »ç‡å’Œæœ€å¾Œè¨ªå•æ™‚é–“

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤é é¢æ˜¯å¹³å°çš„**è¦–è¦ºåŒ–ä¸­æ¨å…¥å£**ã€‚æ ¹æ“š `architecture.md` çš„æŒ‡å°åŸå‰‡ï¼Œæœ¬å¹³å°ä¸é‡è¤‡é€ è¼ªå­ï¼Œè€Œæ˜¯ä½œç‚º **Grafana çš„æ™ºæ…§å‹æŠ½è±¡å±¤**ã€‚å› æ­¤ï¼Œæ­¤é é¢çš„æ ¸å¿ƒæ˜¯**ç®¡ç†èˆ‡å‘ˆç¾**åœ¨ Grafana ä¸­å®šç¾©çš„å„€è¡¨æ¿ï¼Œè€Œéåœ¨æœ¬æ©Ÿé‡å»ºã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šGrafana çš„é–€æˆ¶ (Portal)**
1.  **è³‡æ–™åº«ä½œç‚ºé–€æˆ¶ç´¢å¼•**ï¼šæœ¬å¹³å°çš„å¾Œç«¯è³‡æ–™åº« (PostgreSQL) ä¸­æ‡‰æœ‰ä¸€å¼µ `dashboards` è¡¨ã€‚æ­¤è¡¨ä¸å„²å­˜å„€è¡¨æ¿çš„ JSON å…§å®¹ï¼Œè€Œæ˜¯ä½œç‚ºä¸€å€‹**ç´¢å¼•æˆ–é–€æˆ¶**ï¼Œå„²å­˜å„€è¡¨æ¿çš„**å…ƒè³‡æ–™**ï¼Œæ ¸å¿ƒæ¬„ä½åŒ…æ‹¬ï¼š
    *   `title`: åœ¨æœ¬å¹³å°é¡¯ç¤ºçš„å‹å–„åç¨±ã€‚
    *   `description`: åŠŸèƒ½æè¿°ã€‚
    *   `category`: ç”¨æ–¼ UI åˆ†é¡ï¼ˆå¦‚ `è³‡æºç›£æ§`, `æ¥­å‹™ç›£æ§`ï¼‰ã€‚
    *   `grafana_uid`: **æœ€é‡è¦çš„æ¬„ä½**ï¼Œå„²å­˜å°æ‡‰çš„ Grafana å„€è¡¨æ¿çš„å”¯ä¸€è­˜åˆ¥ç¢¼ (UID)ã€‚
    *   `grafana_url`: (å¯é¸) å„€è¡¨æ¿çš„ç›´æ¥ URLï¼Œç”¨æ–¼åµŒå…¥ã€‚
2.  **é€é `<iframe>` åµŒå…¥**ï¼šç•¶ä½¿ç”¨è€…é»æ“Šä»»ä½•ä¸€å€‹å„€è¡¨æ¿å¡ç‰‡æ™‚ï¼Œå‰ç«¯ä¸æ‡‰å˜—è©¦è‡ªå·±å»æ¸²æŸ“åœ–è¡¨ã€‚è€Œæ‡‰å°èˆªåˆ°ä¸€å€‹é€šç”¨çš„å„€è¡¨æ¿æª¢è¦–é é¢ï¼Œè©²é é¢å…§åµŒä¸€å€‹ `<iframe>`ï¼Œå…¶ `src` æŒ‡å‘å°æ‡‰çš„ Grafana å„€è¡¨æ¿ URLï¼Œä¸¦å¸¶ä¸Š `kiosk` æ¨¡å¼åƒæ•¸ä»¥éš±è— Grafana è‡ªèº«çš„ UI å…ƒç´ ï¼Œå¯¦ç¾ç„¡ç¸«æ•´åˆã€‚
3.  **æ¬Šé™ä»£ç†**ï¼šæœ¬å¹³å°æ‡‰æä¾›çµ±ä¸€çš„æ¬Šé™ç®¡ç†ã€‚ç•¶ä½¿ç”¨è€…è©¦åœ–å­˜å–æŸå„€è¡¨æ¿æ™‚ï¼Œæœ¬å¹³å°çš„å¾Œç«¯æ‡‰å…ˆæª¢æŸ¥è©²ä½¿ç”¨è€…æ˜¯å¦æœ‰æ¬Šé™ï¼ˆæ ¹æ“š `dashboards` è¡¨çš„å…ƒè³‡æ–™ï¼‰ï¼Œé©—è­‰é€šéå¾Œï¼Œæ‰å›å‚³åŒ…å« Grafana `src` çš„é é¢ã€‚é€™å¯¦ç¾äº†æ¯” Grafana åŸç”Ÿæ›´éˆæ´»çš„æ¬Šé™æ§åˆ¶ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šå¾ã€Œåˆ—è¡¨ã€åˆ°ã€Œå·¥å» ã€**
1.  **å„€è¡¨æ¿å³ä»£ç¢¼ (Dashboard as Code) èˆ‡ç¯„æœ¬åŒ–**ï¼šæä¾›ä¸€å€‹ã€Œ**å¾ç¯„æœ¬æ–°å¢**ã€çš„åŠŸèƒ½ã€‚ç®¡ç†å“¡å¯ä»¥é å…ˆå®šç¾©å¥½é©ç”¨æ–¼ä¸åŒå ´æ™¯çš„**å„€è¡¨æ¿ç¯„æœ¬**ï¼ˆä¾‹å¦‚ï¼Œã€Œæ¨™æº–å¾®æœå‹™ç›£æ§ç¯„æœ¬ã€ï¼‰ã€‚ç•¶éœ€è¦ç‚ºä¸€å€‹æ–°æœå‹™å»ºç«‹å„€è¡¨æ¿æ™‚ï¼Œä½¿ç”¨è€…åªéœ€é¸æ“‡è©²ç¯„æœ¬ï¼Œä¸¦æä¾›ä¸€äº›åƒæ•¸ï¼ˆå¦‚ `æœå‹™åç¨±`ã€`è³‡æºç¾¤çµ„`ï¼‰ï¼Œå¾Œç«¯å°±æœƒè‡ªå‹•å‘¼å« Grafana APIï¼Œ**å‹•æ…‹ç”¢ç”Ÿä¸¦éƒ¨ç½²**ä¸€å€‹æ–°çš„å„€è¡¨æ¿ã€‚
2.  **å€‹äººåŒ–èˆ‡æˆ‘çš„æœ€æ„›**ï¼š
    *   å…è¨±ä½¿ç”¨è€…å°‡ä»»ä½•å„€è¡¨æ¿ã€Œ**é‡˜é¸**ã€æˆ–ã€Œ**åŠ å…¥æˆ‘çš„æœ€æ„›**ã€ã€‚é é¢é ‚éƒ¨æ‡‰æœ‰ä¸€å€‹ã€Œæˆ‘çš„æœ€æ„›ã€å€åŸŸï¼Œå„ªå…ˆé¡¯ç¤ºé€™äº›å€‹äººåŒ–çš„æ·å¾‘ã€‚
    *   ã€Œé è¨­é¦–é ã€æ‡‰å¯ç”±ä½¿ç”¨è€…åœ¨å€‹äººè¨­å®šä¸­**è‡ªè¡ŒæŒ‡å®š**ã€‚
3.  **è±å¯ŒåŒ–å¡ç‰‡è³‡è¨Š**ï¼šç›®å‰çš„å¡ç‰‡è³‡è¨Šç•¥é¡¯å–®è–„ã€‚å¯ä»¥å¢åŠ ï¼š
    *   **å„€è¡¨æ¿ç¸®åœ–**ï¼šå¾Œç«¯å¯ä»¥å®šæœŸå° Grafana å„€è¡¨æ¿é€²è¡Œæˆªåœ–ï¼Œä½œç‚ºé è¦½åœ–é¡¯ç¤ºåœ¨å¡ç‰‡ä¸Šã€‚
    *   **æ“æœ‰è€…/åœ˜éšŠ**ï¼šé¡¯ç¤ºè©²å„€è¡¨æ¿çš„è² è²¬åœ˜éšŠã€‚
    *   **æ¨™ç±¤**ï¼šç‚ºå„€è¡¨æ¿æœ¬èº«ä¹ŸåŠ ä¸Šæ¨™ç±¤ï¼Œä¸¦æä¾›æŒ‰æ¨™ç±¤ç¯©é¸çš„åŠŸèƒ½ã€‚

### åŸºç¤è¨­æ–½æ´å¯Ÿ [åŸºç¤è¨­æ–½æ´å¯Ÿ](images/41-é é¢-åŸºç¤è¨­æ–½æ´å¯Ÿ.png)

**åŠŸèƒ½æè¿°**ï¼š
- åŸºç¤è¨­æ–½ç‹€æ…‹ç›£æ§å„€è¡¨æ¿
- é—œéµæŒ‡æ¨™ KPIï¼šä¼ºæœå™¨ç¸½æ•¸ã€è³‡æ–™åº«æ•¸é‡ã€å®¹å™¨æ•¸é‡ã€æœå‹™æ•¸é‡
- è³‡æºåˆ—è¡¨ç¸½è¦½ï¼ˆé¡¯ç¤º 374 å€‹è³‡æºï¼‰
- è©³ç´°å°‹æ±‚ï¼ˆä½¿ç”¨ç‡æ’è¡Œï¼‰ï¼šå„è³‡æºçš„ä½¿ç”¨ç‡æ¢ç‹€åœ–é¡¯ç¤º
- AI é¢¨éšªé æ¸¬ï¼šè­˜åˆ¥é«˜é¢¨éšªè³‡æºå’Œå»ºè­°
- éœ€é—œæ³¨çš„è³‡æºåˆ—è¡¨ï¼šæŒ‰åš´é‡æ€§åˆ†é¡é¡¯ç¤º

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/analytics/infrastructure/overview` - åŸºç¤è¨­æ–½æ¦‚è¦½æ•¸æ“š
- `GET /api/v1/analytics/infrastructure/utilization` - è³‡æºä½¿ç”¨ç‡æ’è¡Œ
- `GET /api/v1/analytics/infrastructure/predictions` - AI é¢¨éšªé æ¸¬
- `GET /api/v1/analytics/infrastructure/alerts` - éœ€é—œæ³¨è³‡æºåˆ—è¡¨

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å³æ™‚æ›´æ–°**ï¼šä½¿ç”¨ç‡æ¢ç‹€åœ–æ‡‰æ”¯æ´å³æ™‚æ›´æ–°å’Œæ­·å²è¶¨å‹¢æŸ¥çœ‹
2. **äº’å‹•å¼å°èˆª**ï¼šé»æ“Šè³‡æºå¯è·³è½‰åˆ°è©³ç´°ç›£æ§é é¢
3. **è‡ªå®šç¾©é–¾å€¼**ï¼šå…è¨±äººå“¡è¨­å®šä½¿ç”¨ç‡è­¦å‘Šå’Œå±éšªé–¾å€¼
4. **é æ¸¬æº–ç¢ºæ€§**ï¼šé¡¯ç¤º AI é æ¸¬çš„ç½®ä¿¡åº¦å’Œæ­·å²æº–ç¢ºç‡
5. **å¿«é€Ÿæ“ä½œ**ï¼šç‚ºé«˜ä½¿ç”¨ç‡è³‡æºæä¾›å¿«é€Ÿæ“´å®¹æˆ–å„ªåŒ–å»ºè­°

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤å„€è¡¨æ¿æ˜¯ SRE çš„**æ—¥å¸¸èµ·é»**ï¼Œæ—¨åœ¨æä¾›ä¸€å€‹é—œæ–¼åŸºç¤è¨­æ–½å¥åº·ç‹€æ³çš„**é«˜å¯†åº¦è³‡è¨Šæ¦‚è¦½**ã€‚å®ƒå®Œç¾åœ°é«”ç¾äº†æœ¬å¹³å°ã€Œçµ±ä¸€ç®¡ç†å¹³é¢ã€çš„åƒ¹å€¼â€”â€”å°‡ä¾†è‡ª CMDBã€ç›£æ§ç³»çµ±å’Œ AI å¼•æ“çš„è³‡æ–™èšåˆåœ¨ä¸€å€‹è¦–åœ–ä¸­ã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šä¸€å€‹è¢«ç²¾å¿ƒç·¨æ’çš„ Grafana å„€è¡¨æ¿**
1.  **å–®ä¸€ Grafana å„€è¡¨æ¿**ï¼šæ•´å€‹ã€ŒåŸºç¤è¨­æ–½æ´å¯Ÿã€é é¢æœ¬èº«å°±æ‡‰è©²æ˜¯ä¸€å€‹**å–®ä¸€çš„ã€ç¶“éç²¾å¿ƒè¨­è¨ˆçš„ Grafana å„€è¡¨æ¿**ï¼Œç„¶å¾Œè¢«ç„¡ç¸«åµŒå…¥åˆ°æœ¬å¹³å°ä¸­ã€‚å¹³å°è² è²¬ç®¡ç†å…¶ç”Ÿå‘½é€±æœŸå’Œå­˜å–æ¬Šé™ã€‚
2.  **Grafana çš„å¤šæºæ•¸æ“šèƒ½åŠ›**ï¼šç‚ºäº†å¯¦ç¾æ­¤å„€è¡¨æ¿ï¼ŒGrafana å¿…é ˆè¢«é…ç½®ç‚ºå¯ä»¥å¾æœ¬å¹³å°çš„**æ‰€æœ‰ç›¸é—œæ•¸æ“šæº**ä¸­æ‹‰å–è³‡æ–™ï¼š
    *   **VictoriaMetrics**ï¼šç”¨æ–¼ã€Œè³‡æºåˆ—è¡¨ç¸½è¦½ã€ä¸­çš„ä½¿ç”¨ç‡æŒ‡æ¨™ã€‚
    *   **PostgreSQL**ï¼šGrafana éœ€è¦å®‰è£ `PostgreSQL` è³‡æ–™ä¾†æºå¤–æ›ç¨‹å¼ï¼Œä½¿å…¶èƒ½å¤ ç›´æ¥æŸ¥è©¢æœ¬å¹³å°çš„ CMDB è³‡æ–™åº«ï¼Œä»¥ç²å–é ‚éƒ¨çš„ KPI è¨ˆæ•¸ï¼ˆå¦‚ä¼ºæœå™¨ç¸½æ•¸ï¼‰å’Œã€Œéœ€é—œæ³¨çš„è³‡æºåˆ—è¡¨ã€ã€‚
    *   **AI é æ¸¬è³‡æ–™åº«**ï¼šAI å¼•æ“åœ¨é€²è¡Œé¢¨éšªé æ¸¬å¾Œï¼Œæ‡‰å°‡å…¶çµæ§‹åŒ–çš„çµæœï¼ˆ`resource_id`, `prediction_text`, `confidence`, `risk_level`, `timestamp`ï¼‰å¯«å…¥ä¸€å€‹å°ˆé–€çš„è³‡æ–™åº«è¡¨ï¼ˆå¯ä»¥æ˜¯ PostgreSQL ä¸­çš„ä¸€å¼µæ–°è¡¨ï¼‰ã€‚Grafana é€éæŸ¥è©¢æ­¤è¡¨ä¾†å¡«å……ã€ŒAI é¢¨éšªé æ¸¬ã€é¢æ¿ã€‚
3.  **API çš„è§’è‰²è½‰è®Š**ï¼šæœ¬å¹³å°çš„å¾Œç«¯ API åœ¨æ­¤è™•çš„è§’è‰²**ä¸æ˜¯**ç‚ºå‰ç«¯æä¾›æ¸²æŸ“å„€è¡¨æ¿æ‰€éœ€çš„æ‰€æœ‰è³‡æ–™ã€‚ç›¸åï¼Œå®ƒçš„è·è²¬æ˜¯**ç‚º Grafana æä¾›å¯æŸ¥è©¢çš„è³‡æ–™ç«¯é»**ï¼Œæˆ–è€…ç¢ºä¿ Grafana èƒ½å¤ å®‰å…¨åœ°ç›´é€£åˆ°å¾Œç«¯è³‡æ–™åº«ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šè¬ç‰©çš†å¯ä¸‹é‘½ (Drill-Down)**
1.  **ç„¡è™•ä¸åœ¨çš„ä¸‹é‘½é€£çµ**ï¼šæ­¤å„€è¡¨æ¿ä¸Šçš„**æ¯ä¸€å€‹æ•¸æ“šé»**éƒ½æ‡‰è©²æ˜¯ä¸€å€‹ä¸‹é‘½çš„å…¥å£ï¼Œä»¥å¯¦ç¾å¾ã€Œç™¼ç¾å•é¡Œã€åˆ°ã€Œå®šä½å•é¡Œã€çš„ç„¡ç¸«è·³è½‰ã€‚
    *   é»æ“Šé ‚éƒ¨çš„ KPIï¼ˆå¦‚ã€Œ47 å°ä¼ºæœå™¨ã€ï¼‰ï¼Œæ‡‰è·³è½‰åˆ°**è³‡æºåˆ—è¡¨**é é¢ï¼Œä¸¦é å…ˆç¯©é¸å¥½ `type=server`ã€‚
    *   é»æ“Šã€Œè³‡æºåˆ—è¡¨ç¸½è¦½ã€ä¸­çš„ä»»ä½•ä¸€å€‹è³‡æºï¼Œæ‡‰è·³è½‰åˆ°è©²è³‡æº**å°ˆå±¬çš„ã€æ›´è©³ç´°çš„ç›£æ§å„€è¡¨æ¿**ï¼ˆé€™ä¹Ÿæ˜¯ä¸€å€‹ Grafana å„€è¡¨æ¿ï¼‰ã€‚
    *   é»æ“Šã€ŒAI é¢¨éšªé æ¸¬ã€ä¸­çš„ä¸€å€‹æ¢ç›®ï¼Œæ‡‰å½ˆå‡ºä¸€å€‹å°è©±æ¡†ï¼Œç”¨**åœ–è¡¨**å±•ç¤ºAIåšå‡ºæ­¤é æ¸¬çš„**ä¾æ“š**ï¼ˆä¾‹å¦‚ï¼ŒCPU ä½¿ç”¨ç‡çš„æ­·å²è¶¨å‹¢åœ–å’Œæœªä¾†é æ¸¬çš„æ“¬åˆæ›²ç·šï¼‰ã€‚
    *   é»æ“Šã€Œéœ€é—œæ³¨çš„è³‡æºåˆ—è¡¨ã€ä¸­çš„ä¸€å€‹è³‡æºï¼Œæ‡‰è·³è½‰åˆ°**äº‹ä»¶åˆ—è¡¨**é é¢ï¼Œä¸¦é å…ˆç¯©é¸å¥½è©²è³‡æºçš„æ‰€æœ‰æ´»èºäº‹ä»¶ã€‚
2.  **è³¦äºˆ AI é æ¸¬å¯è§£é‡‹æ€§**ï¼šAI é æ¸¬å¦‚æœæ˜¯ä¸€å€‹é»‘ç›’å­ï¼Œå°±å¾ˆé›£ç²å¾— SRE çš„ä¿¡ä»»ã€‚åœ¨æ¯å€‹é æ¸¬æ—é‚Šï¼Œæ‡‰å¢åŠ ä¸€å€‹ã€Œ**æŸ¥çœ‹è©³æƒ…**ã€æˆ–ã€Œ**è§£é‡‹**ã€çš„æŒ‰éˆ•ã€‚é»æ“Šå¾Œï¼Œå±•ç¤ºç”¨æ–¼æ¨æ–·çš„é—œéµæŒ‡æ¨™åœ–è¡¨å’Œåˆ†ææ‘˜è¦ï¼Œè®“ SRE èƒ½å¤ ç†è§£å’Œé©—è­‰é æ¸¬çš„é‚è¼¯ã€‚
3.  **å…¨å±€æ™‚é–“ç¯„åœé¸æ“‡å™¨**ï¼šä½œç‚ºä¸€å€‹åˆæ ¼çš„å„€è¡¨æ¿ï¼Œé é¢é ‚éƒ¨å¿…é ˆæœ‰ä¸€å€‹**æ™‚é–“ç¯„åœé¸æ“‡å™¨**ï¼ˆå¦‚ã€Œéå» 1 å°æ™‚ã€ã€ã€Œéå» 24 å°æ™‚ã€ï¼‰ã€‚é€™å€‹é¸æ“‡å™¨æœƒä½œç‚ºè®Šæ•¸ï¼Œå‚³éçµ¦é é¢ä¸­æ‰€æœ‰çš„ Grafana é¢æ¿ï¼Œç¢ºä¿æ‰€æœ‰è³‡æ–™éƒ½åœ¨çµ±ä¸€çš„æ™‚é–“ç¶­åº¦ä¸‹é€²è¡Œå±•ç¤ºã€‚

### SRE æˆ°æƒ…å®¤ [SREæˆ°æƒ…å®¤](images/42-é é¢-SREæˆ°æƒ…å®¤.png)

**åŠŸèƒ½æè¿°**ï¼š
- ç³»çµ±ç‹€æ…‹ç¸½è¦½å„€è¡¨æ¿
- å³æ™‚äº‹ä»¶çµ±è¨ˆå¡ç‰‡ï¼šå¾…è™•ç†äº‹ä»¶ã€è™•ç†ä¸­ã€ä»Šæ—¥å·²è§£æ±º
- AI æ¯æ—¥ç°¡å ±æ–‡å­—æ‘˜è¦
- æœå‹™å¥åº·åº¦ç¸½è¦½ï¼ˆå †ç–Šæ¢ç‹€åœ–ï¼‰
- è³‡æºç¾¤çµ„ç‹€æ…‹ç¸½è¦½ï¼ˆåˆ†çµ„æ¢ç‹€åœ–ï¼‰

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/dashboard/overview` - é¦–é çµ±è¨ˆæ•¸æ“š
- `GET /api/v1/events/summary` - äº‹ä»¶çµ±è¨ˆæ‘˜è¦
- `GET /api/v1/ai/daily-report` - AI æ¯æ—¥ç°¡å ±
- `GET /api/v1/resources/health-summary` - æœå‹™å¥åº·åº¦æ‘˜è¦
- `GET /api/v1/resource-groups/status-summary` - è³‡æºç¾¤çµ„ç‹€æ…‹æ‘˜è¦

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¦–è¦ºå±¤æ¬¡å„ªåŒ–**ï¼šKPI å¡ç‰‡æ•¸å€¼æ‡‰æ›´çªå‡ºï¼Œè€ƒæ…®å¢å¤§å­—é«”ä¸¦èª¿æ•´è‰²å½©å°æ¯”
2. **äº’å‹•æ€§å¢å¼·**ï¼šKPI å¡ç‰‡æ‡‰å¯é»æ“Šæ·±å…¥æŸ¥çœ‹è©³ç´°è³‡è¨Š
3. **AI ç°¡å ±æ”¹å–„**ï¼šå¢åŠ å±•é–‹/æ”¶åˆåŠŸèƒ½ï¼Œæä¾›æ›´è©³ç´°çš„åˆ†æå…§å®¹
4. **åœ–è¡¨å„ªåŒ–**ï¼šæ¢ç‹€åœ–æ‡‰æ”¯æ´ hover é¡¯ç¤ºå…·é«”æ•¸å€¼
5. **å¯¦æ™‚æ›´æ–°**ï¼šå¢åŠ è‡ªå‹•åˆ·æ–°åŠŸèƒ½å’Œæœ€å¾Œæ›´æ–°æ™‚é–“é¡¯ç¤º

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤åˆ†æã€‚æ­¤ã€Œæˆ°æƒ…å®¤ã€å„€è¡¨æ¿æ˜¯æ•´å€‹å¹³å°çš„**å¤§è…¦å’Œå¿ƒè‡Ÿ**ï¼Œå…¶è¨­è¨ˆç›®æ¨™æ˜¯å¾**æ¥­å‹™è¦–è§’**å‡ºç™¼ï¼Œå›ç­”ã€Œç³»çµ±ç¾åœ¨å¥½ä¸å¥½ï¼Ÿã€å’Œã€Œæˆ‘æ‡‰è©²ç«‹å³é—œæ³¨ä»€éº¼ï¼Ÿã€é€™å…©å€‹æ ¸å¿ƒå•é¡Œã€‚

**æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆï¼šä»¥ã€Œæ¥­å‹™æœå‹™ã€ç‚ºæ ¸å¿ƒçš„ Grafana å„€è¡¨æ¿**
1.  **å¼•å…¥ã€Œæ¥­å‹™æœå‹™ã€çš„æŠ½è±¡å±¤**ï¼šç‚ºäº†å¯¦ç¾ã€Œæœå‹™å¥åº·åº¦ç¸½è¦½ã€ï¼ŒCMDB ä¸­å¿…é ˆå¼•å…¥ä¸€å€‹æ¯”ã€Œè³‡æºç¾¤çµ„ã€æ›´é«˜å±¤æ¬¡çš„æŠ½è±¡â€”â€”**ã€Œæ¥­å‹™æœå‹™ (Business Service)ã€**ã€‚ä¸€å€‹ã€Œæ¥­å‹™æœå‹™ã€ï¼ˆå¦‚ `æ”¯ä»˜æœå‹™`ï¼‰å¯ä»¥ç”±**å¤šå€‹**ã€Œè³‡æºç¾¤çµ„ã€ï¼ˆå¦‚ `æ”¯ä»˜APIä¼ºæœå™¨ç¾¤çµ„`ã€`æ”¯ä»˜è³‡æ–™åº«ç¾¤çµ„`ï¼‰çµ„æˆã€‚
2.  **åŸºæ–¼ SLO çš„å¥åº·åº¦è¨ˆç®—**ï¼šåœ–ä¸­çš„ã€Œæœå‹™å¥åº·åº¦ç¸½è¦½ã€ç†±åœ–ï¼Œå…¶é¡è‰²ï¼ˆå¥åº·/è­¦å‘Š/åš´é‡ï¼‰çš„ä¾æ“šæ‡‰ä¾†è‡ªæ–¼**æœå‹™ç­‰ç´šç›®æ¨™ (SLO)**ã€‚å¾Œç«¯éœ€è¦æœ‰ä¸€å€‹æœå‹™ï¼Œèƒ½å¤ ï¼š
    *   ç‚ºæ¯å€‹ã€Œæ¥­å‹™æœå‹™ã€çš„æ¯å€‹ç›£æ§ç¶­åº¦ï¼ˆå»¶é²ã€æµé‡ã€éŒ¯èª¤ã€é£½å’Œåº¦ï¼‰å®šç¾© SLOã€‚
    *   æŒçºŒè¨ˆç®—ç•¶å‰çš„æ•ˆèƒ½æŒ‡æ¨™æ˜¯å¦é•åäº† SLOã€‚
    *   å°‡è¨ˆç®—å‡ºçš„å¥åº·ç‹€æ…‹çµæœå­˜å…¥è³‡æ–™åº«ï¼Œä¾› Grafana æŸ¥è©¢ã€‚
3.  **AI ç°¡å ±çš„ç”Ÿæˆèˆ‡å‘ˆç¾**ï¼š
    *   å¾Œç«¯çš„ AI Agent æ‡‰å®šæœŸï¼ˆå¦‚æ¯å°æ™‚ï¼‰åŸ·è¡Œä¸€å€‹åˆ†æä»»å‹™ï¼Œæƒæéå»ä¸€å°æ™‚çš„æŒ‡æ¨™å’Œäº‹ä»¶ï¼Œç”Ÿæˆé€™æ®µæ–‡å­—æ‘˜è¦ã€‚
    *   æ‘˜è¦å…§å®¹æ‡‰åŒ…å« **Markdown** æ ¼å¼çš„é€£çµï¼Œä»¥ä¾¿åœ¨å‰ç«¯å¯¦ç¾å¯é»æ“Šçš„è·³è½‰ã€‚
    *   `GET /api/v1/ai/daily-report` API åªéœ€å›å‚³å„²å­˜åœ¨è³‡æ–™åº«ä¸­çš„æœ€æ–°ç°¡å ±å³å¯ã€‚

**UX/UI å¼·åŒ–å»ºè­°ï¼šå°‡å„€è¡¨æ¿è®Šç‚ºæŒ‡æ®ä¸­å¿ƒ**
1.  **å®Œå…¨äº’å‹•çš„ç†±åœ– (Interactive Heatmap)**ï¼šç†±åœ–æ˜¯æ­¤å„€è¡¨æ¿çš„éˆé­‚ï¼Œå®ƒçš„æ¯ä¸€å€‹å–®å…ƒæ ¼éƒ½å¿…é ˆæ˜¯å¯æ“ä½œçš„ã€‚
    *   **é»æ“Šå–®å…ƒæ ¼**ï¼šä¾‹å¦‚ï¼Œé»æ“Šã€Œæ”¯ä»˜æœå‹™ã€åœ¨ã€ŒéŒ¯èª¤ã€ç¶­åº¦çš„ç´…è‰²æ ¼å­ï¼Œæ‡‰èƒ½ç«‹å³**ä¸‹é‘½ (Drill Down)** åˆ°ä¸€å€‹å°ˆé–€çš„ã€é å…ˆç¯©é¸å¥½çš„å„€è¡¨æ¿ï¼Œè©³ç´°å±•ç¤ºã€Œæ”¯ä»˜æœå‹™ã€çš„éŒ¯èª¤æ—¥èªŒã€éŒ¯èª¤ç‡è¶¨å‹¢å’Œç›¸é—œäº‹ä»¶ã€‚
    *   **æ‡¸åœé¡¯ç¤ºç´°ç¯€ (Hover)**ï¼šæ»‘é¼ æ‡¸åœåœ¨ä»»ä½•ä¸€å€‹æ ¼å­ä¸Šï¼Œéƒ½æ‡‰é¡¯ç¤ºä¸€å€‹å·¥å…·æç¤ºï¼ŒåŒ…å«**ç•¶å‰çš„å…·é«”æŒ‡æ¨™å€¼**å’Œè§¸ç™¼ç‹€æ…‹è®Šæ›´çš„ **SLO é–¾å€¼**ï¼ˆä¾‹å¦‚ï¼Œã€ŒéŒ¯èª¤ç‡: 2.1% (é–¾å€¼: >1%)ã€ï¼‰ã€‚
2.  **å¯æ“ä½œçš„ AI ç°¡å ±**ï¼šç°¡å ±ä¸­çš„å¯¦é«”ï¼ˆå¦‚ `Production Web Servers`, `web-prod-03`ï¼‰å¿…é ˆæ˜¯**å¯é»æ“Šçš„è¶…é€£çµ**ï¼Œç›´æ¥å°‡ SRE å°å‘å°æ‡‰çš„è³‡æºç¾¤çµ„å„€è¡¨æ¿æˆ–è³‡æºè©³æƒ…é é¢ï¼Œå¯¦ç¾å¾ã€Œé–±è®€ã€åˆ°ã€Œè¡Œå‹•ã€çš„è½‰åŒ–ã€‚
3.  **æ•´åˆå€¼ç­è³‡è¨Š (On-Call Integration)**ï¼šæˆ°æƒ…å®¤æœ€é‡è¦çš„è³‡è¨Šä¹‹ä¸€å°±æ˜¯ã€Œèª°èƒ½è§£æ±ºå•é¡Œã€ã€‚å„€è¡¨æ¿çš„é¡¯è‘—ä½ç½®ï¼ˆä¾‹å¦‚å³ä¸Šè§’ï¼‰æ‡‰æœ‰ä¸€å€‹**å€¼ç­è³‡è¨Šé¢æ¿**ï¼Œé¡¯ç¤ºé—œéµæ¥­å‹™æœå‹™çš„**ç•¶å‰ä¸»/å‚™å€¼ç­äººå“¡**æ˜¯èª°ï¼Œä¸¦æä¾›ä¸€éµè¯çµ¡ï¼ˆå¦‚é»æ“Šè·³è½‰åˆ° Slackï¼‰çš„åŠŸèƒ½ã€‚æ­¤è³‡è¨Šå¯é€é API å¾ Grafana OnCall æˆ– PagerDuty ç­‰å·¥å…·åŒæ­¥ã€‚
4.  **å³æ™‚æ€§æ˜¯é—œéµ**ï¼šé ‚éƒ¨çš„äº‹ä»¶è¨ˆæ•¸å™¨ç­‰é—œéµæŒ‡æ¨™ï¼Œå¿…é ˆé€é **WebSocket** å¯¦ç¾å³æ™‚æ›´æ–°ï¼Œç¢ºä¿æˆ°æƒ…å®¤çš„è³‡è¨Šæ²’æœ‰å»¶é²ã€‚

---

## 4.åˆ†æä¸­å¿ƒ

### å®¹é‡è¦åŠƒ [å®¹é‡è¦åŠƒ](images/50-é é¢-å®¹é‡è¦åŠƒ.png)

**åŠŸèƒ½æè¿°**ï¼š
- å®¹é‡è¦åŠƒåˆ†æå·¥å…·
- åˆ†æçµ±è¨ˆ KPIï¼šæ•¸æ“šé»ç¸½æ•¸ã€åˆ†æå ±å‘Šæ•¸ã€è™•ç†æ™‚é–“ã€æº–ç¢ºç‡
- åˆ†æé¡å‹å°èˆªï¼šå®¹é‡è¦åŠƒã€æ€§èƒ½æ´å¯Ÿã€ç•°å¸¸æª¢æ¸¬ã€æˆæœ¬åˆ†æã€MTTR åˆ†æã€SLA å ±å‘Š
- è³‡æºç¾¤çµ„å’Œæ•ˆèƒ½æŒ‡æ¨™é¸æ“‡å™¨
- ç›®å‰ä½¿ç”¨ç‡é¡¯ç¤ºï¼ˆ65.53%ï¼‰
- è¶¨å‹¢é æ¸¬åœ–è¡¨ï¼šæ­·å²æ•¸æ“šå’Œé æ¸¬è¶¨å‹¢ç·š
- å®¹é‡é è­¦ï¼šé è¨ˆé”åˆ° 80% è­¦æˆ’ç·šçš„æ™‚é–“
- åˆ†æå»ºè­°ï¼šå…·é«”çš„å®¹é‡è¦åŠƒå»ºè­°å’Œè‡ªå‹•åŒ–è…³æœ¬

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/analytics/capacity/overview` - å®¹é‡è¦åŠƒæ¦‚è¦½
- `GET /api/v1/analytics/capacity/predictions` - å®¹é‡é æ¸¬æ•¸æ“š
- `GET /api/v1/analytics/capacity/recommendations` - å®¹é‡å»ºè­°
- `POST /api/v1/analytics/capacity/analyze` - åŸ·è¡Œå®¹é‡åˆ†æ
- `GET /api/v1/analytics/capacity/trends` - å®¹é‡è¶¨å‹¢æ•¸æ“š

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å ´æ™¯è¦åŠƒ**ï¼šæ”¯æ´å¤šç¨®å¢é•·å ´æ™¯çš„å®¹é‡è¦åŠƒï¼ˆæ¨‚è§€ã€æ‚²è§€ã€ç¾å¯¦ï¼‰
2. **æˆæœ¬ä¼°ç®—**ï¼šæ•´åˆæˆæœ¬è¨ˆç®—ï¼Œé¡¯ç¤ºå®¹é‡æ“´å±•çš„é ç®—å½±éŸ¿
3. **è‡ªå‹•åŒ–å»ºè­°**ï¼šå°‡å»ºè­°ç›´æ¥è½‰æ›ç‚ºå¯åŸ·è¡Œçš„è‡ªå‹•åŒ–è…³æœ¬
4. **å”ä½œåŠŸèƒ½**ï¼šæ”¯æ´è¦åŠƒå ±å‘Šçš„åˆ†äº«å’Œåœ˜éšŠå”ä½œå¯©æŸ¥
5. **è­¦å ±æ•´åˆ**ï¼šè¨­å®šå®¹é‡é–¾å€¼è­¦å ±å’Œæå‰é€šçŸ¥æ©Ÿåˆ¶

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚å®¹é‡è¦åŠƒæ˜¯ SRE å¾è¢«å‹•æ•‘ç«è½‰å‘ä¸»å‹•é é˜²çš„é—œéµå·¥å…·ã€‚æ­¤è¨­è¨ˆåœ¨è¦–è¦ºåŒ–å’Œå»ºè­°æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œä½†è¦å°‡å…¶å¾ã€Œå ±å‘Šã€è½‰è®Šç‚ºä¸€å€‹å¯ä¿¡ã€å¯æ“ä½œçš„ã€Œæ±ºç­–æ”¯æ´ç³»çµ±ã€ï¼Œæˆ‘å€‘å¿…é ˆåœ¨å¾Œç«¯æ¶æ§‹ã€API è¨­è¨ˆå’Œå‰ç«¯äº’å‹•æ€§ä¸Šé€²è¡Œæ·±åº¦å¼·åŒ–ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è³‡æ–™æµç¨‹**ï¼š
1.  **è³‡æ–™ä¾†æºèˆ‡æ™‚åºè³‡æ–™åº«**ï¼š
    *   **è³‡æ–™ä¾†æº**ï¼šæ­¤åŠŸèƒ½çš„æ‰€æœ‰æ­·å²è³‡æ–™**å¿…é ˆ**ä¾†è‡ª `architecture.md` ä¸­å®šç¾©çš„ **VictoriaMetrics** æ™‚åºè³‡æ–™åº«ã€‚
    *   **æŸ¥è©¢èªè¨€**ï¼šå¾Œç«¯æ‡‰ä½¿ç”¨ MetricsQL é€²è¡Œé«˜æ•ˆçš„è³‡æ–™èšåˆæŸ¥è©¢ã€‚
2.  **éåŒæ­¥åˆ†ææœå‹™ (Async Analysis Service)**ï¼š
    *   å®¹é‡é æ¸¬æ˜¯ä¸€å€‹è¨ˆç®—å¯†é›†å‹ä»»å‹™ï¼Œ**åš´ç¦**åœ¨ API è«‹æ±‚ä¸­å³æ™‚è¨ˆç®—ã€‚
    *   æ‡‰å»ºç«‹ä¸€å€‹ç¨ç«‹çš„ Go **åˆ†ææœå‹™ (Analytics Service)**ã€‚æ­¤æœå‹™æ‡‰é€éèƒŒæ™¯æ’ç¨‹ä½œæ¥­ï¼ˆä¾‹å¦‚ï¼Œæ¯ 24 å°æ™‚ï¼‰ç‚ºæ‰€æœ‰é—œéµè³‡æºå’ŒæŒ‡æ¨™**é å…ˆè¨ˆç®—**æœªä¾† 90 å¤©çš„è¶¨å‹¢é æ¸¬ã€‚
    *   é æ¸¬çµæœï¼ˆåŒ…æ‹¬è¶¨å‹¢è³‡æ–™é»ã€é”åˆ°é–¾å€¼çš„é è¨ˆå¤©æ•¸ç­‰ï¼‰æ‡‰è¢«å„²å­˜åœ¨ **PostgreSQL** è³‡æ–™åº«çš„ `capacity_predictions` è¡¨ä¸­ï¼Œä¾› API å¿«é€ŸæŸ¥è©¢ã€‚
3.  **KPI æŒ‡æ¨™é è¨ˆç®—**ï¼šé ‚éƒ¨çš„ KPI æŒ‡æ¨™ï¼ˆæ•¸æ“šé»ç¸½æ•¸ã€æº–ç¢ºç‡ç­‰ï¼‰åŒæ¨£éœ€è¦ç”±èƒŒæ™¯ä½œæ¥­**é å…ˆè¨ˆç®—ä¸¦å¿«å–**åœ¨ Redis ä¸­ï¼Œä»¥ç¢ºä¿é é¢è¼‰å…¥é€Ÿåº¦ã€‚

**API è¨­è¨ˆ**ï¼š
*   `POST /api/v1/analytics/capacity/analyze`ï¼šæ­¤ API ä¸æ‡‰è§¸ç™¼å³æ™‚çš„ã€é˜»å¡å¼çš„åˆ†æã€‚å®ƒçš„è·è²¬æ˜¯**æäº¤ä¸€å€‹éåŒæ­¥çš„åˆ†æä»»å‹™**ã€‚å¾Œç«¯æ‡‰ç«‹å³å›å‚³ä¸€å€‹ `task_id`ï¼Œå‰ç«¯å¯ä½¿ç”¨æ­¤ ID è¼ªè©¢ä»»å‹™ç‹€æ…‹æˆ–é€é WebSocket æ¥æ”¶å®Œæˆé€šçŸ¥ã€‚
*   `GET /api/v1/analytics/capacity/trends?resource_group=...&metric=...`ï¼šæ­¤ API æ‡‰**ç›´æ¥æŸ¥è©¢** PostgreSQL ä¸­é å…ˆè¨ˆç®—å¥½çš„é æ¸¬çµæœï¼Œä»¥å¯¦ç¾å„€è¡¨æ¿çš„ç§’ç´šè¼‰å…¥ã€‚å…¶å›å‚³æ‡‰åŒ…å«æ­·å²è³‡æ–™å’Œé æ¸¬è³‡æ–™ã€‚
*   `GET /api/v1/analytics/capacity/recommendations?prediction_id=...`ï¼šåŸºæ–¼ä¸€å€‹å·²å®Œæˆçš„é æ¸¬ä»»å‹™ï¼Œç²å–çµæ§‹åŒ–çš„å»ºè­°ã€‚å›å‚³çš„ JSON æ‡‰åŒ…å«å»ºè­°æ–‡å­—å’Œå¯åŸ·è¡Œçš„ `script_id`ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **ä¿¡ä»»åº¦èˆ‡é€æ˜åº¦**ï¼š
    *   **é¡¯ç¤ºæ¨¡å‹èˆ‡ä¿¡è³´å€é–“**ï¼šåœ¨ã€Œè¶¨å‹¢é æ¸¬ã€åœ–è¡¨ä¸­ï¼Œé™¤äº†é æ¸¬ç·šï¼Œé‚„æ‡‰ç¹ªè£½å‡º**ä¿¡è³´å€é–“ (Confidence Interval)** çš„é™°å½±å€åŸŸã€‚ä¸¦åœ¨åœ–è¡¨ä¸‹æ–¹ç”¨å°å­—è¨»æ˜ä½¿ç”¨çš„é æ¸¬æ¨¡å‹ï¼ˆå¦‚ ARIMAï¼‰ï¼Œé€™èƒ½æ¥µå¤§æå‡ SRE å°é æ¸¬çµæœçš„ä¿¡ä»»åº¦ã€‚
    *   **è³‡æ–™é»å›æº¯**ï¼šåœ–è¡¨æ‡‰æ”¯æ´äº’å‹•ã€‚ä½¿ç”¨è€…é»æ“Šåœ–è¡¨ä¸Šçš„ä»»ä¸€æ­·å²è³‡æ–™é»æ™‚ï¼Œæ‡‰èƒ½çœ‹åˆ°è©²æ™‚é–“é»çš„åŸå§‹æŒ‡æ¨™å¿«ç…§æˆ–é—œè¯çš„é‡å¤§äº‹ä»¶ï¼Œå¹«åŠ©ç†è§£æ­·å²è¶¨å‹¢çš„æˆå› ã€‚
2.  **æƒ…å¢ƒåŒ–çš„è‡ªå‹•åŒ– (Contextual Automation)**ï¼š
    *   ã€Œå»ºè­°åŸ·è¡Œæ“´å®¹è…³æœ¬ã€æŒ‰éˆ•æ˜¯å€‹äº®é»ã€‚æ‡‰å°‡å…¶å¼·åŒ–ï¼šé»æ“Šå¾Œï¼Œä¸æ‡‰ç›´æ¥åŸ·è¡Œï¼Œè€Œæ˜¯å½ˆå‡ºä¸€å€‹**åƒæ•¸é å¡«çš„åŸ·è¡Œç¢ºèªè¦–çª—**ã€‚ä¾‹å¦‚ï¼Œè‹¥å»ºè­°æ˜¯ã€Œå¢åŠ  2 å€‹ Web Serverã€ï¼Œå‰‡å½ˆçª—ä¸­çš„è…³æœ¬åƒæ•¸ `instance_count` æ‡‰é è¨­å¡«å¯«ç‚º `2`ã€‚
    *   æ­¤è™•æ‡‰**æä¾›å¤šå€‹æ¨è–¦è…³æœ¬**ï¼Œè€Œä¸åªæ˜¯ä¸€å€‹ã€‚ä¾‹å¦‚ï¼Œé™¤äº†ã€Œæ“´å®¹ã€ï¼Œé‚„å¯èƒ½æœ‰é—œè¯çš„ã€Œæ•ˆèƒ½å„ªåŒ–ã€æˆ–ã€Œè³‡æ–™æ¸…ç†ã€è…³æœ¬å¯ä¾›é¸æ“‡ã€‚
3.  **What-If åˆ†ææ¨¡æ“¬**ï¼š
    *   æä¾›ä¸€å€‹ã€Œ**æ¨¡æ“¬äº‹ä»¶**ã€è¼¸å…¥åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨è€…å¯ä»¥è¼¸å…¥ã€Œé è¨ˆä¸‹æœˆæµé‡å¢é•· 50%ã€ï¼Œå¾Œç«¯åˆ†ææœå‹™æ¥æ”¶æ­¤åƒæ•¸å¾Œï¼Œé‡æ–°è¨ˆç®—ä¸¦åœ¨åœ–è¡¨ä¸Šç¹ªè£½ä¸€æ¢**æ–°çš„æ¨¡æ“¬é æ¸¬ç·š**ã€‚é€™å€‹ What-If åˆ†æèƒ½åŠ›ï¼Œèƒ½å°‡å·¥å…·å¾ã€Œå›é¡§ã€æå‡åˆ°çœŸæ­£çš„ã€Œè¦åŠƒã€å±¤æ¬¡ã€‚

---

## 5.è‡ªå‹•åŒ–ä¸­å¿ƒ

### è…³æœ¬åº« [è…³æœ¬åº«](images/51-é é¢-è…³æœ¬åº«.png)

**åŠŸèƒ½æè¿°**ï¼š
- è‡ªå‹•åŒ–è…³æœ¬é›†ä¸­ç®¡ç†å¹³å°
- è‡ªå‹•åŒ–çµ±è¨ˆ KPIï¼šè…³æœ¬ç¸½æ•¸ã€åŸ·è¡ŒæˆåŠŸç‡ã€24å°æ™‚åŸ·è¡Œæ¬¡æ•¸ã€æ’ç¨‹ä»»å‹™æ•¸
- æœ€è¿‘åŸ·è¡Œæ—¥èªŒç›£æ§é¢æ¿
- ç†±é–€è…³æœ¬æ’è¡Œæ¦œï¼ˆæŒ‰åŸ·è¡Œæ¬¡æ•¸ï¼‰
- è…³æœ¬åˆ†é¡å°èˆªï¼šè…³æœ¬åº«ã€å››æ¸¸ç¨‹ç®¡ç†ã€åŸ·è¡Œæ—¥èªŒ
- è…³æœ¬è¡¨æ ¼ï¼šåç¨±ã€é¡å‹ã€å‰µå»ºè€…ã€æ’ç¨‹å¼•ç”¨ã€æè¿°

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/scripts` - ç²å–è…³æœ¬åˆ—è¡¨
- `POST /api/v1/scripts` - å‰µå»ºæ–°è…³æœ¬
- `PUT /api/v1/scripts/{id}` - æ›´æ–°è…³æœ¬
- `DELETE /api/v1/scripts/{id}` - åˆªé™¤è…³æœ¬
- `POST /api/v1/scripts/{id}/execute` - åŸ·è¡Œè…³æœ¬
- `GET /api/v1/scripts/statistics` - è…³æœ¬çµ±è¨ˆæ•¸æ“š

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è…³æœ¬ç·¨è¼¯å™¨**ï¼šå…§å»ºä»£ç¢¼ç·¨è¼¯å™¨ï¼Œæ”¯æ´èªæ³•é«˜äº®å’Œè‡ªå‹•è£œå…¨
2. **ç‰ˆæœ¬æ§åˆ¶**ï¼šè…³æœ¬ç‰ˆæœ¬ç®¡ç†å’Œå›æ»¾åŠŸèƒ½
3. **æ¸¬è©¦ç’°å¢ƒ**ï¼šæä¾›è…³æœ¬æ¸¬è©¦å’Œèª¿è©¦ç’°å¢ƒ
4. **ä¾è³´ç®¡ç†**ï¼šé¡¯ç¤ºè…³æœ¬é–“çš„ä¾è³´é—œä¿‚
5. **å”ä½œåŠŸèƒ½**ï¼šæ”¯æ´è…³æœ¬åˆ†äº«å’Œåœ˜éšŠå”ä½œé–‹ç™¼

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚è…³æœ¬åº«æ˜¯ SRE å¹³å°å¯¦ç¾ã€Œè‡ªå‹•åŒ–ã€åƒ¹å€¼çš„æ ¸å¿ƒï¼Œæ˜¯å°‡äººé¡çŸ¥è­˜è½‰åŒ–ç‚ºå¯é‡è¤‡åŸ·è¡Œè³‡ç”¢çš„é—œéµå ´æ‰€ã€‚æ­¤é é¢ä½ˆå±€æ¸…æ™°ï¼Œä½†è¦ä½¿å…¶æˆç‚ºä¸€å€‹å®‰å…¨ã€å¯é ã€å¯æ²»ç†çš„ä¼æ¥­ç´šåŠŸèƒ½ï¼Œæˆ‘å€‘å¿…é ˆåœ¨å¾Œç«¯æ¶æ§‹ã€API è¨­è¨ˆå’Œ UX ä¸Šé€²è¡Œæ·±åº¦å¼·åŒ–ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **è…³æœ¬å„²å­˜ç­–ç•¥ï¼šGit-as-a-Database**
    *   **åš´ç¦**å°‡è…³æœ¬å…§å®¹ç›´æ¥å„²å­˜åœ¨ PostgreSQL ä¸­ã€‚é€™æœƒå°è‡´ç‰ˆæœ¬æ§åˆ¶æ··äº‚ã€ç¼ºä¹å¯©è¨ˆè¿½è¹¤ï¼Œä¸”é›£ä»¥é€²è¡Œç¨‹å¼ç¢¼å¯©æŸ¥ (Code Review)ã€‚
    *   **æ­£ç¢ºåšæ³•**ï¼šå¾Œç«¯æ‡‰æ•´åˆä¸€å€‹ç§æœ‰çš„ **Git å€‰åº«** (å¦‚ Gitea æˆ– GitLab) ä½œç‚ºè…³æœ¬çš„ã€Œå–®ä¸€äº‹å¯¦ä¾†æº (SSOT)ã€ã€‚
    *   `scripts` è³‡æ–™è¡¨åœ¨ PostgreSQL ä¸­åƒ…å„²å­˜**å…ƒæ•¸æ“š** (metadata)ï¼Œå¦‚ `script_name`, `description`, `creator_id`ï¼Œä»¥åŠæœ€é‡è¦çš„ `git_repo_url` å’Œ `commit_hash`ã€‚
2.  **éåŒæ­¥åŸ·è¡Œå¼•æ“**ï¼š
    *   è…³æœ¬åŸ·è¡Œ**å¿…é ˆ**æ˜¯**éåŒæ­¥**çš„ã€‚å¾Œç«¯æ‡‰ç¶­è­·ä¸€å€‹åŸºæ–¼è¨Šæ¯ä½‡åˆ— (e.g., Redis Streams) çš„**ä»»å‹™åŸ·è¡Œå™¨æ±  (Worker Pool)**ã€‚
    *   ç•¶ä½¿ç”¨è€…é»æ“Šã€ŒåŸ·è¡Œã€æ™‚ï¼ŒAPI åƒ…æ˜¯å°‡ä¸€å€‹ã€ŒåŸ·è¡Œä»»å‹™ã€æ¨é€åˆ°ä½‡åˆ—ä¸­ã€‚Worker å¾ä½‡åˆ—ä¸­ç²å–ä»»å‹™ï¼Œå¾ Git å€‰åº«æ‹‰å–å°æ‡‰ `commit_hash` çš„è…³æœ¬å…§å®¹ï¼Œåœ¨ä¸€å€‹**éš”é›¢çš„åŸ·è¡Œç’°å¢ƒ** (å¦‚ Docker å®¹å™¨æˆ– k8s Job) ä¸­åŸ·è¡Œï¼Œä¸¦å°‡åŸ·è¡Œæ—¥èªŒä¸²æµå¼åœ°å¯«å…¥ Elasticsearchã€‚
3.  **KPI æŒ‡æ¨™é è¨ˆç®—**ï¼šé ‚éƒ¨çš„ KPI æŒ‡æ¨™ï¼ˆæˆåŠŸç‡ã€åŸ·è¡Œæ¬¡æ•¸ç­‰ï¼‰å¿…é ˆç”±ä¸€å€‹èƒŒæ™¯æ’ç¨‹ä½œæ¥­**é å…ˆè¨ˆç®—ä¸¦å¿«å–**åœ¨ Redis ä¸­ï¼Œçµ•ä¸èƒ½åœ¨é é¢è¼‰å…¥æ™‚å°æ—¥èªŒé€²è¡Œå³æ™‚èšåˆæŸ¥è©¢ã€‚

**API è¨­è¨ˆ**ï¼š
*   `POST /api/v1/scripts`ï¼šå»ºç«‹ä¸€å€‹æ–°è…³æœ¬ã€‚å¾Œç«¯æ¥æ”¶åˆ°è…³æœ¬å…§å®¹å¾Œï¼Œæ‡‰åŸ·è¡Œ `git commit` å’Œ `git push` åˆ°å…§éƒ¨å€‰åº«ï¼Œç„¶å¾Œå°‡å…ƒæ•¸æ“šå¯«å…¥è³‡æ–™åº«ã€‚
*   `POST /api/v1/scripts/{id}/execute`ï¼šæäº¤ä¸€å€‹**éåŒæ­¥åŸ·è¡Œä»»å‹™**ã€‚è«‹æ±‚é«”æ‡‰åŒ…å«åŸ·è¡Œåƒæ•¸ã€‚API æ‡‰ç«‹å³å›å‚³ä¸€å€‹ `execution_id`ï¼Œå‰ç«¯å¯ä½¿ç”¨æ­¤ ID è·³è½‰åˆ°è©²æ¬¡åŸ·è¡Œçš„å³æ™‚æ—¥èªŒé é¢ã€‚
*   `GET /api/v1/scripts/{id}/history`ï¼š(æ–°å»ºè­°) ç²å–ä¸€å€‹è…³æœ¬çš„ **Git æäº¤æ­·å²**ï¼Œç”¨æ–¼åœ¨ UI ä¸Šå±•ç¾ç‰ˆæœ¬æ¼”é€²ã€‚
*   `GET /api/v1/scripts/statistics`ï¼šå¾ Redis å¿«å–ä¸­ç›´æ¥è®€å–é å…ˆè¨ˆç®—å¥½çš„ KPI çµ±è¨ˆè³‡æ–™ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å…§å»ºç¨‹å¼ç¢¼ç·¨è¼¯å™¨èˆ‡ç‰ˆæœ¬æ§åˆ¶**ï¼š
    *   ã€Œç·¨è¼¯è…³æœ¬ã€å½ˆçª—æ‡‰å…§åµŒä¸€å€‹åŠŸèƒ½å¼·å¤§çš„**ç¶²é ç‰ˆ IDE** (å¦‚ Monaco Editorï¼ŒVS Code çš„æ ¸å¿ƒ)ï¼Œæä¾›èªæ³•é«˜äº®ã€è‡ªå‹•è£œå…¨å’Œéœæ…‹æª¢æŸ¥åŠŸèƒ½ã€‚
    *   ç·¨è¼¯å™¨æ—æ‡‰æœ‰ä¸€å€‹**ç‰ˆæœ¬æ­·å²**åˆ†é ï¼Œæ¸…æ™°åœ°å±•ç¤ºæ¯ä¸€æ¬¡çš„ `git commit` ç´€éŒ„ï¼ˆåŒ…å«æäº¤è€…ã€æ™‚é–“å’Œè¨Šæ¯ï¼‰ã€‚ä½¿ç”¨è€…æ‡‰èƒ½**æ¯”è¼ƒä»»æ„å…©å€‹ç‰ˆæœ¬ä¹‹é–“çš„å·®ç•° (diff)**ï¼Œä¸¦èƒ½**ä¸€éµé‚„åŸ**åˆ°ä»»ä¸€æ­·å²ç‰ˆæœ¬ã€‚
2.  **å®‰å…¨èˆ‡æ²»ç†**ï¼š
    *   **åƒæ•¸åŒ–èˆ‡ç¥•å¯†ç®¡ç†**ï¼šè…³æœ¬å…§å®¹**åš´ç¦**ç¡¬ç·¨ç¢¼ä»»ä½•å¯†ç¢¼ã€API é‡‘é‘°æˆ– Tokenã€‚å¹³å°æ‡‰èˆ‡ **HashiCorp Vault** æˆ–é¡ä¼¼çš„ç¥•å¯†ç®¡ç†å·¥å…·æ•´åˆã€‚åœ¨è…³æœ¬åŸ·è¡Œæ™‚ï¼ŒåŸ·è¡Œå™¨è² è²¬å¾ Vault ä¸­å®‰å…¨åœ°æ³¨å…¥æ‰€éœ€çš„ç¥•å¯†ã€‚
    *   **åŸ·è¡Œæ¬Šé™ (Execution Permissions)**ï¼šæ‡‰å¼•å…¥åŸºæ–¼è§’è‰²çš„è…³æœ¬**åŸ·è¡Œæ¬Šé™**ã€‚ä¾‹å¦‚ï¼Œåªæœ‰ã€Œè³‡æ–™åº«ç®¡ç†å“¡ã€è§’è‰²çš„æˆå“¡æ‰èƒ½åŸ·è¡Œæ¨™è¨˜ç‚º `db-sensitive` çš„è…³æœ¬ã€‚
3.  **æå‡æ˜“ç”¨æ€§èˆ‡å”ä½œ**ï¼š
    *   **æ¸¬è©¦èˆ‡ã€Œè©¦é‹è¡Œ (Dry Run)ã€**ï¼šç‚ºæ¯å€‹è…³æœ¬æä¾›ä¸€å€‹ã€Œæ¸¬è©¦ã€æŒ‰éˆ•ã€‚åŒæ™‚ï¼Œè…³æœ¬æ‡‰æ”¯æ´ã€Œè©¦é‹è¡Œæ¨¡å¼ã€ï¼Œåœ¨è©²æ¨¡å¼ä¸‹ï¼Œè…³æœ¬åªæ‰“å°å°‡è¦åŸ·è¡Œçš„å‘½ä»¤ï¼Œè€Œä¸å¯¦éš›åŸ·è¡Œï¼Œä»¥ä¾›ä½¿ç”¨è€…é©—è­‰å…¶è¡Œç‚ºã€‚
    *   **å…±äº«èˆ‡å¯©æŸ¥**ï¼šæä¾›å°‡è…³æœ¬åˆ†äº«çµ¦å…¶ä»–åœ˜éšŠæˆå“¡é€²è¡Œå¯©æŸ¥çš„åŠŸèƒ½ï¼Œæ•´åˆä¸€å€‹ç°¡æ˜“çš„ç¨‹å¼ç¢¼å¯©æŸ¥æµç¨‹ã€‚

#### ç·¨è¼¯è…³æœ¬ [ç·¨è¼¯è…³æœ¬](images/54-å½ˆçª—-è…³æœ¬åº«-ç·¨è¼¯è…³æœ¬.png)

**åŠŸèƒ½æè¿°**ï¼š
- è…³æœ¬ç·¨è¼¯å½ˆçª—
- æ”¯æ´å¤šæ¨™ç±¤é ç·¨è¼¯ï¼ˆåŸºæœ¬ä¿¡æ¯ã€è…³æœ¬å…§å®¹ã€åƒæ•¸è¨­å®šï¼‰
- æä¾›ä»£ç¢¼èªæ³•é«˜äº®å’Œè‡ªå‹•è£œå…¨

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/scripts/{id}` - æ›´æ–°è…³æœ¬

**UX æ”¹å–„å»ºè­°**ï¼š
1. **åŠŸèƒ½å®Œå–„**ï¼šæ ¹æ“šå…·é«”åŠŸèƒ½éœ€æ±‚æä¾›ç›¸æ‡‰çš„UXæ”¹å–„å»ºè­°
2. **ä½¿ç”¨è€…é«”é©—å„ªåŒ–**ï¼šæ”¹å–„ç•Œé¢äº¤äº’å’Œæ“ä½œæµç¨‹
3. **å¯åŠæ€§æ”¹å–„**ï¼šæå‡ç•Œé¢çš„å¯åŠæ€§å’Œæ˜“ç”¨æ€§
4. **æ€§èƒ½å„ªåŒ–**ï¼šå„ªåŒ–è¼‰å…¥é€Ÿåº¦å’ŒéŸ¿æ‡‰æ™‚é–“
5. **éŒ¯èª¤è™•ç†**ï¼šå®Œå–„éŒ¯èª¤æç¤ºå’Œç•°å¸¸æƒ…æ³è™•ç†

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤æŠ½å±œè¨­è¨ˆã€‚æ—¥èªŒè©³æƒ…æ˜¯ SRE å·¥ç¨‹å¸«æ’æŸ¥è‡ªå‹•åŒ–å•é¡Œæ™‚èŠ±è²»æ™‚é–“æœ€å¤šçš„åœ°æ–¹ï¼Œå…¶è¨­è¨ˆçš„å„ªåŠ£ç›´æ¥æ±ºå®šäº†å¹³å°çš„æ˜“ç”¨æ€§å’Œæ’éŒ¯æ•ˆç‡ã€‚æ­¤è¨­è¨ˆå·²ç¶“åŒ…å«äº†æ—¥èªŒç­‰ç´šç¯©é¸ã€æœå°‹ç­‰é«˜ç´šåŠŸèƒ½ï¼Œéå¸¸å‡ºè‰²ã€‚æˆ‘çš„å»ºè­°å°‡èšç„¦æ–¼å¦‚ä½•å¾æ¶æ§‹å’Œ UX ç´°ç¯€ä¸Šï¼Œå°‡å…¶æ‰“ç£¨å¾—ç›¡å–„ç›¡ç¾ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **è³‡æ–™ä¾†æºï¼šElasticsearch**
    *   å¾Œç«¯**å¿…é ˆ**å¾ **Elasticsearch** ä¸­ç²å–æŒ‡å®š `execution_id` çš„æ—¥èªŒæ–‡ä»¶ (Document)ã€‚æ­¤æ–‡ä»¶æ‡‰åŒ…å«æ‰€æœ‰å…ƒæ•¸æ“šä»¥åŠå®Œæ•´çš„ `output` æ¬„ä½ã€‚
2.  **æ—¥èªŒç­‰ç´šç¯©é¸çš„å¯¦ç¾**ï¼š
    *   UI ä¸Šçš„ã€Œæ—¥èªŒç­‰ç´šã€ç¯©é¸**ä¸æ‡‰**åœ¨å‰ç«¯å®Œæˆã€‚å‰ç«¯ç¯©é¸å°æ–¼è¶…å¤§æ—¥èªŒæœƒå°è‡´ç€è¦½å™¨å¡é “ã€‚
    *   æ­£ç¢ºåšæ³•æ˜¯ï¼šç•¶ä½¿ç”¨è€…é¸æ“‡ä¸€å€‹æ—¥èªŒç­‰ç´šï¼ˆå¦‚ `ERROR`ï¼‰æ™‚ï¼Œå‰ç«¯æ‡‰é‡æ–°å‘¼å« APIï¼Œä¸¦é™„ä¸Šç¯©é¸åƒæ•¸ã€‚å¾Œç«¯å°‡æ­¤æ¢ä»¶è½‰æ›ç‚º Elasticsearch çš„æŸ¥è©¢ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ `match` æŸ¥è©¢ä¾†éæ¿¾ `output` æ¬„ä½ä¸­åŒ…å« `ERROR` å­—ä¸²çš„è¡Œï¼‰ï¼Œåªå›å‚³ç¬¦åˆæ¢ä»¶çš„æ—¥èªŒå…§å®¹ã€‚

**API è¨­è¨ˆ**ï¼š
*   `GET /api/v1/execution-logs/{id}`ï¼šæ­¤ API æ‡‰ä½œç‚ºæ­¤æŠ½å±œçš„ä¸»è¦è³‡æ–™ä¾†æºã€‚
    *   å®ƒæ‡‰å›å‚³ä¸€å€‹åŒ…å«æ‰€æœ‰å…ƒæ•¸æ“šï¼ˆ`script_name`, `status`, `duration_ms` ç­‰ï¼‰å’Œæ—¥èªŒè¼¸å‡º (`output`) çš„ JSON ç‰©ä»¶ã€‚
    *   å¯é¸åœ°ï¼Œå®ƒå¯ä»¥æ¥å—æŸ¥è©¢åƒæ•¸ `?log_level=ERROR` æˆ– `?q=keyword`ï¼Œè®“å¾Œç«¯ç›´æ¥åœ¨ Elasticsearch ä¸­å®Œæˆç¯©é¸å’Œæœå°‹ï¼Œåªå›å‚³è™•ç†éçš„ `output`ã€‚
*   `GET /api/v1/execution-logs/{id}/raw`ï¼š(æ–°å»ºè­°) æä¾›ä¸€å€‹å°ˆé–€çš„ç«¯é»ï¼Œç”¨æ–¼ä»¥ `text/plain` æ ¼å¼ä¸‹è¼‰å®Œæ•´çš„ã€æœªç¶“è™•ç†çš„åŸå§‹æ—¥èªŒæª”æ¡ˆï¼Œæ–¹ä¾¿ä½¿ç”¨è€…åœ¨æœ¬åœ°ä½¿ç”¨ `grep` ç­‰å·¥å…·é€²è¡Œåˆ†æã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å‡ç´šç‚ºçœŸå¯¦çš„æ—¥èªŒæª¢è¦–å™¨ (Log Viewer)**ï¼š
    *   ç›®å‰çš„ç´”æ–‡å­—å±•ç¤ºå€æ‡‰å‡ç´šç‚ºä¸€å€‹**è™›æ“¬åŒ– (Virtualized)** çš„æ—¥èªŒæª¢è¦–å™¨å…ƒä»¶ã€‚è™›æ“¬åŒ–æ˜¯è™•ç†å¤§é‡æ—¥èªŒï¼ˆæ•¸åƒè‡³æ•¸è¬è¡Œï¼‰è€Œä¸æœƒé€ æˆç€è¦½å™¨å¡é “çš„**å”¯ä¸€**å¯è¡Œæ–¹æ¡ˆã€‚
    *   æª¢è¦–å™¨æ‡‰å°æ—¥èªŒè¡Œä¸­çš„é—œéµå­—ï¼ˆå¦‚ `ERROR`, `WARN`, `SUCCESS`, `panic`ï¼‰å’Œå¸¸è¦‹æ ¼å¼ï¼ˆå¦‚ JSONï¼‰é€²è¡Œ**èªæ³•é«˜äº®**ï¼Œæ¥µå¤§æå‡å¯è®€æ€§ã€‚
2.  **ä¸Šä¸‹æ–‡çš„æ·±åº¦é€£çµ**ï¼š
    *   æŠ½å±œé ‚éƒ¨çš„æ‰€æœ‰å…ƒæ•¸æ“šéƒ½æ‡‰æ˜¯å¯äº’å‹•çš„ï¼š
        *   é»æ“Šã€Œè…³æœ¬åç¨±ã€ï¼Œæ‡‰åœ¨æ–°åˆ†é ä¸­æ‰“é–‹è©²è…³æœ¬çš„ç·¨è¼¯å™¨ï¼Œä¸¦å®šä½åˆ°åŸ·è¡Œçš„å…·é«” `commit_hash` ç‰ˆæœ¬ã€‚
        *   é»æ“Šã€Œè§¸ç™¼æ–¹å¼ã€ä¸­çš„ã€Œ`æ‰‹å‹• (admin)`ã€ï¼Œæ‡‰èƒ½çœ‹åˆ°è©²ä½¿ç”¨è€…çš„ç°¡è¦è³‡è¨Šã€‚å¦‚æœè§¸ç™¼æ–¹å¼æ˜¯ã€Œäº‹ä»¶ã€æˆ–ã€Œæ’ç¨‹ã€ï¼Œå‰‡æ‡‰é€£çµåˆ°å°æ‡‰çš„äº‹ä»¶è©³æƒ…æˆ–æ’ç¨‹è¨­å®šã€‚
3.  **å¢å¼·çš„æœå°‹èˆ‡ç¯©é¸**ï¼š
    *   æœå°‹æ¡†æ‡‰æ”¯æ´**æ­£å‰‡è¡¨é”å¼**å’Œ**å¤§å°å¯«åˆ‡æ›**é¸é …ã€‚
    *   ç•¶åŸ·è¡Œæœå°‹å¾Œï¼Œé™¤äº†é«˜äº®åŒ¹é…è¡Œï¼Œé‚„æ‡‰åœ¨æª¢è¦–å™¨çš„æ²å‹•æ¢ä¸Šæ¨™ç¤ºå‡ºæ‰€æœ‰åŒ¹é…é …çš„ä½ç½®ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€Ÿå®šä½ã€‚
4.  **é¡¯ç¤ºåŸ·è¡Œåƒæ•¸**ï¼š
    *   åœ¨å…ƒæ•¸æ“šå€åŸŸï¼Œå¿…é ˆå¢åŠ ä¸€å¡Šå€åŸŸï¼Œæ¸…æ™°åœ°å±•ç¤º**æœ¬æ¬¡åŸ·è¡Œæ‰€ä½¿ç”¨çš„å®Œæ•´åƒæ•¸**ã€‚é€™å°æ–¼ç†è§£è…³æœ¬è¡Œç‚ºå’Œå¾©ç¾å•é¡Œè‡³é—œé‡è¦ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤æŠ½å±œè¨­è¨ˆã€‚æ—¥èªŒè©³æƒ…æ˜¯ SRE å·¥ç¨‹å¸«æ’æŸ¥è‡ªå‹•åŒ–å•é¡Œæ™‚èŠ±è²»æ™‚é–“æœ€å¤šçš„åœ°æ–¹ï¼Œå…¶è¨­è¨ˆçš„å„ªåŠ£ç›´æ¥æ±ºå®šäº†å¹³å°çš„æ˜“ç”¨æ€§å’Œæ’éŒ¯æ•ˆç‡ã€‚æ­¤è¨­è¨ˆå·²ç¶“åŒ…å«äº†æ—¥èªŒç­‰ç´šç¯©é¸ã€æœå°‹ç­‰é«˜ç´šåŠŸèƒ½ï¼Œéå¸¸å‡ºè‰²ã€‚æˆ‘çš„å»ºè­°å°‡èšç„¦æ–¼å¦‚ä½•å¾æ¶æ§‹å’Œ UX ç´°ç¯€ä¸Šï¼Œå°‡å…¶æ‰“ç£¨å¾—ç›¡å–„ç›¡ç¾ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **è³‡æ–™ä¾†æºï¼šElasticsearch**
    *   å¾Œç«¯**å¿…é ˆ**å¾ **Elasticsearch** ä¸­ç²å–æŒ‡å®š `execution_id` çš„æ—¥èªŒæ–‡ä»¶ (Document)ã€‚æ­¤æ–‡ä»¶æ‡‰åŒ…å«æ‰€æœ‰å…ƒæ•¸æ“šä»¥åŠå®Œæ•´çš„ `output` æ¬„ä½ã€‚
2.  **æ—¥èªŒç­‰ç´šç¯©é¸çš„å¯¦ç¾**ï¼š
    *   UI ä¸Šçš„ã€Œæ—¥èªŒç­‰ç´šã€ç¯©é¸**ä¸æ‡‰**åœ¨å‰ç«¯å®Œæˆã€‚å‰ç«¯ç¯©é¸å°æ–¼è¶…å¤§æ—¥èªŒæœƒå°è‡´ç€è¦½å™¨å¡é “ã€‚
    *   æ­£ç¢ºåšæ³•æ˜¯ï¼šç•¶ä½¿ç”¨è€…é¸æ“‡ä¸€å€‹æ—¥èªŒç­‰ç´šï¼ˆå¦‚ `ERROR`ï¼‰æ™‚ï¼Œå‰ç«¯æ‡‰é‡æ–°å‘¼å« APIï¼Œä¸¦é™„ä¸Šç¯©é¸åƒæ•¸ã€‚å¾Œç«¯å°‡æ­¤æ¢ä»¶è½‰æ›ç‚º Elasticsearch çš„æŸ¥è©¢ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ `match` æŸ¥è©¢ä¾†éæ¿¾ `output` æ¬„ä½ä¸­åŒ…å« `ERROR` å­—ä¸²çš„è¡Œï¼‰ï¼Œåªå›å‚³ç¬¦åˆæ¢ä»¶çš„æ—¥èªŒå…§å®¹ã€‚

**API è¨­è¨ˆ**ï¼š
*   `GET /api/v1/execution-logs/{id}`ï¼šæ­¤ API æ‡‰ä½œç‚ºæ­¤æŠ½å±œçš„ä¸»è¦è³‡æ–™ä¾†æºã€‚
    *   å®ƒæ‡‰å›å‚³ä¸€å€‹åŒ…å«æ‰€æœ‰å…ƒæ•¸æ“šï¼ˆ`script_name`, `status`, `duration_ms` ç­‰ï¼‰å’Œæ—¥èªŒè¼¸å‡º (`output`) çš„ JSON ç‰©ä»¶ã€‚
    *   å¯é¸åœ°ï¼Œå®ƒå¯ä»¥æ¥å—æŸ¥è©¢åƒæ•¸ `?log_level=ERROR` æˆ– `?q=keyword`ï¼Œè®“å¾Œç«¯ç›´æ¥åœ¨ Elasticsearch ä¸­å®Œæˆç¯©é¸å’Œæœå°‹ï¼Œåªå›å‚³è™•ç†éçš„ `output`ã€‚
*   `GET /api/v1/execution-logs/{id}/raw`ï¼š(æ–°å»ºè­°) æä¾›ä¸€å€‹å°ˆé–€çš„ç«¯é»ï¼Œç”¨æ–¼ä»¥ `text/plain` æ ¼å¼ä¸‹è¼‰å®Œæ•´çš„ã€æœªç¶“è™•ç†çš„åŸå§‹æ—¥èªŒæª”æ¡ˆï¼Œæ–¹ä¾¿ä½¿ç”¨è€…åœ¨æœ¬åœ°ä½¿ç”¨ `grep` ç­‰å·¥å…·é€²è¡Œåˆ†æã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å‡ç´šç‚ºçœŸå¯¦çš„æ—¥èªŒæª¢è¦–å™¨ (Log Viewer)**ï¼š
    *   ç›®å‰çš„ç´”æ–‡å­—å±•ç¤ºå€æ‡‰å‡ç´šç‚ºä¸€å€‹**è™›æ“¬åŒ– (Virtualized)** çš„æ—¥èªŒæª¢è¦–å™¨å…ƒä»¶ã€‚è™›æ“¬åŒ–æ˜¯è™•ç†å¤§é‡æ—¥èªŒï¼ˆæ•¸åƒè‡³æ•¸è¬è¡Œï¼‰è€Œä¸æœƒé€ æˆç€è¦½å™¨å¡é “çš„**å”¯ä¸€**å¯è¡Œæ–¹æ¡ˆã€‚
    *   æª¢è¦–å™¨æ‡‰å°æ—¥èªŒè¡Œä¸­çš„é—œéµå­—ï¼ˆå¦‚ `ERROR`, `WARN`, `SUCCESS`, `panic`ï¼‰å’Œå¸¸è¦‹æ ¼å¼ï¼ˆå¦‚ JSONï¼‰é€²è¡Œ**èªæ³•é«˜äº®**ï¼Œæ¥µå¤§æå‡å¯è®€æ€§ã€‚
2.  **ä¸Šä¸‹æ–‡çš„æ·±åº¦é€£çµ**ï¼š
    *   æŠ½å±œé ‚éƒ¨çš„æ‰€æœ‰å…ƒæ•¸æ“šéƒ½æ‡‰æ˜¯å¯äº’å‹•çš„ï¼š
        *   é»æ“Šã€Œè…³æœ¬åç¨±ã€ï¼Œæ‡‰åœ¨æ–°åˆ†é ä¸­æ‰“é–‹è©²è…³æœ¬çš„ç·¨è¼¯å™¨ï¼Œä¸¦å®šä½åˆ°åŸ·è¡Œçš„å…·é«” `commit_hash` ç‰ˆæœ¬ã€‚
        *   é»æ“Šã€Œè§¸ç™¼æ–¹å¼ã€ä¸­çš„ã€Œ`æ‰‹å‹• (admin)`ã€ï¼Œæ‡‰èƒ½çœ‹åˆ°è©²ä½¿ç”¨è€…çš„ç°¡è¦è³‡è¨Šã€‚å¦‚æœè§¸ç™¼æ–¹å¼æ˜¯ã€Œäº‹ä»¶ã€æˆ–ã€Œæ’ç¨‹ã€ï¼Œå‰‡æ‡‰é€£çµåˆ°å°æ‡‰çš„äº‹ä»¶è©³æƒ…æˆ–æ’ç¨‹è¨­å®šã€‚
3.  **å¢å¼·çš„æœå°‹èˆ‡ç¯©é¸**ï¼š
    *   æœå°‹æ¡†æ‡‰æ”¯æ´**æ­£å‰‡è¡¨é”å¼**å’Œ**å¤§å°å¯«åˆ‡æ›**é¸é …ã€‚
    *   ç•¶åŸ·è¡Œæœå°‹å¾Œï¼Œé™¤äº†é«˜äº®åŒ¹é…è¡Œï¼Œé‚„æ‡‰åœ¨æª¢è¦–å™¨çš„æ²å‹•æ¢ä¸Šæ¨™ç¤ºå‡ºæ‰€æœ‰åŒ¹é…é …çš„ä½ç½®ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€Ÿå®šä½ã€‚
4.  **é¡¯ç¤ºåŸ·è¡Œåƒæ•¸**ï¼š
    *   åœ¨å…ƒæ•¸æ“šå€åŸŸï¼Œå¿…é ˆå¢åŠ ä¸€å¡Šå€åŸŸï¼Œæ¸…æ™°åœ°å±•ç¤º**æœ¬æ¬¡åŸ·è¡Œæ‰€ä½¿ç”¨çš„å®Œæ•´åƒæ•¸**ã€‚é€™å°æ–¼ç†è§£è…³æœ¬è¡Œç‚ºå’Œå¾©ç¾å•é¡Œè‡³é—œé‡è¦ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤å½ˆçª—è¨­è¨ˆã€‚é€™æ˜¯è‡ªå‹•åŒ–ä¸­å¿ƒçš„æ ¸å¿ƒäº’å‹•ä»‹é¢ä¹‹ä¸€ï¼Œæ˜¯ SRE å°ˆå®¶çŸ¥è­˜çš„ã€Œå¯«å…¥é»ã€ã€‚ç›®å‰çš„è¡¨å–®ä½ˆå±€å¾ˆæ¸…æ™°ï¼Œä½†æˆ‘å€‘å¯ä»¥é€éå¼•å…¥å°ˆæ¥­é–‹ç™¼å·¥å…·çš„å¯¦è¸ï¼Œå°‡å…¶å¾ä¸€å€‹ç°¡å–®çš„ã€Œæ–‡å­—ç·¨è¼¯å™¨ã€å‡ç´šç‚ºä¸€å€‹å¯é ã€å¯è¿½æº¯çš„ã€Œç¨‹å¼ç¢¼ç·¨è¼¯å™¨ã€ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ Git æ•´åˆ**ï¼š
1.  **å„²å­˜å³æäº¤ (Save is Commit)**ï¼š
    *   ç•¶ä½¿ç”¨è€…é»æ“Šã€Œå„²å­˜ã€æ™‚ï¼Œå¾Œç«¯**å¿…é ˆ**å°‡æ­¤æ“ä½œç¿»è­¯ç‚ºä¸€å€‹ **Git Commit**ã€‚
    *   å¾Œç«¯æœå‹™æ‡‰åŸ·è¡Œä»¥ä¸‹åŸå­æ“ä½œï¼š
        1.  å¾å…§éƒ¨ Git å€‰åº« `clone` æˆ– `pull` æœ€æ–°çš„è…³æœ¬ã€‚
        2.  ç”¨æ–°çš„ã€Œè…³æœ¬å…§å®¹ã€è¦†å¯«æª”æ¡ˆã€‚
        3.  åŸ·è¡Œ `git add` å’Œ `git commit`ã€‚**Commit Message å¿…é ˆæ˜¯çµæ§‹åŒ–çš„**ï¼Œä¾‹å¦‚ `Update script 'Auto-scaling for Web Servers' by user 'admin' via SRE Platform`ã€‚
        4.  åŸ·è¡Œ `git push` å°‡è®Šæ›´æ¨å›é ç«¯å€‰åº«ã€‚
        5.  æ›´æ–° PostgreSQL ä¸­ `scripts` è¡¨çš„ `commit_hash` æ¬„ä½ï¼Œä½¿å…¶æŒ‡å‘é€™å€‹æ–°çš„ Commitã€‚
2.  **åƒæ•¸å®šç¾©çš„å„²å­˜**ï¼š
    *   è…³æœ¬çš„åƒæ•¸å®šç¾©ï¼ˆåç¨±ã€é¡å‹ã€é è¨­å€¼ã€æ˜¯å¦å¿…éœ€ï¼‰ä¸æ‡‰å„²å­˜åœ¨è…³æœ¬æª”æ¡ˆå…§ï¼Œè€Œæ‡‰ä½œç‚º**å…ƒæ•¸æ“š**ï¼Œä»¥ JSONB æ ¼å¼å„²å­˜åœ¨ PostgreSQL çš„ `scripts` è¡¨çš„ `parameters_definition` æ¬„ä½ä¸­ã€‚é€™ä½¿å¾—å¹³å°å¯ä»¥åœ¨ä¸è§£æè…³æœ¬å…§å®¹çš„æƒ…æ³ä¸‹ï¼Œå¿«é€Ÿç”ŸæˆåŸ·è¡Œæ™‚çš„è¼¸å…¥è¡¨å–®ã€‚

**API è¨­è¨ˆ**ï¼š
*   `PUT /api/v1/scripts/{id}`ï¼šæ­¤ API çš„è«‹æ±‚é«” (Payload) æ‡‰åŒ…å«ï¼š
    *   `name`, `description` (åŸºæœ¬è³‡è¨Š)ã€‚
    *   `content` (æ–°çš„è…³æœ¬å…§å®¹)ã€‚
    *   `parameters_definition` (æ›´æ–°å¾Œçš„åƒæ•¸å®šç¾© JSON)ã€‚
    *   `commit_message` (å¯é¸ï¼Œè‹¥ç‚ºç©ºï¼Œå¾Œç«¯æ‡‰è‡ªå‹•ç”Ÿæˆ)ã€‚
    *   å¾Œç«¯è™•ç†æ­¤è«‹æ±‚å¾Œï¼Œæ‡‰å›å‚³åŒ…å«æ–° `commit_hash` çš„å®Œæ•´è…³æœ¬å…ƒæ•¸æ“šã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å¼•å…¥ Web IDE (Monaco Editor)**ï¼š
    *   ç›®å‰çš„ã€Œè…³æœ¬å…§å®¹ã€åªæ˜¯ä¸€å€‹ç°¡å–®çš„ `<textarea>`ã€‚**å¿…é ˆ**å°‡å…¶æ›¿æ›ç‚º **Monaco Editor** (VS Code çš„æ ¸å¿ƒå¼•æ“)ã€‚é€™å°‡ç«‹å³å¸¶ä¾†ä¼æ¥­ç´šçš„é«”é©—ï¼ŒåŒ…æ‹¬ï¼š
        *   **ç²¾æº–çš„èªæ³•é«˜äº®** (Python, Bash, etc.)ã€‚
        *   **ç¨‹å¼ç¢¼è‡ªå‹•è£œå…¨**ã€‚
        *   **èªæ³•éŒ¯èª¤å³æ™‚æç¤º (Linting)**ã€‚
        *   **ç¨‹å¼ç¢¼æ‘ºç–Š**å’Œ**å°åœ°åœ–å°èˆª**ã€‚
2.  **å¯¦ç¾çœŸæ­£çš„ç‰ˆæœ¬æ§åˆ¶ UI**ï¼š
    *   åœ¨å½ˆçª—ä¸­å¢åŠ ä¸€å€‹ã€Œ**ç‰ˆæœ¬æ­·å² (Version History)**ã€åˆ†é ã€‚
    *   æ­¤åˆ†é æ‡‰å‘¼å« `GET /api/v1/scripts/{id}/history` API ä¾†ç²å– Git æäº¤æ­·å²ã€‚
    *   UI ä¸Šæ‡‰ä»¥åˆ—è¡¨å½¢å¼å±•ç¤ºæ¯ä¸€æ¬¡ Commitï¼ŒåŒ…å« `commit_hash`ã€ä½œè€…ã€æ™‚é–“å’Œ Commit Messageã€‚
    *   ä½¿ç”¨è€…å¯ä»¥é»æ“Š**ä»»ä¸€ Commit** æŸ¥çœ‹ç•¶æ™‚çš„ç¨‹å¼ç¢¼å¿«ç…§ã€‚
    *   ä½¿ç”¨è€…å¯ä»¥é¸ä¸­**ä»»æ„å…©å€‹ç‰ˆæœ¬**ï¼ŒUI æ‡‰åœ¨ä¸€å€‹**ä¸¦æ’æ¯”è¼ƒ (Side-by-Side Diff)** è¦–åœ–ä¸­æ¸…æ™°åœ°å±•ç¤ºå…¶å·®ç•°ã€‚
    *   æ¯å€‹æ­·å²ç‰ˆæœ¬æ—éƒ½æ‡‰æœ‰ä¸€å€‹ã€Œ**é‚„åŸåˆ°æ­¤ç‰ˆæœ¬ (Revert to this version)**ã€æŒ‰éˆ•ï¼Œè®“ SRE å¯ä»¥å®‰å…¨ã€å¿«é€Ÿåœ°å›æ»¾éŒ¯èª¤çš„è®Šæ›´ã€‚
3.  **å¢å¼·çš„åƒæ•¸è¨­å®š**ï¼š
    *   åƒæ•¸é¡å‹ä¸æ‡‰åƒ…é™æ–¼ `String`ã€‚æ‡‰æ“´å……ç‚ºä¸€å€‹æ›´è±å¯Œçš„é¡å‹ç³»çµ±ï¼Œè‡³å°‘åŒ…æ‹¬ `String`, `Number`, `Boolean` (æ¸²æŸ“ç‚ºé–‹é—œ), å’Œ `Secret` (æ¸²æŸ“ç‚ºå¯†ç¢¼è¼¸å…¥æ¡†ï¼Œå…¶å€¼çµ•ä¸æ‡‰åœ¨ API ä¸­æ˜æ–‡å‚³è¼¸ï¼Œè€Œæ‡‰æ˜¯ä¸€å€‹æŒ‡å‘ Vault ä¸­ç¥•å¯†çš„å¼•ç”¨)ã€‚
    *   æ‡‰å…è¨±ç‚ºåƒæ•¸è¨­å®šã€Œ**é è¨­å€¼**ã€å’Œã€Œ**æ˜¯å¦å¿…å¡«**ã€çš„é¸é …ã€‚

#### ç·¨è¼¯æ’ç¨‹ - ç°¡æ˜“æ¨¡å¼ [ç·¨è¼¯æ’ç¨‹-ç°¡æ˜“æ¨¡å¼](images/55-å½ˆçª—-æ’ç¨‹ç®¡ç†-ç·¨è¼¯æ’ç¨‹-ç°¡æ˜“æ¨¡å¼.png)

**åŠŸèƒ½æè¿°**ï¼š
- æ’ç¨‹ä»»å‹™ç·¨è¼¯å½ˆçª—çš„ç°¡æ˜“æ¨¡å¼
- æä¾›å¸¸ç”¨çš„æ’ç¨‹é¸é …å’Œå¿«é€Ÿè¨­å®š
- æ”¯æ´åŸºæœ¬é‡è¤‡æ¨¡å¼è¨­å®š

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/schedules/{id}` - æ›´æ–°æ’ç¨‹ä»»å‹™

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ™ºèƒ½æ™‚é–“é¸æ“‡**ï¼šæä¾›è¦–è¦ºåŒ–æ™‚é–“é¸æ“‡å™¨å’ŒCRONè¡¨é”å¼ç”¢ç”Ÿå™¨
2. **å³æ™‚é è¦½**ï¼šå³æ™‚é¡¯ç¤ºä¸‹æ¬¡åŸ·è¡Œæ™‚é–“å’Œæ’ç¨‹çš„äººé¡å¯è®€æè¿°
3. **è¡çªæª¢æŸ¥**ï¼šè‡ªå‹•æª¢æŸ¥èˆ‡å…¶ä»–æ’ç¨‹çš„æ™‚é–“è¡çª
4. **è³‡æºç´„æŸ**ï¼šè¨­å®šåŸ·è¡Œæ™‚é–“é™åˆ¶å’Œè³‡æºä½¿ç”¨é™åˆ¶
5. **ä¾è³´æ’ç¨‹**ï¼šæ”¯æ´ä»»å‹™é–“çš„ä¾è³´é—œä¿‚å’Œæ¢ä»¶è§¸ç™¼

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤å½ˆçª—è¨­è¨ˆã€‚ç°¡æ˜“æ¨¡å¼æ˜¯é™ä½è‡ªå‹•åŒ–ä½¿ç”¨é–€æª»ã€è®“éå°ˆå®¶ä¹Ÿèƒ½å®‰å…¨è¨­å®šæ’ç¨‹çš„é—œéµã€‚å…¶æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼**å°‡è¤‡é›œçš„ CRON èªæ³•ï¼ŒæŠ½è±¡åŒ–ç‚ºäººé¡å¯ç†è§£çš„ã€å¼•å°å¼çš„é¸é …**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **æ ¸å¿ƒè·è²¬ï¼šç¿»è­¯å±¤ (Translation Layer)**
    *   æ­¤ UI çš„å¾Œç«¯æ ¸å¿ƒæ˜¯ä¸€å€‹**ç¿»è­¯å™¨**ã€‚å®ƒæ¥æ”¶ä¾†è‡ªå‰ç«¯çš„ã€çµæ§‹åŒ–çš„ç°¡æ˜“æ’ç¨‹ç‰©ä»¶ï¼Œä¸¦å°‡å…¶å¯é åœ°è½‰æ›ç‚ºæ¨™æº–çš„ CRON è¡¨é”å¼ï¼Œç„¶å¾Œå„²å­˜åˆ°è³‡æ–™åº«çš„ `cron_expression` æ¬„ä½ã€‚
    *   **ç¯„ä¾‹ç¿»è­¯**ï¼š
        *   `{ "frequency": "daily", "time": "11:00" }` -> `0 11 * * *`
        *   `{ "frequency": "weekly", "day_of_week": 6, "time": "14:30" }` -> `30 14 * * 6`
        *   `{ "frequency": "monthly", "day_of_month": 1, "time": "01:00" }` -> `0 1 1 * *`
    *   é€™å€‹ç¿»è­¯é‚è¼¯å¿…é ˆæœ‰å®Œæ•´çš„å–®å…ƒæ¸¬è©¦è¦†è“‹ï¼Œä»¥ç¢ºä¿å…¶æº–ç¢ºæ€§ã€‚
2.  **API è¨­è¨ˆï¼šçµ±ä¸€å…¥å£ï¼Œå€åˆ†æ¨¡å¼**
    *   `POST /api/v1/schedules` å’Œ `PUT /api/v1/schedules/{id}` çš„è«‹æ±‚é«” (Payload) æ‡‰åŒ…å«ä¸€å€‹ `mode` æ¬„ä½ (`"simple"` æˆ– `"advanced"`)ã€‚
    *   å¦‚æœ `mode` æ˜¯ `"simple"`ï¼Œå‰‡ payload æ‡‰åŒ…å«ä¸€å€‹ `simple_schedule_data` ç‰©ä»¶ï¼Œå…¶çµæ§‹å°æ‡‰ç°¡æ˜“æ¨¡å¼çš„é¸é …ã€‚å¾Œç«¯åœ¨å„²å­˜å‰ï¼Œæœƒå‘¼å«ç¿»è­¯å±¤å°‡å…¶è½‰æ›ç‚º `cron_expression`ã€‚
    *   å¦‚æœ `mode` æ˜¯ `"advanced"`ï¼Œå‰‡ payload ç›´æ¥åŒ…å« `cron_expression` å­—ä¸²ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å³æ™‚åé¥‹èˆ‡é è¦½ (Real-time Feedback & Preview)**ï¼š
    *   é€™æ˜¯æœ€é‡è¦çš„ UX æ”¹å–„ã€‚ç•¶ä½¿ç”¨è€…åœ¨ç°¡æ˜“æ¨¡å¼ä¸‹èª¿æ•´ã€ŒåŸ·è¡Œé »ç‡ã€æˆ–ã€ŒåŸ·è¡Œæ™‚é–“ã€æ™‚ï¼Œä»‹é¢ä¸Š**å¿…é ˆ**æœ‰ä¸€å€‹å€åŸŸ**å³æ™‚é¡¯ç¤º**å°æ‡‰çš„ CRON è¡¨é”å¼å’Œ**æ¥ä¸‹ä¾† 3 æ¬¡çš„é è¨ˆåŸ·è¡Œæ™‚é–“**ã€‚
    *   ä¾‹å¦‚ï¼Œç•¶ä½¿ç”¨è€…é¸æ“‡ã€Œæ¯æ—¥ã€å’Œã€Œ11:00ã€ï¼ŒUI ä¸Šæ‡‰ç«‹å³é¡¯ç¤ºï¼š
        > é è¦½: `0 11 * * *`
        >
        > æ¥ä¸‹ä¾†çš„åŸ·è¡Œæ™‚é–“:
        > - 2025-09-19 11:00:00 (Asia/Taipei)
        > - 2025-09-20 11:00:00 (Asia/Taipei)
        > - 2025-09-21 11:00:00 (Asia/Taipei)
    *   é€™å€‹å³æ™‚é è¦½èƒ½çµ¦äºˆä½¿ç”¨è€…æ¥µå¤§çš„ä¿¡å¿ƒï¼Œç¢ºä¿ä»–å€‘çš„è¨­å®šè¢«ç³»çµ±æ­£ç¢ºç†è§£ã€‚
2.  **æ˜ç¢ºçš„æ™‚å€è™•ç†**ï¼š
    *   ã€ŒåŸ·è¡Œæ™‚é–“ã€è¼¸å…¥æ¡†æ—æ‡‰æ˜ç¢ºæ¨™ç¤ºå…¶æ‰€ä½¿ç”¨çš„**æ™‚å€**ï¼ˆä¾‹å¦‚ï¼Œé¡¯ç¤º `(UTC+8)` æˆ– `(Asia/Taipei)`ï¼‰ã€‚
    *   ç†æƒ³æƒ…æ³ä¸‹ï¼Œæ‡‰å…è¨±ä½¿ç”¨è€…ç‚ºæ¯å€‹æ’ç¨‹å–®ç¨é¸æ“‡æ™‚å€ï¼Œä»¥æ‡‰å°è·¨åœ‹åœ˜éšŠæˆ–è·¨æ™‚å€è³‡æºçš„ç®¡ç†éœ€æ±‚ã€‚
3.  **ç›®æ¨™è³‡æºçš„æ™ºæ…§åŒ–**ï¼š
    *   ã€Œç›®æ¨™è³‡æºã€çš„ä¸‹æ‹‰é¸å–®æ‡‰æ”¯æ´**æœå°‹**å’Œ**åˆ†çµ„**ï¼ˆæŒ‰è³‡æºç¾¤çµ„æˆ–æ¨™ç±¤ï¼‰ã€‚å°æ–¼æœ‰å¤§é‡è³‡æºçš„ç’°å¢ƒï¼Œé€™æ˜¯ç¢ºä¿å¯ç”¨æ€§çš„åŸºæœ¬è¦æ±‚ã€‚
    *   é¸ä¸­è³‡æºå¾Œï¼Œæ‡‰ä»¥æ¨™ç±¤ (Tag) çš„å½¢å¼é¡¯ç¤ºï¼Œè€Œä¸æ˜¯ä¸€å€‹æ“æ“ çš„ä¸‹æ‹‰é¸å–®ã€‚

#### ç·¨è¼¯æ’ç¨‹ - é€²éšæ¨¡å¼ [ç·¨è¼¯æ’ç¨‹-é€²éšæ¨¡å¼](images/56-å½ˆçª—-æ’ç¨‹ç®¡ç†-ç·¨è¼¯æ’ç¨‹-é€²éšæ¨¡å¼.png)

**åŠŸèƒ½æè¿°**ï¼š
- æ’ç¨‹ä»»å‹™ç·¨è¼¯å½ˆçª—çš„é€²éšæ¨¡å¼
- æ”¯æ´è¤‡é›œçš„CRONè¡¨é”å¼è¨­å®š
- æä¾›æ—¥æ›†è¦–åœ–å’Œæ™‚é–“é æ¸¬

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/schedules/{id}` - æ›´æ–°æ’ç¨‹ä»»å‹™

**UX æ”¹å–„å»ºè­°**ï¼š
1. **é€²éšè¡¨é”å¼**ï¼šæ”¯æ´è¤‡é›œCRONè¡¨é”å¼çš„è¦–è¦ºåŒ–ç·¨è¼¯å’Œé©—è­‰
2. **æ™‚é–“å¸¶æ”¯æ´**ï¼šæ”¯æ´å¤šæ™‚å€çš„æ’ç¨‹è¨­å®šå’Œè½‰æ›
3. **ç•°å¸¸è™•ç†**ï¼šé…ç½®æ’ç¨‹å¤±æ•—æ™‚çš„é‡è©¦ç­–ç•¥å’Œé€šçŸ¥
4. **æ­·å²åˆ†æ**ï¼šåˆ†ææ’ç¨‹çš„åŸ·è¡Œæ­·å²å’Œæ€§èƒ½è¶¨å‹¢
5. **è³‡æºç›£æ§**ï¼šå³æ™‚ç›£æ§æ’ç¨‹åŸ·è¡Œçš„è³‡æºä½¿ç”¨æƒ…æ³

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤å½ˆçª—è¨­è¨ˆã€‚é€²éšæ¨¡å¼è³¦äºˆäº† SRE å°ˆå®¶å€‘æœ€å¤§çš„éˆæ´»æ€§ï¼Œè®“ä»–å€‘å¯ä»¥å®šç¾©ä»»æ„è¤‡é›œçš„æ’ç¨‹ã€‚æ­¤æ¨¡å¼çš„æ ¸å¿ƒè¨­è¨ˆç†å¿µæ‡‰æ˜¯**åœ¨æä¾›å®Œå…¨æ§åˆ¶æ¬Šçš„åŒæ™‚ï¼Œçµ¦äºˆè¶³å¤ çš„è¼”åŠ©å’Œé©—è­‰ï¼Œé˜²æ­¢å› æ‰‹èª¤å¼•ç™¼çš„éŒ¯èª¤**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **æ ¸å¿ƒè·è²¬ï¼šé©—è­‰å±¤ (Validation Layer)**
    *   åœ¨é€²éšæ¨¡å¼ä¸‹ï¼Œå¾Œç«¯çš„ä¸»è¦è·è²¬æ˜¯**é©—è­‰**ã€‚ç•¶æ¥æ”¶åˆ° `PUT /api/v1/schedules/{id}` è«‹æ±‚ä¸” `mode` ç‚º `"advanced"` æ™‚ï¼Œå¾Œç«¯**å¿…é ˆ**ä½¿ç”¨ä¸€å€‹å¯é çš„ Go Cron è§£æå‡½å¼åº« (å¦‚ `robfig/cron`) ä¾†é©—è­‰ `cron_expression` å­—ä¸²çš„èªæ³•æ˜¯å¦æœ‰æ•ˆã€‚
    *   å¦‚æœèªæ³•ç„¡æ•ˆï¼ŒAPI **å¿…é ˆ**å›å‚³ `400 Bad Request` ç‹€æ…‹ç¢¼ï¼Œä¸¦åœ¨å›æ‡‰ä¸»é«”ä¸­æä¾›æ¸…æ™°çš„éŒ¯èª¤è¨Šæ¯ï¼Œä¾‹å¦‚ `{"error": "Invalid CRON expression: field 'day of week' has value out of range"}`ã€‚
2.  **API è¨­è¨ˆ**ï¼š
    *   API è¨­è¨ˆèˆ‡ç°¡æ˜“æ¨¡å¼ä¿æŒä¸€è‡´ã€‚ç•¶ `mode` ç‚º `"advanced"` æ™‚ï¼ŒAPI ç›´æ¥æ¥æ”¶ `cron_expression` å­—ä¸²ï¼Œé©—è­‰å¾Œå­˜å…¥è³‡æ–™åº«ã€‚
    *   ç„¡è«–æ˜¯ç°¡æ˜“æ¨¡å¼é‚„æ˜¯é€²éšæ¨¡å¼ï¼Œå¾Œç«¯éƒ½æ‡‰åœ¨å„²å­˜å¾Œï¼Œç«‹å³æ ¹æ“šæœ€çµ‚çš„ `cron_expression` è¨ˆç®— `next_execution_time` ä¸¦æ›´æ–°è³‡æ–™åº«æ¬„ä½ï¼Œç¢ºä¿è³‡æ–™çš„ä¸€è‡´æ€§ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å³æ™‚ CRON é©—è­‰èˆ‡ç¿»è­¯å™¨**ï¼š
    *   é€™æ˜¯æ­¤ä»‹é¢**æœ€é‡è¦çš„ UX å¼·åŒ–**ã€‚çµ•ä¸èƒ½è®“ä½¿ç”¨è€…åœ¨é»æ“Šã€Œå„²å­˜ã€å¾Œæ‰ç™¼ç¾ CRON å¯«éŒ¯äº†ã€‚
    *   ç•¶ä½¿ç”¨è€…åœ¨ã€ŒCRON è¡¨é”å¼ã€è¼¸å…¥æ¡†ä¸­æ‰“å­—æ™‚ï¼ŒUI æ‡‰**å³æ™‚**æä¾›ä»¥ä¸‹ä¸‰ç¨®åé¥‹ï¼š
        1.  **èªæ³•æª¢æŸ¥**ï¼šè¼¸å…¥æ¡†æ—é¡¯ç¤ºä¸€å€‹åœ–ç¤ºï¼Œæœ‰æ•ˆæ™‚ç‚ºç¶ è‰²å‹¾è™Ÿ âœ…ï¼Œç„¡æ•ˆæ™‚ç‚ºç´…è‰²å‰è™Ÿ âŒã€‚
        2.  **èªç¾©ç¿»è­¯**ï¼šåœ¨è¼¸å…¥æ¡†ä¸‹æ–¹ï¼Œå°‡ CRON è¡¨é”å¼**å³æ™‚ç¿»è­¯æˆäººé¡å¯è®€çš„èªè¨€**ã€‚ä¾‹å¦‚ï¼Œè¼¸å…¥ `0 11 * * 1-5` å¾Œï¼Œä¸‹æ–¹ç«‹å³é¡¯ç¤ºã€Œæ­¤ä»»å‹™å°‡åœ¨æ¯å€‹å·¥ä½œæ—¥ (é€±ä¸€è‡³é€±äº”) çš„ä¸Šåˆ 11:00 åŸ·è¡Œã€ã€‚
        3.  **åŸ·è¡Œé è¦½**ï¼šé€²ä¸€æ­¥é¡¯ç¤º**æ¥ä¸‹ä¾† 5 æ¬¡çš„é è¨ˆåŸ·è¡Œæ™‚é–“**åˆ—è¡¨ï¼Œä¸¦é™„ä¸Šæ™‚å€ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å®Œå…¨ç¢ºèªæ’ç¨‹çš„è¡Œç‚ºæ˜¯å¦ç¬¦åˆé æœŸã€‚
2.  **å…§å»º CRON èªæ³•é€ŸæŸ¥è¡¨**ï¼š
    *   é»æ“Šè¼¸å…¥æ¡†æ—çš„è³‡è¨Šåœ–ç¤º (`i`)ï¼Œä¸æ‡‰åªæ˜¯ä¸€å€‹ç°¡å–®çš„ Tooltipï¼Œè€Œæ‡‰å½ˆå‡ºä¸€å€‹**åŒ…å«å¸¸ç”¨ç¯„ä¾‹çš„é€ŸæŸ¥è¡¨ (Cheat Sheet)**ã€‚
    *   é€™å€‹é€ŸæŸ¥è¡¨æ‡‰æä¾›é¡ä¼¼ä»¥ä¸‹çš„å…§å®¹ï¼Œä¸¦å…è¨±ä½¿ç”¨è€…**é»æ“Šç¯„ä¾‹ç›´æ¥å¡«å…¥**è¼¸å…¥æ¡†ï¼š
        *   `* * * * *` - æ¯åˆ†é˜
        *   `0 */2 * * *` - æ¯å…©å°æ™‚
        *   `0 9-17 * * 1-5` - æ¯å€‹å·¥ä½œæ—¥çš„ 9 é»åˆ° 17 é»ï¼Œæ¯å°æ™‚çš„ 0 åˆ†
        *   `@daily` - æ¯æ—¥å‡Œæ™¨ 0 é» (ç­‰åŒæ–¼ `0 0 * * *`)

é€éé€™äº›å¼·åŒ–ï¼Œå³ä½¿æ˜¯é€²éšæ¨¡å¼ï¼Œä¹Ÿèƒ½è®Šå¾—æ¥µç‚ºå‹å¥½å’Œé«˜æ•ˆï¼Œæœ‰æ•ˆæ¸›å°‘äººç‚ºå¤±èª¤ï¼Œæå‡å¹³å°çš„æ•´é«”å¯é æ€§ã€‚

#### åŸ·è¡Œæ—¥èªŒè©³æƒ… [åŸ·è¡Œæ—¥èªŒè©³æƒ…](images/57-å½ˆçª—-åŸ·è¡Œæ—¥èªŒ-åŸ·è¡Œæ—¥èªŒè©³æƒ….png)

**åŠŸèƒ½æè¿°**ï¼š
- åŸ·è¡Œæ—¥èªŒè©³æƒ…æŠ½å±œ
- é¡¯ç¤ºè…³æœ¬åŸ·è¡Œçš„å®Œæ•´æ—¥èªŒå’Œè¼¸å‡º
- æ”¯æ´æ—¥èªŒæœå°‹å’Œéæ¿¾åŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/execution-logs/{id}` - ç²å–åŸ·è¡Œè©³æƒ…
- `GET /api/v1/execution-logs/{id}/output` - ç²å–åŸ·è¡Œè¼¸å‡º

**UX æ”¹å–„å»ºè­°**ï¼š
1. **åŠŸèƒ½å®Œå–„**ï¼šæ ¹æ“šå…·é«”åŠŸèƒ½éœ€æ±‚æä¾›ç›¸æ‡‰çš„UXæ”¹å–„å»ºè­°
2. **ä½¿ç”¨è€…é«”é©—å„ªåŒ–**ï¼šæ”¹å–„ç•Œé¢äº¤äº’å’Œæ“ä½œæµç¨‹
3. **å¯åŠæ€§æ”¹å–„**ï¼šæå‡ç•Œé¢çš„å¯åŠæ€§å’Œæ˜“ç”¨æ€§
4. **æ€§èƒ½å„ªåŒ–**ï¼šå„ªåŒ–è¼‰å…¥é€Ÿåº¦å’ŒéŸ¿æ‡‰æ™‚é–“
5. **éŒ¯èª¤è™•ç†**ï¼šå®Œå–„éŒ¯èª¤æç¤ºå’Œç•°å¸¸æƒ…æ³è™•ç†

### æ’ç¨‹ç®¡ç† [æ’ç¨‹ç®¡ç†](images/52-é é¢-æ’ç¨‹ç®¡ç†.png)

**åŠŸèƒ½æè¿°**ï¼š
- è‡ªå‹•åŒ–ä»»å‹™æ’ç¨‹ç®¡ç†
- æ’ç¨‹çµ±è¨ˆå’ŒåŸ·è¡Œç‹€æ…‹ç›£æ§
- æ’ç¨‹è¡¨æ ¼ï¼šå•Ÿç”¨ç‹€æ…‹ã€ä»»å‹™åç¨±ã€è…³æœ¬åç¨±ã€CRON æ¢ä»¶ã€ä¸Šæ¬¡ç‹€æ…‹ã€ä¸Šæ¬¡åŸ·è¡Œæ™‚é–“ã€ä¸‹æ¬¡åŸ·è¡Œæ™‚é–“
- æ’ç¨‹ç‹€æ…‹æŒ‡ç¤ºï¼ˆSUCCESS/FAILEDï¼‰

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/schedules` - ç²å–æ’ç¨‹åˆ—è¡¨
- `POST /api/v1/schedules` - å‰µå»ºæ–°æ’ç¨‹
- `PUT /api/v1/schedules/{id}` - æ›´æ–°æ’ç¨‹
- `DELETE /api/v1/schedules/{id}` - åˆªé™¤æ’ç¨‹
- `PUT /api/v1/schedules/{id}/toggle` - å•Ÿç”¨/åœç”¨æ’ç¨‹

**UX æ”¹å–„å»ºè­°**ï¼š
1. **è¦–è¦ºåŒ–æ’ç¨‹**ï¼šæä¾›æ—¥æ›†è¦–åœ–é¡¯ç¤ºæ’ç¨‹æ™‚é–“è¡¨
2. **CRON åŠ©æ‰‹**ï¼šå¯è¦–åŒ– CRON è¡¨é”å¼ç”Ÿæˆå™¨
3. **åŸ·è¡Œé æ¸¬**ï¼šé¡¯ç¤ºæœªä¾†åŸ·è¡Œæ™‚é–“é æ¸¬
4. **ä¾è³´æ’ç¨‹**ï¼šæ”¯æ´ä»»å‹™é–“çš„ä¾è³´é—œä¿‚è¨­å®š
5. **å‘Šè­¦æ•´åˆ**ï¼šæ’ç¨‹å¤±æ•—æ™‚è‡ªå‹•ç™¼é€å‘Šè­¦

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚æ’ç¨‹ç®¡ç†æ˜¯è‡ªå‹•åŒ–ä¸­å¿ƒçš„å¤§è…¦ï¼Œè² è²¬åœ¨ç„¡äººå¹²é çš„æƒ…æ³ä¸‹ï¼Œå¯é ã€æº–æ™‚åœ°è§¸ç™¼ä¾‹è¡Œä»»å‹™ã€‚æ­¤ UI è¨­è¨ˆæ¸…æ™°åœ°å±•ç¤ºäº†æ’ç¨‹çš„æ ¸å¿ƒè³‡è¨Šï¼Œä½†å…¶èƒŒå¾Œçš„å¾Œç«¯æ¶æ§‹æ˜¯ç¢ºä¿åŠŸèƒ½æˆæ•—çš„é—œéµã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **æ ¸å¿ƒå¼•æ“ï¼šæŒä¹…åŒ–æ’ç¨‹å™¨ (Persistent Scheduler)**
    *   å¾Œç«¯**å¿…é ˆ**æ¡ç”¨ä¸€å€‹æ”¯æ´**æŒä¹…åŒ–**çš„ Go Cron å‡½å¼åº«ï¼ˆå¦‚ `gocron` æ­é…å…¶ `postgres-adapter`ï¼‰ã€‚é€™æ„å‘³è‘—å³ä½¿å¾Œç«¯æœå‹™é‡å•Ÿï¼Œå·²è¨»å†Šçš„æ’ç¨‹ä»»å‹™ä¹Ÿä¸æœƒéºå¤±ã€‚
    *   å¹³å°å•Ÿå‹•æ™‚ï¼Œæ’ç¨‹å™¨æœå‹™æœƒå¾ `schedules` è³‡æ–™è¡¨ä¸­è¼‰å…¥æ‰€æœ‰ã€Œå·²å•Ÿç”¨ã€çš„æ’ç¨‹ï¼Œä¸¦åœ¨è¨˜æ†¶é«”ä¸­è¨»å†Šå°æ‡‰çš„ Cron Jobã€‚
2.  **è³‡æ–™åº«æ¨¡å‹ (`schedules` table)**ï¼š
    *   æ ¸å¿ƒæ¬„ä½æ‡‰åŒ…å«ï¼š`id`, `name`, `script_id` (é—œè¯åˆ°è…³æœ¬), `cron_expression`, `is_enabled`, `parameters` (JSONBï¼Œå„²å­˜è…³æœ¬åŸ·è¡Œæ™‚æ‰€éœ€çš„åƒæ•¸), `last_execution_time`, `next_execution_time`, `last_status` (`SUCCESS`, `FAILED`)ã€‚
    *   `next_execution_time` **å¿…é ˆ**ç”±å¾Œç«¯æ’ç¨‹å™¨åœ¨æ¯æ¬¡ä»»å‹™åŸ·è¡Œå®Œç•¢æˆ–æ›´æ–°æ’ç¨‹å¾Œï¼Œæ ¹æ“š CRON è¡¨é”å¼**é‡æ–°è¨ˆç®—ä¸¦å¯«å›è³‡æ–™åº«**ã€‚å‰ç«¯æ‡‰ç›´æ¥è®€å–æ­¤æ¬„ä½ï¼Œè€Œä¸æ˜¯è‡ªè¡Œè¨ˆç®—ã€‚
3.  **æ’ç¨‹è§¸ç™¼å·¥ä½œæµç¨‹**ï¼š
    *   ç•¶ä¸€å€‹ Cron Job è¢«è§¸ç™¼æ™‚ï¼Œæ’ç¨‹å™¨**ä¸æ‡‰ç›´æ¥åŸ·è¡Œ**è…³æœ¬ã€‚
    *   æ­£ç¢ºæµç¨‹æ˜¯ï¼šæ’ç¨‹å™¨å°‡ä¸€å€‹ã€ŒåŸ·è¡Œä»»å‹™ã€ï¼ˆåŒ…å« `script_id` å’Œ `parameters`ï¼‰æ¨é€åˆ°èˆ‡è…³æœ¬åº«å…±ç”¨çš„**éåŒæ­¥ä»»å‹™ä½‡åˆ—**ä¸­ã€‚
    *   ä»»å‹™åŸ·è¡Œå™¨ (Worker) æ¶ˆè²»æ­¤ä»»å‹™ï¼ŒåŸ·è¡Œè…³æœ¬ï¼Œä¸¦åœ¨åŸ·è¡ŒçµæŸå¾Œï¼Œå°‡çµæœï¼ˆæˆåŠŸ/å¤±æ•—ï¼‰å’Œæ—¥èªŒ ID **å›å¯«**åˆ° `execution_logs` è¡¨ã€‚åŒæ™‚ï¼Œæ‡‰æœ‰ä¸€å€‹å›å‘¼ (callback) æ©Ÿåˆ¶ä¾†æ›´æ–° `schedules` è¡¨ä¸­å°æ‡‰ä»»å‹™çš„ `last_status` å’Œ `last_execution_time`ã€‚

**API è¨­è¨ˆ**ï¼š
*   `GET /api/v1/schedules`ï¼šå›å‚³æ’ç¨‹åˆ—è¡¨ã€‚æ­¤ API æ‡‰ç›´æ¥å¾ `schedules` è¡¨ä¸­è®€å–è³‡æ–™ï¼ŒåŒ…å«å¾Œç«¯å·²è¨ˆç®—å¥½çš„ `last_status` å’Œ `next_execution_time`ã€‚
*   `POST /api/v1/schedules`ï¼šå»ºç«‹æ–°æ’ç¨‹ã€‚å¾Œç«¯åœ¨å¯«å…¥è³‡æ–™åº«çš„åŒæ™‚ï¼Œå¿…é ˆå‘åŸ·è¡Œä¸­çš„æ’ç¨‹å™¨æœå‹™**å‹•æ…‹è¨»å†Š**é€™å€‹æ–°çš„ Cron Jobã€‚
*   `PUT /api/v1/schedules/{id}`ï¼šæ›´æ–°æ’ç¨‹ã€‚å¾Œç«¯éœ€è¦å…ˆå¾æ’ç¨‹å™¨ä¸­ç§»é™¤èˆŠçš„ Jobï¼Œæ›´æ–°è³‡æ–™åº«ï¼Œç„¶å¾Œå†è¨»å†Šä¸€å€‹æ–°çš„ Jobã€‚
*   `PUT /api/v1/schedules/{id}/toggle`ï¼šåˆ‡æ›å•Ÿç”¨ç‹€æ…‹ã€‚å¾Œç«¯æ ¹æ“š `is_enabled` çš„å€¼ï¼Œå‘æ’ç¨‹å™¨æœå‹™å‹•æ…‹æ–°å¢æˆ–ç§»é™¤å°æ‡‰çš„ Cron Jobã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **CRON è¡¨é”å¼çš„äººæ€§åŒ–**ï¼š
    *   åœ¨ã€ŒCRON æ¢ä»¶ã€æ¬„ä½ï¼ˆå¦‚ `æ¯æ—¥ 2:00`ï¼‰æ—ï¼Œæ‡‰å¢åŠ ä¸€å€‹è³‡è¨Šåœ–ç¤º (`i`)ã€‚æ»‘é¼ æ‡¸åœæ™‚ï¼Œé¡¯ç¤ºä¸€å€‹å·¥å…·æç¤º (Tooltip)ï¼Œå°‡ CRON è¡¨é”å¼**ç¿»è­¯æˆäººé¡å¯è®€çš„èªè¨€**ï¼ˆä¾‹å¦‚ï¼Œã€Œæ­¤ä»»å‹™å°‡åœ¨æ¯å€‹æœˆçš„1è™Ÿå’Œ15è™Ÿçš„å‡Œæ™¨3é»åŸ·è¡Œã€ï¼‰ã€‚å¯ä»¥ä½¿ç”¨ `cron-parser` æˆ–é¡ä¼¼å‡½å¼åº«åœ¨å‰ç«¯æˆ–å¾Œç«¯å¯¦ç¾ã€‚
2.  **å³æ™‚æ¸¬è©¦èˆ‡åé¥‹**ï¼š
    *   åœ¨æ“ä½œæ¬„ä¸­ï¼Œé™¤äº†ã€Œç·¨è¼¯ã€å’Œã€Œåˆªé™¤ã€ï¼Œæ‡‰å¢åŠ ä¸€å€‹ã€Œ**ç«‹å³åŸ·è¡Œ (Run Now)**ã€çš„æŒ‰éˆ•ã€‚é€™å…è¨±ä½¿ç”¨è€…åœ¨ä¸ç­‰å¾…æ’ç¨‹æ™‚é–“çš„æƒ…æ³ä¸‹ï¼Œç«‹å³è§¸ç™¼ä¸€æ¬¡ä»»å‹™ï¼Œä»¥æ¸¬è©¦å…¶æ­£ç¢ºæ€§ã€‚
3.  **ç„¡ç¸«çš„æ—¥èªŒè¿½è¹¤**ï¼š
    *   ã€Œä¸Šæ¬¡ç‹€æ…‹ã€æ¬„ä½ä¸­çš„ `SUCCESS`/`FAILED` æ¨™ç±¤æ‡‰æ˜¯ä¸€å€‹**è¶…é€£çµ**ï¼Œç›´æ¥éˆæ¥åˆ°**è©²æ¬¡åŸ·è¡Œçš„è©³ç´°æ—¥èªŒé é¢**ã€‚é€™èƒ½è®“ä½¿ç”¨è€…åœ¨æ’ç¨‹å¤±æ•—æ™‚ï¼Œä¸€éµè·³è½‰åˆ°æ—¥èªŒé€²è¡Œå•é¡Œæ’æŸ¥ï¼Œå½¢æˆé«˜æ•ˆçš„å·¥ä½œé–‰ç’°ã€‚
4.  **é¿å…æ’ç¨‹æ¼‚ç§» (Schedule Drift)**ï¼š
    *   UI æ‡‰æ¸…æ¥šåœ°é¡¯ç¤ºæ¯å€‹æ™‚é–“æˆ³çš„**æ™‚å€**ï¼ˆä¾‹å¦‚ï¼Œ`Asia/Taipei`ï¼‰ï¼Œä¸¦åœ¨æ’ç¨‹ç·¨è¼¯é é¢ä¸­å…è¨±ä½¿ç”¨è€…ç‚ºæ’ç¨‹æŒ‡å®šæ™‚å€ï¼Œä»¥é¿å…å› å¤ä»¤æ™‚æˆ–ä¼ºæœå™¨æ™‚å€ä¸åŒè€Œå°è‡´çš„åŸ·è¡Œæ™‚é–“æ¼‚ç§»å•é¡Œã€‚

### åŸ·è¡Œæ—¥èªŒ [åŸ·è¡Œæ—¥èªŒ](images/53-é é¢-åŸ·è¡Œæ—¥èªŒ.png)

**åŠŸèƒ½æè¿°**ï¼š
- è‡ªå‹•åŒ–è…³æœ¬åŸ·è¡Œæ­·å²è¨˜éŒ„
- åŸ·è¡Œæ—¥èªŒæª¢ç´¢å’Œç¯©é¸ï¼ˆæ™‚é–“ç¯„åœã€è…³æœ¬åç¨±ç¯©é¸ï¼‰
- æ—¥èªŒè¡¨æ ¼ï¼šç‹€æ…‹ã€è…³æœ¬åç¨±ã€è§¸ç™¼æ–¹å¼ã€é–‹å§‹æ™‚é–“ã€åŸ·è¡Œçµæœ
- åŸ·è¡Œç‹€æ…‹åˆ†é¡ï¼ˆSUCCESS/FAILEDï¼‰

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/execution-logs` - ç²å–åŸ·è¡Œæ—¥èªŒ
- `GET /api/v1/execution-logs/{id}` - ç²å–è©³ç´°åŸ·è¡Œæ—¥èªŒ
- `GET /api/v1/execution-logs/{id}/output` - ç²å–åŸ·è¡Œè¼¸å‡º

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å¯¦æ™‚æ—¥èªŒ**ï¼šåŸ·è¡Œéç¨‹ä¸­çš„å¯¦æ™‚æ—¥èªŒæµ
2. **æ—¥èªŒåˆ†æ**ï¼šéŒ¯èª¤æ¨¡å¼åˆ†æå’Œæ™ºèƒ½å»ºè­°
3. **æ€§èƒ½çµ±è¨ˆ**ï¼šåŸ·è¡Œæ™‚é–“è¶¨å‹¢å’Œæ€§èƒ½åˆ†æ
4. **æ—¥èªŒå°å‡º**ï¼šæ”¯æ´æ—¥èªŒå°å‡ºå’Œé•·æœŸæ­¸æª”
5. **å‘Šè­¦é—œè¯**ï¼šé—œè¯åŸ·è¡Œå¤±æ•—èˆ‡ç³»çµ±å‘Šè­¦

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚åŸ·è¡Œæ—¥èªŒæ˜¯è‡ªå‹•åŒ–ç³»çµ±çš„ã€Œé£›è¡Œç´€éŒ„å„€ã€ï¼Œä¸åƒ…æ˜¯æ’æŸ¥å•é¡Œçš„ä¾æ“šï¼Œä¹Ÿæ˜¯è¡¡é‡è‡ªå‹•åŒ–æœ‰æ•ˆæ€§å’Œå®‰å…¨æ€§çš„é—œéµã€‚æ­¤ UI æä¾›äº†åŸºæœ¬çš„åˆ—è¡¨å’Œç¯©é¸ï¼Œä½†è¦å°‡å…¶æ‰“é€ æˆä¸€å€‹å¼·å¤§çš„åµéŒ¯èˆ‡å¯©è¨ˆå·¥å…·ï¼Œå¿…é ˆæ¡ç”¨æ­£ç¢ºçš„å¾Œç«¯æŠ€è¡“ä¸¦æ¥µå¤§åŒ–å…¶æŸ¥è©¢èƒ½åŠ›ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è¨­è¨ˆ**ï¼š
1.  **æ—¥èªŒå„²å­˜ï¼šElasticsearch ç‚ºæ ¸å¿ƒ**
    *   æ ¹æ“š `architecture.md`ï¼Œæ‰€æœ‰æ—¥èªŒè³‡æ–™ï¼ˆåŒ…æ‹¬æ­¤è™•çš„åŸ·è¡Œæ—¥èªŒï¼‰çš„**å–®ä¸€äº‹å¯¦ä¾†æº (SSOT)** æ‡‰ç‚º **Elasticsearch**ã€‚
    *   **åš´ç¦**å°‡æ—¥èªŒçš„å®Œæ•´è¼¸å‡º (stdout/stderr) å„²å­˜åœ¨ PostgreSQL ä¸­ï¼Œé€™æœƒå°è‡´è³‡æ–™åº«è†¨è„¹ã€æŸ¥è©¢æ•ˆèƒ½ä½ä¸‹ï¼Œä¸”ç„¡æ³•å¯¦ç¾å…¨æ–‡æª¢ç´¢ã€‚
2.  **è³‡æ–™æ¨¡å‹ (Elasticsearch Index)**ï¼š
    *   æ‡‰ç‚ºåŸ·è¡Œæ—¥èªŒå»ºç«‹ä¸€å€‹å°ˆé–€çš„ Elasticsearch ç´¢å¼• (e.g., `execution-logs-YYYY.MM`)ã€‚
    *   æ¯å€‹æ—¥èªŒæ–‡ä»¶ (Document) éƒ½æ‡‰æ˜¯çµæ§‹åŒ–çš„ï¼ŒåŒ…å«ä»¥ä¸‹é—œéµæ¬„ä½ï¼š
        *   `execution_id` (keyword): å”¯ä¸€åŸ·è¡Œ IDã€‚
        *   `script_id` (keyword): é—œè¯çš„è…³æœ¬ IDã€‚
        *   `script_name` (keyword): è…³æœ¬åç¨±ã€‚
        *   `trigger_type` (keyword): è§¸ç™¼æ–¹å¼ (`EVENT`, `SCHEDULE`, `MANUAL`)ã€‚
        *   `trigger_by` (keyword): è§¸ç™¼è€… (ä½¿ç”¨è€… ID æˆ– `system`)ã€‚
        *   `status` (keyword): `SUCCESS`, `FAILED`, `RUNNING`ã€‚
        *   `start_time`, `end_time` (date): èµ·æ­¢æ™‚é–“ã€‚
        *   `duration_ms` (long): åŸ·è¡Œè€—æ™‚ï¼ˆæ¯«ç§’ï¼‰ã€‚
        *   `output` (text): **å®Œæ•´çš„ stdout/stderr è¼¸å‡º**ï¼Œé€™æ˜¯å¯¦ç¾å…¨æ–‡æª¢ç´¢çš„é—œéµã€‚
        *   `parameters` (object): åŸ·è¡Œçš„è¼¸å…¥åƒæ•¸ã€‚
3.  **æ—¥èªŒæ”¶é›†æµç¨‹**ï¼š
    *   ä»»å‹™åŸ·è¡Œå™¨ (Worker) åœ¨åŸ·è¡Œè…³æœ¬æ™‚ï¼Œæ‡‰é€éä¸€å€‹æ—¥èªŒå‡½å¼åº« (å¦‚ Zap) å°‡æ—¥èªŒ**ç›´æ¥ã€å³æ™‚åœ°**ä¸²æµåˆ° Elasticsearchï¼Œè€Œä¸æ˜¯åœ¨ä»»å‹™çµæŸå¾Œæ‰æ•´æ‰¹å¯«å…¥ã€‚é€™ä½¿å¾—ä½¿ç”¨è€…å¯ä»¥å³æ™‚æŸ¥çœ‹æ­£åœ¨åŸ·è¡Œä¸­çš„ä»»å‹™æ—¥èªŒã€‚

**API è¨­è¨ˆ**ï¼š
*   `GET /api/v1/execution-logs`ï¼šæ­¤ API çš„å¾Œç«¯å¯¦ç¾**å¿…é ˆ**æ˜¯æŸ¥è©¢ **Elasticsearch**ï¼Œè€Œé PostgreSQLã€‚
    *   **ç¯©é¸**: API æ‡‰æ”¯æ´åŸºæ–¼ `script_name`, `status`, `trigger_type` å’Œæ™‚é–“ç¯„åœ (`@timestamp`) çš„ç²¾ç¢ºç¯©é¸ã€‚
    *   **å…¨æ–‡æª¢ç´¢**: åœ–ç‰‡ä¸­çš„ã€Œæœå°‹è…³æœ¬åç¨±æˆ–è§¸ç™¼è€…ã€æœå°‹æ¡†ï¼Œå…¶å¾Œç«¯æŸ¥è©¢æ‡‰ä½¿ç”¨ Elasticsearch çš„ `multi_match` æŸ¥è©¢ï¼ŒåŒæ™‚æœå°‹ `script_name`, `trigger_by` å’Œ **`output`** æ¬„ä½ã€‚é€™å…è¨±ä½¿ç”¨è€…è¼¸å…¥ã€Œ`Error: connection refused`ã€ä¾†å¿«é€Ÿæ‰¾åˆ°æ‰€æœ‰åŒ…å«æ­¤éŒ¯èª¤è¨Šæ¯çš„åŸ·è¡Œè¨˜éŒ„ã€‚
*   `GET /api/v1/execution-logs/{id}`ï¼šç²å–å–®ä¸€åŸ·è¡Œè¨˜éŒ„çš„**å®Œæ•´**æ—¥èªŒè¼¸å‡ºï¼ŒåŒæ¨£ä¾†è‡ª Elasticsearchã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å¼·åŒ–çš„æ—¥èªŒæª¢è¦–å™¨**ï¼š
    *   é»æ“Šä»»ä¸€åˆ—è¡¨é …ç›®ï¼Œæ‡‰åœ¨ä¸€å€‹**æŠ½å±œ (Drawer) æˆ–å½ˆçª— (Modal)** ä¸­é–‹å•Ÿä¸€å€‹åŠŸèƒ½è±å¯Œçš„æ—¥èªŒæª¢è¦–å™¨ã€‚
    *   æ­¤æª¢è¦–å™¨å¿…é ˆæä¾›**èªæ³•é«˜äº®**ï¼ˆè‹¥æ—¥èªŒå…§å®¹ç‚º JSON æˆ– YAMLï¼‰ã€**é¡¯ç¤ºè¡Œè™Ÿ**å’Œ**ä¸€éµè¤‡è£½å®Œæ•´æ—¥èªŒ**çš„åŠŸèƒ½ã€‚
    *   å°æ–¼é•·æ—¥èªŒï¼Œæ‡‰æä¾›**å³æ™‚æœå°‹å’Œé«˜äº®**åŒ¹é…é—œéµå­—çš„åŠŸèƒ½ã€‚
2.  **ä¸Šä¸‹æ–‡çš„ç„¡ç¸«è¿½æº¯**ï¼š
    *   è¡¨æ ¼ä¸­çš„ã€Œè§¸ç™¼æ–¹å¼ã€æ¬„ä½æ‡‰æ˜¯**å¯é»æ“Šçš„è¶…é€£çµ**ã€‚ä¾‹å¦‚ï¼š
        *   è‹¥ç‚º `Event`ï¼Œé»æ“Šå¾Œæ‡‰å½ˆå‡ºé—œè¯äº‹ä»¶çš„è©³æƒ…ã€‚
        *   è‹¥ç‚º `Schedule`ï¼Œé»æ“Šå¾Œæ‡‰è·³è½‰åˆ°è©²æ’ç¨‹çš„è¨­å®šé é¢ã€‚
        *   è‹¥ç‚º `Manual (admin)`ï¼Œé»æ“Šå¾Œæ‡‰é¡¯ç¤ºè©²ä½¿ç”¨è€…çš„è³‡è¨Šã€‚
    *   ã€Œè…³æœ¬åç¨±ã€ä¹Ÿæ‡‰ç›´æ¥é€£çµåˆ°è©²è…³æœ¬çš„ç·¨è¼¯é é¢ã€‚
3.  **æ™ºæ…§åŒ–å¿«é€Ÿç¯©é¸å™¨**ï¼š
    *   é™¤äº†æ™‚é–“å’Œé—œéµå­—ï¼Œæ‡‰åœ¨æœå°‹æ¡†æ—æä¾›ä¸€çµ„**é è¨­çš„å¿«é€Ÿç¯©é¸æŒ‰éˆ•**ï¼Œå¦‚ï¼šã€Œ**åƒ…é¡¯ç¤ºå¤±æ•—çš„**ã€ã€ã€Œ**éå» 1 å°æ™‚å…§**ã€ã€ã€Œ**ç”±æˆ‘è§¸ç™¼çš„**ã€ã€‚é€™èƒ½æ¥µå¤§æå‡æ—¥å¸¸æ’éŒ¯æ•ˆç‡ã€‚

---

## 6.è¨­å®š-èº«ä»½èˆ‡å­˜å–ç®¡ç†


### èº«ä»½èˆ‡å­˜å–ç®¡ç†

#### äººå“¡ç®¡ç† [äººå“¡ç®¡ç†](images/60-é é¢-äººå“¡ç®¡ç†.png)

**åŠŸèƒ½æè¿°**ï¼š
- ä½œç‚º Keycloak çš„ä»£ç†ï¼Œæä¾›ä¸€å€‹ç®¡ç†å¹³å°å…§éƒ¨è§’è‰²èˆ‡åœ˜éšŠæ˜ å°„çš„ä»‹é¢ã€‚
- é¡¯ç¤ºå¾ Keycloak åŒæ­¥çš„äººå“¡åˆ—è¡¨ï¼Œä¸¦é™„åŠ å…¶åœ¨æœ¬å¹³å°å…§çš„æ¬Šé™è¨­å®šã€‚
- æä¾›é‚€è«‹æ–°äººå“¡ã€ç®¡ç†å¹³å°å…§ç‹€æ…‹ã€ä»¥åŠåˆ†é…åœ˜éšŠå’Œè§’è‰²çš„åŠŸèƒ½ã€‚
- KPI é¢æ¿é¡¯ç¤ºå¾ Keycloak ç²å–çš„çµ±è¨ˆæ•¸æ“šï¼Œå¦‚ç¸½äººæ•¸ã€åœ¨ç·šäººæ•¸å’Œå¾…è™•ç†é‚€è«‹ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢èˆ‡å…¶ç·¨è¼¯å½ˆçª— (`images/65-å½ˆçª—-äººå“¡ç®¡ç†-ç·¨è¼¯äººå“¡.png`)ã€‚æ ¹æ“š `docs/architecture.md` çš„è¦å®šï¼Œèº«ä»½ç®¡ç†å·²å®Œå…¨å§”è¨—çµ¦ Keycloakã€‚å› æ­¤ï¼Œæ­¤åŠŸèƒ½çš„è¨­è¨ˆå¿…é ˆå¾ã€Œäººå“¡ç®¡ç†ç³»çµ±ã€è½‰è®Šç‚ºã€Œ**Keycloak ä»£ç†èˆ‡æ¬Šé™æ˜ å°„ä»‹é¢**ã€ã€‚ç›®å‰çš„ UI å’Œ API è¨­è¨ˆèˆ‡æ­¤æ¶æ§‹å­˜åœ¨è¡çªï¼Œéœ€é€²è¡Œä»¥ä¸‹æ·±åº¦é‡æ§‹ï¼š

**æ ¸å¿ƒåŸå‰‡ï¼šè·è²¬åˆ†é›¢**
- **Keycloak (SSO Provider)**ï¼šå”¯ä¸€è² è²¬äººå“¡çš„ç”Ÿå‘½é€±æœŸï¼ˆå»ºç«‹ã€åˆªé™¤ï¼‰ã€åŸºæœ¬è³‡æ–™ï¼ˆå§“åã€Emailï¼‰ã€æ†‘è­‰ç®¡ç†å’Œå¸³è™Ÿç‹€æ…‹ï¼ˆå•Ÿç”¨/åœç”¨ï¼‰ã€‚
- **SRE å¹³å°**ï¼šå”¯ä¸€è² è²¬å°‡ Keycloak ä½¿ç”¨è€…æ˜ å°„åˆ°å¹³å°å…§éƒ¨çš„**åœ˜éšŠ (Teams)** å’Œ**è§’è‰² (Roles)**ã€‚

**API é‡æ§‹ (ä»£ç† Keycloak)**
1.  **`GET /api/v1/users`**ï¼šæ­¤ API æ‡‰ä½œç‚º Keycloak `GET /admin/realms/{realm}/users` çš„ä»£ç†ã€‚å¾Œç«¯å¾ Keycloak ç²å–ä½¿ç”¨è€…åˆ—è¡¨å¾Œï¼Œæ‡‰ä½¿ç”¨æœ¬åœ°è³‡æ–™åº«çš„è³‡è¨Šä¾†**è±å¯Œ (enrich)** æ¯å€‹ä½¿ç”¨è€…ç‰©ä»¶ï¼Œé™„åŠ å…¶ `teams` å’Œ `roles` è³‡è¨Šã€‚
2.  **å»¢æ£„ `POST /api/v1/users`**ï¼šç›´æ¥åœ¨å¹³å°å»ºç«‹ä½¿ç”¨è€…çš„åŠŸèƒ½æ‡‰è¢«ç§»é™¤ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ä¸€å€‹**é‚€è«‹æµç¨‹**ï¼š
    *   **`POST /api/v1/invitations`**ï¼šæ¥æ”¶ `email`, `first_name`, `last_name`ã€‚å¾Œç«¯å‘¼å« Keycloak Admin API å»ºç«‹ä¸€å€‹æ–°ä½¿ç”¨è€…ï¼Œä¸¦è§¸ç™¼ Keycloak çš„ `execute-actions-email` æµç¨‹ï¼Œå‘ä½¿ç”¨è€…ç™¼é€è¨­å®šå¯†ç¢¼çš„é‚€è«‹éƒµä»¶ã€‚
3.  **é‡æ§‹ `PUT /api/v1/users/{id}`**ï¼šæ­¤ API çš„æ¬Šé™å¿…é ˆè¢«åš´æ ¼é™åˆ¶ã€‚å®ƒ**åªèƒ½**æ›´æ–°å¹³å°è³‡æ–™åº«ä¸­çš„ `team_ids` å’Œ `role_ids` æ˜ å°„é—œä¿‚ã€‚ä»»ä½•ä¿®æ”¹ `name` æˆ– `email` çš„å˜—è©¦éƒ½æ‡‰è¢«æ‹’çµ•ã€‚
4.  **é‡æ¸… `PUT /api/v1/users/{id}/toggle` çš„è·è²¬**ï¼š
    *   UI ä¸Šçš„ã€Œå•Ÿç”¨ã€é–‹é—œä¸èƒ½ç›´æ¥æ“ä½œ Keycloak çš„ `enabled` ç‹€æ…‹ã€‚é€™é•åäº†è·è²¬åˆ†é›¢åŸå‰‡ã€‚
    *   æ­¤ API æ‡‰æ›´åç‚º **`PUT /api/v1/users/{id}/internal-status`**ï¼Œå®ƒåƒ…æ›´æ–°å¹³å°è³‡æ–™åº«ä¸­ `users` è¡¨çš„ `is_active` æ¬„ä½ã€‚æ­¤æ¬„ä½ç”¨æ–¼æ§åˆ¶å¹³å°å…§éƒ¨çš„æ¥­å‹™é‚è¼¯ï¼ˆå¦‚æ˜¯å¦å¯è¢«æŒ‡æ´¾ä»»å‹™ï¼‰ï¼Œè€Œéç™»å…¥æ¬Šé™ã€‚
5.  **å»¢æ£„ `DELETE /api/v1/users/{id}`**ï¼šæ‡‰æ”¹ç‚º**è»Ÿåˆªé™¤ (Soft Delete)**ã€‚æ­¤æ“ä½œåƒ…åœ¨å¹³å°è³‡æ–™åº«ä¸­è¨­å®š `deleted_at` æ™‚é–“æˆ³ï¼Œä»¥ä¿è­‰æ­·å²è³‡æ–™çš„å®Œæ•´æ€§ã€‚å¯é¸æ“‡æ€§åœ°åœ¨ Keycloak ä¸­å°‡ä½¿ç”¨è€…è¨­ç‚ºéæ´»èºç‹€æ…‹ï¼Œä½†ä¸æ‡‰ç›´æ¥åˆªé™¤ã€‚

**UX/UI é‡æ§‹**
1.  **ã€Œæ–°å¢äººå“¡ã€æ”¹ç‚ºã€Œé‚€è«‹äººå“¡ã€**ï¼šä¸»é é¢ä¸Šçš„ã€Œ+ æ–°å¢äººå“¡ã€æŒ‰éˆ•æ‡‰æ”¹ç‚ºã€Œ**é‚€è«‹äººå“¡**ã€ã€‚å½ˆå‡ºçš„å°è©±æ¡†åªæ‡‰åŒ…å« Emailã€å§“ã€åç­‰æœ€åŸºæœ¬è³‡è¨Šï¼Œä¸æ‡‰åŒ…å«å¯†ç¢¼æ¬„ä½ã€‚
2.  **ä½¿ç”¨è€…è³‡è¨Šå”¯è®€**ï¼šåœ¨ã€Œäººå“¡åˆ—è¡¨ã€å’Œã€Œç·¨è¼¯äººå“¡ã€å½ˆçª—ä¸­ï¼Œ**å§“å**å’Œ**é›»å­éƒµä»¶**æ¬„ä½å¿…é ˆæ˜¯**å”¯è®€**çš„ï¼Œä¸¦æ˜ç¢ºæ¨™ç¤ºå…¶è³‡æ–™ä¾†æºç‚º SSO ç³»çµ±ã€‚
3.  **é‡æ–°å®šç¾©ã€Œå•Ÿç”¨ã€é–‹é—œ**ï¼š
    *   è¡¨æ ¼ä¸­çš„ã€Œå•Ÿç”¨ã€é–‹é—œæ‡‰æ”¹åç‚ºã€Œ**å¹³å°å…§å•Ÿç”¨**ã€ã€‚
    *   å¿…é ˆç‚ºæ­¤é–‹é—œæä¾›ä¸€å€‹å·¥å…·æç¤º (Tooltip)ï¼Œè§£é‡‹å…¶ä½œç”¨ï¼šã€Œ**åœç”¨å¾Œï¼Œæ­¤ä½¿ç”¨è€…å°‡ç„¡æ³•è¢«æŒ‡æ´¾ä»»å‹™æˆ–æ¥æ”¶é€šçŸ¥ï¼Œä½†å…¶ SSO å¸³è™Ÿä¸å—å½±éŸ¿ï¼Œä»å¯ç™»å…¥å¹³å°ã€‚**ã€
4.  **ç°¡åŒ–ã€Œç·¨è¼¯äººå“¡ã€å½ˆçª—**ï¼šæ­¤å½ˆçª— (`images/65...`) çš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼ã€Œ**æ¬Šé™è¨­å®š**ã€ã€‚æ‡‰å°‡å”¯è®€çš„ã€ŒåŸºæœ¬è³‡è¨Šã€æ”¾åœ¨é ‚éƒ¨ï¼Œä¸¦å°‡è¦–è¦ºç„¦é»å’Œä¸»è¦äº’å‹•å€åŸŸé›†ä¸­åœ¨ã€Œæ‰€å±¬åœ˜éšŠã€å’Œã€Œè§’è‰²ã€çš„åˆ†é…ä¸Šã€‚

#### ç·¨è¼¯äººå“¡ [ç·¨è¼¯äººå“¡](images/65-å½ˆçª—-äººå“¡ç®¡ç†-ç·¨è¼¯äººå“¡.png)

**åŠŸèƒ½æè¿°**ï¼š
- ä¿®æ”¹äººå“¡åœ¨å¹³å°å…§éƒ¨çš„æ¬Šé™è¨­å®šã€‚
- é¡¯ç¤ºå¾ Keycloak åŒæ­¥çš„å”¯è®€åŸºæœ¬è³‡è¨Šï¼ˆå§“åã€Emailï¼‰ã€‚
- æä¾›ä»‹é¢ä¾†ç®¡ç†ä½¿ç”¨è€…æ‰€å±¬çš„åœ˜éšŠå’Œåˆ†é…çš„è§’è‰²ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/users/{id}` - **ï¼ˆå·²é‡æ§‹ï¼‰** åƒ…æ›´æ–°ä½¿ç”¨è€…åœ¨å¹³å°å…§éƒ¨çš„åœ˜éšŠå’Œè§’è‰²æ˜ å°„ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **èšç„¦æ ¸å¿ƒåŠŸèƒ½**ï¼šå°‡ä»‹é¢ç„¦é»å®Œå…¨é›†ä¸­åœ¨åœ˜éšŠå’Œè§’è‰²çš„é¸æ“‡ä¸Šï¼Œå¼±åŒ–å”¯è®€çš„ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šã€‚
2. **æ¬Šé™é è¦½**ï¼šåœ¨å„²å­˜å‰ï¼Œå¯ä»¥é è¦½è®Šæ›´å¾Œçš„æ¬Šé™çµ„åˆå°‡å¸¶ä¾†å“ªäº›å…·é«”çš„æ¬Šé™è®ŠåŒ–ã€‚
3. **æ‰¹æ¬¡æŒ‡æ´¾**ï¼šåœ¨äººå“¡ç®¡ç†ä¸»åˆ—è¡¨ä¸Šï¼Œæ‡‰æ”¯æ´æ‰¹æ¬¡å°‡å¤šä½ä½¿ç”¨è€…æ–°å¢è‡³åŒä¸€å€‹åœ˜éšŠæˆ–æŒ‡æ´¾åŒä¸€å€‹è§’è‰²ã€‚
4. **æ¸…æ™°çš„è³‡æ–™ä¾†æºæ¨™ç¤º**ï¼šåœ¨å§“åå’Œ Email æ¬„ä½æ—ï¼Œå¯å¢åŠ ä¸€å€‹å°çš„è³‡è¨Šåœ–ç¤ºï¼Œæç¤ºä½¿ç”¨è€…ã€Œæ­¤è³‡è¨Šç”±èº«ä»½æä¾›å•†ç®¡ç†ã€ã€‚




#### è¨­å®šé é¢ [è¨­å®šé é¢](images/64-é é¢-è¨­å®š.png)

**åŠŸèƒ½æè¿°**ï¼š
- ä½œç‚ºæ‰€æœ‰ç®¡ç†åŠŸèƒ½çš„çµ±ä¸€å…¥å£é é¢ (Launchpad)ã€‚
- ä½¿ç”¨å¡ç‰‡å¼è¨­è¨ˆï¼Œå°‡å„é …è¨­å®šåŠŸèƒ½é‚è¼¯åœ°åˆ†çµ„ï¼Œå¦‚ã€Œèº«ä»½èˆ‡å­˜å–ç®¡ç†ã€ã€ã€Œé€šçŸ¥ç®¡ç†ã€å’Œã€Œå¹³å°è¨­å®šã€ã€‚
- ç‚ºç®¡ç†è€…æä¾›æ¸…æ™°çš„å°èˆªï¼Œå¿«é€Ÿé€²å…¥ç‰¹å®šçš„è¨­å®šæ¨¡çµ„ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æ­¤è¨­å®šé é¢çš„è¨­è¨ˆæ¸…æ™°ã€ç›´è§€ï¼Œä½œç‚ºä¸€å€‹ã€Œæ§åˆ¶å°ç¸½è¦½ã€éå¸¸æœ‰æ•ˆã€‚æˆ‘çš„å»ºè­°å°‡å°ˆæ³¨æ–¼å¦‚ä½•è®“é€™å€‹éœæ…‹çš„å°èˆªé é¢è®Šå¾—æ›´**æ™ºæ…§**ã€æ›´**å‹•æ…‹**ã€‚

**æ ¸å¿ƒåŸå‰‡ï¼šæƒ…å¢ƒæ„ŸçŸ¥èˆ‡è³‡è¨Šå¯†åº¦ (Context-Aware & Information-Dense)**
- æ­¤é é¢ä¸åƒ…æ‡‰æ˜¯é€£çµçš„é›†åˆï¼Œæ›´æ‡‰æä¾›ä¸€å€‹é—œæ–¼å¹³å°å¥åº·åº¦å’Œè¨­å®šç‹€æ…‹çš„å¾®å‹å„€è¡¨æ¿ã€‚

**API è¨­è¨ˆ**
1.  **æ•´åˆçš„çµ±è¨ˆ API**ï¼šç‚ºäº†è®“é é¢å‹•æ…‹åŒ–ï¼Œå¾Œç«¯æ‡‰æä¾›ä¸€å€‹å–®ä¸€çš„ã€é«˜æ•ˆèƒ½çš„çµ±è¨ˆ API ç«¯é»ã€‚æ­¤ç«¯é»æ‡‰å›å‚³æ‰€æœ‰å¡ç‰‡å¯èƒ½éœ€è¦çš„è¨ˆæ•¸ï¼Œä¸”å…¶å¾Œç«¯å¯¦ç¾æ‡‰å¤§é‡ä¾è³´**å¿«å–**ï¼Œä»¥ç¢ºä¿é é¢èƒ½ç¬æ™‚è¼‰å…¥ã€‚
    *   **`GET /api/v1/settings/statistics`**
        ```json
        {
          "iam": { "user_count": 156, "team_count": 12, "role_count": 8 },
          "notifications": { "policy_count": 25, "channel_count": 5 },
          "platform": { "tag_count": 50 }
        }
        ```

**UX/UI å¼·åŒ–**
1.  **åŸºæ–¼è§’è‰²çš„å¯è¦‹æ€§ (Role-Based Visibility)**ï¼šé€™æ˜¯æœ€é‡è¦çš„å®‰å…¨èˆ‡é«”é©—å¼·åŒ–ã€‚ä½¿ç”¨è€…åœ¨æ­¤é é¢ä¸Šçœ‹åˆ°çš„å¡ç‰‡ï¼Œæ‡‰åš´æ ¼**åŸºæ–¼å…¶è‡ªèº«è§’è‰²æ‰€æ“æœ‰çš„æ¬Šé™**ã€‚ä¾‹å¦‚ï¼Œä¸€å€‹æ²’æœ‰ã€Œå¹³å°è¨­å®šã€ç®¡ç†æ¬Šé™çš„è§’è‰²ï¼Œç™»å…¥å¾Œæ ¹æœ¬ä¸æ‡‰çœ‹åˆ°ã€Œå¹³å°è¨­å®šã€é‚£ä¸€å€å¡Šçš„æ‰€æœ‰å¡ç‰‡ã€‚é€™å¯ä»¥åœ¨å‰ç«¯æ ¹æ“šç™»å…¥æ™‚ç²å–çš„æ¬Šé™åˆ—è¡¨ï¼Œå‹•æ…‹æ¸²æŸ“å¡ç‰‡ä¾†å¯¦ç¾ã€‚
2.  **å‹•æ…‹å‰¯æ¨™é¡Œ (Dynamic Subtitles)**ï¼šå°‡å¡ç‰‡ä¸Šéœæ…‹çš„æè¿°æ–‡å­—ï¼Œæ›¿æ›ç‚ºå‹•æ…‹çš„ã€åŒ…å«é—œéµæŒ‡æ¨™çš„å‰¯æ¨™é¡Œã€‚
    *   ã€Œäººå“¡ç®¡ç†ã€å¡ç‰‡çš„å‰¯æ¨™é¡Œå¯ä»¥å¾ã€Œç®¡ç†ä½¿ç”¨è€…å¸³è™Ÿèˆ‡æ¬Šé™ã€è®Šç‚ºã€Œ**156** ä½ä½¿ç”¨è€… Â· **8** å€‹è§’è‰²ã€ã€‚
    *   ã€Œé€šçŸ¥ç­–ç•¥ã€å¡ç‰‡çš„å‰¯æ¨™é¡Œå¯ä»¥è®Šç‚ºã€Œ**25** æ¢ç­–ç•¥ Â· **5** å€‹é€šçŸ¥ç®¡é“ã€ã€‚
    é€™å°‡ä½¿é é¢ä¸€ç›®äº†ç„¶ï¼Œæ¥µå¤§æå‡è³‡è¨Šå¯†åº¦ã€‚
3.  **ã€Œæ–°åŠŸèƒ½ã€æç¤ºå¾½ç« **ï¼šç•¶æŸå€‹è¨­å®šæ¨¡çµ„å¢åŠ äº†é‡è¦æ–°åŠŸèƒ½æ™‚ï¼ˆä¾‹å¦‚ï¼Œã€Œè§’è‰²ç®¡ç†ã€å¢åŠ äº†ã€Œè¤‡è£½è§’è‰²ã€åŠŸèƒ½ï¼‰ï¼Œå¯ä»¥åœ¨å°æ‡‰çš„å¡ç‰‡å³ä¸Šè§’å¢åŠ ä¸€å€‹å°å°çš„ã€Œ**æ–°**ã€å­—å¾½ç« ã€‚é€™æ˜¯ä¸€ç¨®éå¸¸æœ‰æ•ˆçš„ã€éä¾µå…¥å¼çš„æ–¹å¼ï¼Œç”¨ä»¥å¼•å°ä½¿ç”¨è€…ç™¼ç¾ç”¢å“çš„æ”¹é€²ã€‚

#### åœ˜éšŠç®¡ç† [åœ˜éšŠç®¡ç†](images/61-é é¢-åœ˜éšŠç®¡ç†.png)

**åŠŸèƒ½æè¿°**ï¼š
- ç®¡ç†å¹³å°å…§éƒ¨çš„åœ˜éšŠï¼Œé€™äº›åœ˜éšŠæ˜¯å•è²¬åˆ¶å’Œé€šè¨Šçš„æ ¸å¿ƒå–®ä½ã€‚
- æ¯å€‹åœ˜éšŠç”±ä¸€çµ„æ ¸å¿ƒæˆå“¡ã€ä¸€å€‹è² è²¬äººä»¥åŠä¸€çµ„å¯é¸çš„è¨‚é–±è€…çµ„æˆã€‚
- æ­¤ä»‹é¢ç”¨æ–¼å»ºç«‹åœ˜éšŠã€ç®¡ç†å…¶æˆå“¡ï¼Œä¸¦ä½œç‚ºæª¢è¦–åœ˜éšŠè·è²¬ï¼ˆå¦‚è² è²¬çš„è³‡æºã€é—œè¯çš„é€šçŸ¥ï¼‰çš„å…¥å£ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢èˆ‡å…¶ç·¨è¼¯å½ˆçª— (`images/66-å½ˆçª—-åœ˜éšŠç®¡ç†-ç·¨è¼¯åœ˜éšŠ.png`)ã€‚æ ¹æ“š `docs/architecture.md` ä¸­çš„ã€Œæ¬Šè²¬åˆ†é›¢åŸå‰‡ã€ï¼Œã€Œåœ˜éšŠã€æ˜¯é€£æ¥**ä½¿ç”¨è€…**ã€**è³‡æº**å’Œ**é€šçŸ¥**çš„é—œéµæ¨ç´ã€‚æ­¤åŠŸèƒ½çš„è¨­è¨ˆæ‡‰å¼·åŒ–å…¶ä½œç‚ºã€Œå•è²¬ä¸­å¿ƒã€çš„è§’è‰²ï¼Œè€Œä¸åƒ…åƒ…æ˜¯ä½¿ç”¨è€…åˆ†çµ„ã€‚

**æ ¸å¿ƒåŸå‰‡ï¼šåœ˜éšŠå³å•è²¬ (Team as Accountability)**
- åœ˜éšŠæ˜¯å¹³å°å…§è³‡æºï¼ˆé€éã€Œè³‡æºç¾¤çµ„ã€ï¼‰å’Œè­¦å ±ï¼ˆé€éã€Œé€šçŸ¥ç­–ç•¥ã€ï¼‰çš„æŒ‡å®šæ¥æ”¶è€…ã€‚
- åœ˜éšŠæ‡‰å…·å‚™æ˜ç¢ºçš„ã€Œè² è²¬äººã€ï¼Œä»¥åŠã€Œæˆå“¡ã€å’Œã€Œè¨‚é–±è€…ã€å…©ç¨®ä¸åŒå±¤ç´šçš„åƒèˆ‡è€…ã€‚

**API è¨­è¨ˆèˆ‡è³‡æ–™æ¨¡å‹**
1.  **`teams` è³‡æ–™æ¨¡å‹**ï¼šå¾Œç«¯ `teams` è¡¨æ‡‰åŒ…å« `name`, `description`, `leader_id` (å¤–éµé—œè¯è‡³ `users`)ã€‚
2.  **æˆå“¡ vs. è¨‚é–±è€…**ï¼š
    *   **æˆå“¡ (Members)**ï¼šé€é `user_teams` å¤šå°å¤šé—œè¯è¡¨é€²è¡Œç®¡ç†ã€‚ä»–å€‘æ˜¯åœ˜éšŠçš„æ ¸å¿ƒåŸ·è¡Œè€…ã€‚
    *   **è¨‚é–±è€… (Subscribers)**ï¼šä¸€å€‹éå¸¸æœ‰åƒ¹å€¼çš„æ¦‚å¿µã€‚æ‡‰é€éç¨ç«‹çš„ `team_subscribers` å¤šå°å¤šé—œè¯è¡¨ä¾†ç®¡ç†ã€‚è¨‚é–±è€…å¯ä»¥æ˜¯å¹³å°å…§çš„ä½¿ç”¨è€…ï¼Œç”šè‡³æ˜¯å¤–éƒ¨éƒµä»¶åœ°å€ï¼Œä»–å€‘åƒ…æ¥æ”¶é€šçŸ¥ï¼Œä¸åƒèˆ‡ç›´æ¥æ“ä½œã€‚
3.  **API ç«¯é»**ï¼š
    *   `GET /api/v1/teams`ï¼šå›å‚³çš„åœ˜éšŠåˆ—è¡¨ç‰©ä»¶ä¸­ï¼Œæ‡‰åŒ…å« `leader` çš„è©³ç´°è³‡è¨Šä»¥åŠ `member_count` å’Œ `subscriber_count`ã€‚
    *   `GET /api/v1/teams/{id}`ï¼šé™¤äº†åœ˜éšŠåŸºæœ¬è³‡è¨Šï¼Œé‚„æ‡‰å›å‚³å®Œæ•´çš„ `members` å’Œ `subscribers` åˆ—è¡¨ã€‚
    *   `PUT /api/v1/teams/{id}`ï¼šè«‹æ±‚é«”æ‡‰å…è¨±åŒæ™‚æ›´æ–°åœ˜éšŠçš„åŸºæœ¬è³‡æ–™ï¼ˆ`name`, `leader_id`ï¼‰å’Œå®Œæ•´çš„ `member_ids` åˆ—è¡¨ã€‚å¾Œç«¯æ‡‰è² è²¬è¨ˆç®—å·®ç•°ä¸¦æ›´æ–° `user_teams` é—œè¯è¡¨ã€‚
    *   **`GET /api/v1/teams/{id}/responsibilities`** (å»ºè­°æ–°å¢)ï¼šä¸€å€‹æ–°çš„å”¯è®€ç«¯é»ï¼Œç”¨æ–¼å›å‚³èˆ‡è©²åœ˜éšŠé—œè¯çš„æ‰€æœ‰ç‰©ä»¶ï¼Œå¦‚ `resource_groups` å’Œ `notification_policies`ï¼Œç‚ºåœ˜éšŠè©³æƒ…é æä¾›è³‡æ–™ã€‚

**UX/UI å¼·åŒ–**
1.  **å¾ã€Œåˆ—è¡¨ã€åˆ°ã€Œå„€è¡¨æ¿ã€**ï¼šç›®å‰é é¢æ˜¯ä¸€å€‹ç°¡å–®çš„åˆ—è¡¨ã€‚é•·é ä¾†çœ‹ï¼Œæ‡‰è€ƒæ…®å°‡å…¶å‡ç´šç‚ºã€Œåœ˜éšŠå„€è¡¨æ¿ã€ã€‚é»æ“Šä¸€å€‹åœ˜éšŠæ‡‰é€²å…¥ä¸€å€‹**å°ˆå±¬çš„åœ˜éšŠè©³æƒ…é **ï¼Œè©²é é¢èšåˆé¡¯ç¤ºï¼š
    *   åœ˜éšŠæˆå“¡ã€è² è²¬äººã€è¨‚é–±è€…ã€‚
    *   **åœ˜éšŠè² è²¬çš„è³‡æºç¾¤çµ„**åˆ—è¡¨ã€‚
    *   **é—œè¯çš„é€šçŸ¥ç­–ç•¥**å’ŒéœéŸ³è¦å‰‡ã€‚
    *   ï¼ˆé€²éšï¼‰èˆ‡ Grafana OnCall æ•´åˆçš„**ç›®å‰å€¼ç­è¡¨**ã€‚
    é€™å°‡æ¥µå¤§åœ°æå‡æ­¤åŠŸèƒ½åœ¨æ—¥å¸¸ç¶­é‹ä¸­çš„å¯¦ç”¨æ€§ã€‚
2.  **é‡æ¸…ã€Œæˆå“¡ã€èˆ‡ã€Œè¨‚é–±è€…ã€**ï¼šåœ¨ä¸»åˆ—è¡¨çš„æ¬„ä½æ¨™é¡Œä¸Šï¼Œç‚ºã€Œæˆå“¡æ•¸ã€å’Œã€Œè¨‚é–±è€…æ•¸ã€å¢åŠ å·¥å…·æç¤ºï¼Œè§£é‡‹å…¶å€åˆ¥ï¼šã€Œ**æˆå“¡**ï¼šè² è²¬æ­¤åœ˜éšŠè³‡æºçš„å·¥ç¨‹å¸«ã€‚**è¨‚é–±è€…**ï¼šåƒ…æ¥æ”¶æ­¤åœ˜éšŠç›¸é—œé€šçŸ¥çš„åˆ©å®³é—œä¿‚äººã€‚ã€
3.  **å„ªåŒ–ç·¨è¼¯å½ˆçª—**ï¼š
    *   ç·¨è¼¯å½ˆçª— (`images/66...`) ä¸­çš„ã€Œè² è²¬äººã€æ¬„ä½æ‡‰æ˜¯ä¸€å€‹å¯æœå°‹çš„ä½¿ç”¨è€…é¸æ“‡å™¨ã€‚
    *   ç”¨æ–¼æ–°å¢æˆå“¡çš„é›™æ¬„é¸æ“‡å™¨ï¼ˆTransfer å…ƒä»¶ï¼‰æ˜¯æœ‰æ•ˆçš„ã€‚ç‚ºæå‡æ•ˆç‡ï¼Œå·¦å´çš„ã€Œå¯ç”¨äººå“¡ã€åˆ—è¡¨æ‡‰æ”¯æ´æœå°‹å’Œç¯©é¸åŠŸèƒ½ã€‚

#### ç·¨è¼¯åœ˜éšŠ [ç·¨è¼¯åœ˜éšŠ](images/66-å½ˆçª—-åœ˜éšŠç®¡ç†-ç·¨è¼¯åœ˜éšŠ.png)

**åŠŸèƒ½æè¿°**ï¼š
- ä¿®æ”¹åœ˜éšŠçš„åŸºæœ¬è³‡è¨Šï¼ˆåç¨±ã€æè¿°ã€è² è²¬äººï¼‰ã€‚
- é€éé›™æ¬„é¸æ“‡å™¨ç®¡ç†åœ˜éšŠçš„æ ¸å¿ƒæˆå“¡ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/teams/{id}` - æ›´æ–°åœ˜éšŠè³‡è¨Šï¼ŒåŒ…æ‹¬å…¶æˆå“¡åˆ—è¡¨ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æˆå“¡æœå°‹**ï¼šåœ¨ã€Œå¯ç”¨äººå“¡ã€åˆ—è¡¨ä¸­å¢åŠ æœå°‹æ¡†ï¼Œä»¥ä¾¿åœ¨å¤§é‡ä½¿ç”¨è€…ä¸­å¿«é€Ÿæ‰¾åˆ°ç›®æ¨™æˆå“¡ã€‚
2. **è·è²¬é è¦½**ï¼šåœ¨å½ˆçª—ä¸­ï¼ˆå¯èƒ½æ˜¯ä¸€å€‹ç¨ç«‹çš„é ç±¤ï¼‰ï¼Œå¯ä»¥é è¦½æ­¤åœ˜éšŠç›®å‰è² è²¬çš„è³‡æºç¾¤çµ„å’Œé—œè¯çš„é€šçŸ¥ç­–ç•¥ï¼Œè®“ç®¡ç†è€…åœ¨èª¿æ•´æˆå“¡æ™‚èƒ½äº†è§£å…¶å½±éŸ¿ç¯„åœã€‚
3. **è² è²¬äººæŒ‡æ´¾**ï¼šè² è²¬äººæ‡‰å¾åœ˜éšŠçš„ç¾æœ‰æˆå“¡ä¸­é¸æ“‡ï¼Œæˆ–åœ¨é¸æ“‡å¾Œè‡ªå‹•åŠ å…¥æˆç‚ºæˆå“¡ã€‚

#### è§’è‰²ç®¡ç† [è§’è‰²ç®¡ç†](images/62-é é¢-è§’è‰²ç®¡ç†.png)

**åŠŸèƒ½æè¿°**ï¼š
- é›†ä¸­ç®¡ç†å¹³å°çš„æ‰€æœ‰è§’è‰² (Role) åŠå…¶å°æ‡‰çš„æ¬Šé™ (Permissions)ã€‚
- æä¾›æ¸…æ™°çš„ä»‹é¢ä¾†å»ºç«‹ã€æª¢è¦–ã€ç·¨è¼¯å’Œåˆªé™¤è‡ªè¨‚è§’è‰²ã€‚
- ä»¥æ¨¹ç‹€çµæ§‹å±•ç¤ºæ‰€æœ‰å¯ç”¨çš„æ¬Šé™ï¼Œä¸¦æŒ‰åŠŸèƒ½æ¨¡çµ„é€²è¡Œåˆ†çµ„ï¼Œæ–¹ä¾¿ç®¡ç†è€…é€²è¡Œæ¬Šé™åˆ†é…ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢èˆ‡å…¶æ–°å¢å½ˆçª— (`images/67-å½ˆçª—-è§’è‰²ç®¡ç†-æ–°å¢è§’è‰².png`)ã€‚é€™æ˜¯ä¸€å€‹è¨­è¨ˆå¾—éå¸¸å‡ºè‰²çš„ RBAC (Role-Based Access Control) ç®¡ç†ä»‹é¢ï¼Œç›´è§€ä¸”éµå¾ªäº†æ¥­ç•Œçš„æœ€ä½³å¯¦è¸ã€‚æˆ‘çš„åˆ†æå°‡å°ˆæ³¨æ–¼å¼·åŒ–å…¶å¾Œç«¯å¯¦ç¾çš„**ç©©å¥æ€§**å’Œ**å¯ç¶­è­·æ€§**ï¼Œä¸¦æå‡ºé€²ä¸€æ­¥æå‡ä½¿ç”¨è€…é«”é©—çš„å»ºè­°ã€‚

**æ ¸å¿ƒåŸå‰‡ï¼šæ¬Šé™å³ç¨‹å¼ç¢¼ (Permissions as Code)**
- è§’è‰²æ˜¯æ¬Šé™çš„é›†åˆï¼Œè€Œæ¬Šé™æœ¬èº«æ‡‰è©²æ˜¯æ˜ç¢ºä¸”ç©©å®šçš„ã€‚

**API è¨­è¨ˆèˆ‡å¾Œç«¯æ¶æ§‹**
1.  **æ¬Šé™çš„å–®ä¸€äº‹å¯¦ä¾†æº (SSOT)**ï¼šæ‰€æœ‰å¹³å°å…§å¯ç”¨çš„æ¬Šé™ï¼Œå…¶å®šç¾©çš„**å”¯ä¸€çœŸå¯¦ä¾†æº (Single Source of Truth)** æ‡‰è©²æ˜¯**å¾Œç«¯ç¨‹å¼ç¢¼**ä¸­çš„ä¸€å€‹éœæ…‹è¨­å®šæª”æˆ–åˆ—èˆ‰ã€‚é€™ç¢ºä¿äº†æ¬Šé™æ˜¯ç‰ˆæœ¬å¯æ§çš„ï¼Œä¸”ä¸æœƒåœ¨è³‡æ–™åº«ä¸­ç”¢ç”Ÿç„¡æ•ˆæˆ–å»¢æ£„çš„æ¬Šé™è³‡æ–™ã€‚
    *   **`GET /api/v1/permissions`**ï¼šå¾Œç«¯æ‡‰æä¾›æ­¤ç«¯é»ï¼Œå›å‚³åœ¨ç¨‹å¼ç¢¼ä¸­å®šç¾©å¥½çš„ã€çµæ§‹åŒ–çš„å®Œæ•´æ¬Šé™æ¨¹ï¼Œä¾›å‰ç«¯ UI å‹•æ…‹å»ºæ§‹æ¬Šé™å‹¾é¸æ¡†ã€‚
2.  **è³‡æ–™åº«æ¨¡å‹**ï¼š
    *   `roles` è¡¨ï¼šåŒ…å« `id`, `name`, `description`, `is_built_in` (å¸ƒæ—å€¼ï¼Œç”¨æ–¼æ¨™è­˜ä¸å¯åˆªé™¤çš„å…§å»ºè§’è‰²)ã€‚
    *   `role_permissions` é—œè¯è¡¨ï¼šåƒ…åŒ…å« `role_id` å’Œ `permission_key` (å­—ä¸²)ï¼Œç”¨æ–¼å„²å­˜è§’è‰²èˆ‡æ¬Šé™ç¢¼çš„å°æ‡‰é—œä¿‚ã€‚
3.  **API ç«¯é»**ï¼š
    *   `POST /api/v1/roles`ï¼šå»ºç«‹æ–°è§’è‰²ã€‚è«‹æ±‚é«”æ‡‰åŒ…å« `name`, `description` å’Œä¸€å€‹**æ¬Šé™ç¢¼çš„é™£åˆ—** (`permission_keys`)ã€‚
    *   `PUT /api/v1/roles/{id}`ï¼šæ›´æ–°è§’è‰²ã€‚å¾Œç«¯æ‡‰åš´æ ¼ç¦æ­¢ä¿®æ”¹ `is_built_in` ç‚º `true` çš„è§’è‰²ã€‚
    *   `DELETE /api/v1/roles/{id}`ï¼šåˆªé™¤è§’è‰²ã€‚åœ¨åˆªé™¤å‰ï¼Œå¾Œç«¯å¿…é ˆæª¢æŸ¥æ­¤è§’è‰²æ˜¯å¦å·²æŒ‡æ´¾çµ¦ä»»ä½•ä½¿ç”¨è€…ã€‚å¦‚æœå·²æŒ‡æ´¾ï¼Œæ‡‰å›å‚³éŒ¯èª¤ä¸¦æç¤ºç®¡ç†è€…å…ˆè§£é™¤æ‰€æœ‰ä½¿ç”¨è€…çš„æŒ‡æ´¾ã€‚

**UX/UI å¼·åŒ–**
1.  **æ¬Šé™èªªæ˜ (Permission Descriptions)**ï¼šåœ¨æ¬Šé™æ¨¹çš„æ¯å€‹å‹¾é¸æ¡†æ—ï¼Œå¢åŠ ä¸€å€‹**èªªæ˜åœ–ç¤º (i)**ã€‚æ»‘é¼ æ‡¸åœæ™‚ï¼Œé¡¯ç¤ºæ­¤æ¬Šé™çš„è©³ç´°è§£é‡‹ã€‚ä¾‹å¦‚ï¼Œã€Œå¯«å…¥äº‹ä»¶è¦å‰‡ã€çš„èªªæ˜å¯èƒ½æ˜¯ã€Œå…è¨±ä½¿ç”¨è€…å»ºç«‹æ–°è¦å‰‡ã€ä¿®æ”¹ç¾æœ‰è¦å‰‡çš„è§¸ç™¼æ¢ä»¶ã€å…§å®¹èˆ‡è‡ªå‹•åŒ–è¨­å®šã€ã€‚é€™èƒ½æ¶ˆé™¤æ­§ç¾©ï¼Œå¹«åŠ©ç®¡ç†è€…åšå‡ºæ›´ç²¾æº–çš„æˆæ¬Šã€‚
2.  **è§’è‰²ä½¿ç”¨è¨ˆæ•¸å™¨ (Role Usage Counter)**ï¼šåœ¨å·¦å´çš„è§’è‰²åˆ—è¡¨ (`images/62...`) ä¸­ï¼Œç‚ºæ¯å€‹è§’è‰²åç¨±æ—å¢åŠ ä¸€å€‹**å¾½ç«  (Badge)**ï¼Œé¡¯ç¤ºç›®å‰æœ‰å¤šå°‘ä½¿ç”¨è€…è¢«æŒ‡æ´¾äº†æ­¤è§’è‰²ã€‚é€™å°æ–¼è©•ä¼°ä¿®æ”¹æˆ–åˆªé™¤ä¸€å€‹è§’è‰²æ‰€å¸¶ä¾†çš„å½±éŸ¿è‡³é—œé‡è¦ã€‚é»æ“Šæ­¤å¾½ç« å¯å½ˆå‡ºä¸€å€‹å°è©±æ¡†ï¼Œé¡¯ç¤ºæ‰€æœ‰è¢«æŒ‡æ´¾æ­¤è§’è‰²çš„ä½¿ç”¨è€…åˆ—è¡¨ã€‚
3.  **è¤‡è£½è§’è‰² (Clone Role) åŠŸèƒ½**ï¼šåœ¨è§’è‰²åˆ—è¡¨ä¸Šæ–¹ï¼Œæ–°å¢ä¸€å€‹ã€Œ**è¤‡è£½è§’è‰²**ã€çš„æŒ‰éˆ•ã€‚é€™æ˜¯ä¸€å€‹å·¨å¤§çš„æ•ˆç‡æå‡åŠŸèƒ½ã€‚ç•¶ç®¡ç†è€…é¸æ“‡ä¸€å€‹ç¾æœ‰è§’è‰²ï¼ˆå¦‚ã€Œåœ˜éšŠç®¡ç†å“¡ã€ï¼‰ä¸¦é»æ“Šã€Œè¤‡è£½ã€æ™‚ï¼Œç³»çµ±æœƒæ‰“é–‹ã€Œæ–°å¢è§’è‰²ã€å½ˆçª—ï¼Œä¸¦é å…ˆå¡«å…¥æ‰€æœ‰è³‡è¨Šï¼ˆè§’è‰²åç¨±ç‚ºã€Œåœ˜éšŠç®¡ç†å“¡ (å‰¯æœ¬)ã€ï¼Œä¸¦å‹¾é¸æ‰€æœ‰ç›¸åŒçš„æ¬Šé™ï¼‰ï¼Œè®“ç®¡ç†è€…å¯ä»¥å¿«é€Ÿå¾®èª¿ä¸¦å»ºç«‹ä¸€å€‹æ–°è§’è‰²ã€‚
4.  **æ•´åˆå¯©è¨ˆæ—¥èªŒ**ï¼šæ‰€æœ‰å°è§’è‰²çš„æ“ä½œï¼ˆå»ºç«‹ã€æ›´æ–°ã€åˆªé™¤ï¼‰éƒ½å¿…é ˆç”¢ç”Ÿä¸€æ¢è©³ç´°çš„**å¯©è¨ˆæ—¥èªŒ**ã€‚æ—¥èªŒæ‡‰æ¸…æ¥šè¨˜éŒ„æ“ä½œå‰å¾Œçš„æ¬Šé™è®ŠåŒ–ï¼Œä»¥ä¾¿æ–¼å®‰å…¨å¯©è¨ˆå’Œè¿½æº¯ã€‚

#### æ–°å¢è§’è‰² [æ–°å¢è§’è‰²](images/67-å½ˆçª—-è§’è‰²ç®¡ç†-æ–°å¢è§’è‰².png)

**åŠŸèƒ½æè¿°**ï¼š
- æä¾›è¡¨å–®ä¾†å®šç¾©æ–°è§’è‰²çš„åç¨±ã€‚
- é€éæ¨¹ç‹€å‹¾é¸æ¡†ä¾†ç‚ºæ–°è§’è‰²æŒ‡æ´¾ä¸€çµ„æ¬Šé™ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `POST /api/v1/roles` - è«‹æ±‚é«”åŒ…å«è§’è‰²åç¨±å’Œä¸€çµ„æ¬Šé™ç¢¼ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ¬Šé™æœå°‹**ï¼šç•¶æ¬Šé™æ•¸é‡éå¸¸å¤šæ™‚ï¼Œåœ¨æ¬Šé™æ¨¹ä¸Šæ–¹å¢åŠ ä¸€å€‹æœå°‹æ¡†ï¼Œè®“ç®¡ç†è€…å¯ä»¥å¿«é€Ÿç¯©é¸å’Œå®šä½ç‰¹å®šçš„æ¬Šé™ã€‚
2. **ç¯„æœ¬åŒ–**ï¼šæä¾›å¹¾å€‹é è¨­çš„ã€Œè§’è‰²ç¯„æœ¬ã€ï¼ˆå¦‚å”¯è®€ä½¿ç”¨è€…ã€æ“ä½œè€…ï¼‰ï¼Œä½¿ç”¨è€…é¸æ“‡ç¯„æœ¬å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•å‹¾é¸ä¸€çµ„å»ºè­°çš„æ¬Šé™ï¼Œä½¿ç”¨è€…å¯åœ¨æ­¤åŸºç¤ä¸Šé€²è¡Œä¿®æ”¹ã€‚

#### å¯©è¨ˆæ—¥èªŒ [å¯©è¨ˆæ—¥èªŒ](images/63-é é¢-å¯©è¨ˆæ—¥èªŒ.png)

**åŠŸèƒ½æè¿°**ï¼š
- ä½œç‚ºå¹³å°ä¸å¯è®Šçš„ã€Œé»‘ç›’å­ã€ï¼Œè¨˜éŒ„æ‰€æœ‰ç”±ä½¿ç”¨è€…æˆ–ç³»çµ±åŸ·è¡Œçš„ç‹€æ…‹è®Šæ›´æ“ä½œã€‚
- æä¾›å¼·å¤§çš„æœå°‹èˆ‡ç¯©é¸åŠŸèƒ½ï¼Œä»¥ä¾¿é€²è¡Œå®‰å…¨å¯©è¨ˆã€æ•…éšœæ’é™¤å’Œåˆè¦æ€§æª¢æŸ¥ã€‚
- é¡¯ç¤ºçµæ§‹åŒ–çš„æ—¥èªŒåˆ—è¡¨ï¼Œä¸¦èƒ½é‘½å–æŸ¥çœ‹å–®æ¬¡æ“ä½œçš„å®Œæ•´ä¸Šä¸‹æ–‡èˆ‡è®Šæ›´å…§å®¹ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢èˆ‡å…¶æ—¥èªŒè©³æƒ…æŠ½å±œ (`images/68-æŠ½å±œ-å¯©è¨ˆæ—¥èªŒ-æ—¥èªŒè©³æƒ….png`)ã€‚å¯©è¨ˆæ—¥èªŒæ˜¯ä¼æ¥­ç´šå¹³å°çš„åŸºçŸ³ï¼Œå…¶æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼**å®Œæ•´æ€§ã€ä¸å¯è®Šæ€§èˆ‡å¯æœå°‹æ€§**ã€‚ç›®å‰çš„ UI æä¾›äº†è‰¯å¥½çš„åŸºç¤ï¼Œä½†å…¶å¾Œç«¯æ¶æ§‹å’Œè©³æƒ…å±•ç¤ºçš„æ·±åº¦éœ€è¦å¤§å¹…å¼·åŒ–ã€‚

**æ ¸å¿ƒåŸå‰‡ï¼šé‰…ç´°é¡éºï¼Œç„¡ä¸€éºæ¼ (Log Everything)**
- ä»»ä½•é€é API é€²è¡Œçš„å¯«å…¥å‹æ“ä½œ (CREATE, UPDATE, DELETE) éƒ½å¿…é ˆç”¢ç”Ÿä¸€æ¢å°æ‡‰çš„å¯©è¨ˆæ—¥èªŒã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è³‡æ–™æ¨¡å‹ (ä»¥ Elasticsearch ç‚ºæ ¸å¿ƒ)**
1.  **è³‡æ–™æµ**ï¼šæ‰€æœ‰å¾Œç«¯æœå‹™åœ¨åŸ·è¡Œå¯«å…¥æ“ä½œå¾Œï¼Œæ‡‰å°‡çµæ§‹åŒ–çš„å¯©è¨ˆäº‹ä»¶ç™¼å¸ƒåˆ°ä¸€å€‹**å°ˆç”¨çš„è¨Šæ¯ä½‡åˆ— (å¦‚ Kafka)**ã€‚ä¸€å€‹ç¨ç«‹çš„æ—¥èªŒæœå‹™æœƒæ¶ˆè²»é€™äº›äº‹ä»¶ï¼Œä¸¦å°‡å…¶å¯«å…¥ **Elasticsearch** ç´¢å¼•ä¸­ã€‚æ­¤éåŒæ­¥æ¶æ§‹ç¢ºä¿äº†æ¥­å‹™æœå‹™çš„ä½å»¶é²å’Œæ—¥èªŒç³»çµ±çš„é«˜å¯é æ€§ã€‚
2.  **è±å¯Œçš„æ—¥èªŒçµæ§‹**ï¼šå„²å­˜åœ¨ Elasticsearch ä¸­çš„æ¯ä¸€ä»½æ–‡ä»¶éƒ½å¿…é ˆæ˜¯é«˜åº¦çµæ§‹åŒ–çš„ï¼Œä»¥ä¾¿æ–¼é€²è¡Œè¤‡é›œæŸ¥è©¢ã€‚å…¶çµæ§‹æ‡‰è‡³å°‘åŒ…å«ï¼š
    ```json
    {
      "timestamp": "...",
      "actor": { "type": "user", "id": "...", "name": "...", "ip_address": "..." },
      "action": "UPDATE",
      "result": "SUCCESS",
      "resource": { "type": "AlertRule", "id": "...", "name": "..." },
      "change_context": { "reason": "...", "trace_id": "..." },
      "diff": {
        "old": { "threshold": "80" },
        "new": { "threshold": "85" }
      }
    }
    ```
3.  **API è¨­è¨ˆ**ï¼š
    *   `GET /api/v1/audit-logs`ï¼šæ­¤ API çš„å¾Œç«¯å¯¦ç¾**å¿…é ˆ**æ˜¯å°‡å‰ç«¯å‚³ä¾†çš„ç¯©é¸æ¢ä»¶ï¼ˆæ™‚é–“ç¯„åœã€ä½¿ç”¨è€…ã€å‹•ä½œé¡å‹ã€é—œéµå­—ï¼‰è½‰æ›ç‚ºä¸€å€‹ **Elasticsearch çš„æŸ¥è©¢ DSL**ï¼Œè€ŒéæŸ¥è©¢å‚³çµ±è³‡æ–™åº«ã€‚
    *   `GET /api/v1/audit-logs/{id}`ï¼šç›´æ¥å¾ Elasticsearch ä¸­ä¾æ“šæ–‡ä»¶ ID ç²å–å–®æ¢æ—¥èªŒçš„å®Œæ•´å…§å®¹ã€‚

**UX/UI å¼·åŒ–**
1.  **å±•ç¤ºã€Œè®Šæ›´äº†ä»€éº¼ã€**ï¼šé€™æ˜¯æœ€é‡è¦çš„æ”¹é€²ã€‚è©³æƒ…æŠ½å±œ (`images/68...`) ç›®å‰çš„è³‡è¨Šä¸è¶³ã€‚ç•¶ä½¿ç”¨è€…é»æ“Šä¸€æ¢ `UPDATE` é¡å‹çš„æ—¥èªŒæ™‚ï¼ŒæŠ½å±œå…§**å¿…é ˆ**æ¸²æŸ“ä¸€å€‹**è¦–è¦ºåŒ–çš„å·®ç•°å°æ¯” (Diff Viewer)**ï¼Œæ¸…æ¥šåœ°ä»¥ç´…ç¶ é«˜äº®æ¨™ç¤ºå‡ºæ¬„ä½ä¿®æ”¹å‰å’Œä¿®æ”¹å¾Œçš„å€¼ã€‚å°æ–¼ `CREATE` æˆ– `DELETE` æ“ä½œï¼Œå‰‡æ‡‰é¡¯ç¤ºè©²è³‡æºè¢«å»ºç«‹æˆ–åˆªé™¤æ™‚çš„å®Œæ•´è³‡æ–™å¿«ç…§ã€‚
2.  **è³¦äºˆæœå°‹æ¡†å¼·å¤§èƒ½åŠ›**ï¼šé é¢é ‚éƒ¨çš„æœå°‹æ¡†ä¸æ‡‰åªæœå°‹ä½¿ç”¨è€…ï¼Œè€Œæ‡‰æˆç‚ºä¸€å€‹**å…¨å±€æœå°‹æ¡†**ã€‚åˆ©ç”¨ Elasticsearch çš„èƒ½åŠ›ï¼Œå®ƒæ‡‰èƒ½å°æ—¥èªŒä¸­çš„ä»»ä½•æ¬„ä½é€²è¡Œå…¨æ–‡æª¢ç´¢ï¼ŒåŒ…æ‹¬ä½¿ç”¨è€…åç¨±ã€è³‡æºåç¨±ã€IP ä½å€ï¼Œç”šè‡³æ˜¯ `diff` å…§å®¹ä¸­çš„å€¼ã€‚
3.  **è¬ç‰©çš†å¯é€£çµ**ï¼š
    *   åœ¨æ—¥èªŒè¡¨æ ¼ä¸­ï¼Œã€Œæ“ä½œè€…ã€å’Œã€Œè³‡æºåç¨±ã€æ¬„ä½éƒ½æ‡‰è©²æ˜¯**å¯é»æ“Šçš„è¶…é€£çµ**ï¼Œåˆ†åˆ¥å°å‘è©²ä½¿ç”¨è€…çš„ç®¡ç†é é¢å’Œè©²è³‡æºçš„è©³æƒ…é ã€‚
    *   åä¹‹ï¼Œåœ¨æ¯å€‹è³‡æºçš„ç®¡ç†é é¢ï¼ˆå¦‚æŸå€‹ç‰¹å®šçš„äº‹ä»¶è¦å‰‡ï¼‰ï¼Œéƒ½æ‡‰æä¾›ä¸€å€‹ã€Œ**æª¢è¦–æ­·å²ç´€éŒ„**ã€çš„æŒ‰éˆ•ï¼Œé»æ“Šå¾Œç›´æ¥è·³è½‰åˆ°å¯©è¨ˆæ—¥èªŒé é¢ï¼Œä¸¦è‡ªå‹•ç¯©é¸å‡ºè©²è³‡æºçš„æ‰€æœ‰ç›¸é—œè®Šæ›´ç´€éŒ„ã€‚é€™æä¾›äº†é—œéµçš„**ä¸Šä¸‹æ–‡é‘½å– (Contextual Drill-Down)** èƒ½åŠ›ã€‚
4.  **åŒ¯å‡ºåŠŸèƒ½å„ªåŒ–**ï¼šåŒ¯å‡ºåŠŸèƒ½æ‡‰æ”¯æ´å°‡ç›®å‰çš„ç¯©é¸çµæœåŒ¯å‡ºç‚º CSV æˆ– JSON æ ¼å¼ï¼Œä»¥ä¾¿æ–¼é›¢ç·šåˆ†æå’Œæ­¸æª”ã€‚

#### æ—¥èªŒè©³æƒ… [æ—¥èªŒè©³æƒ…](images/68-æŠ½å±œ-å¯©è¨ˆæ—¥èªŒ-æ—¥èªŒè©³æƒ….png)

**åŠŸèƒ½æè¿°**ï¼š
- ä»¥æŠ½å±œå½¢å¼é¡¯ç¤ºå–®æ¢å¯©è¨ˆæ—¥èªŒçš„æ‘˜è¦è³‡è¨Šã€‚
- åŒ…å«æ“ä½œæ™‚é–“ã€æ“ä½œè€…ã€å‹•ä½œã€è³‡æºã€çµæœå’Œå¤±æ•—è¨Šæ¯ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/audit-logs/{id}` - ç²å–å–®æ¢æ—¥èªŒçš„å®Œæ•´è³‡æ–™ï¼Œç‰¹åˆ¥æ˜¯ `diff` éƒ¨åˆ†ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å·®ç•°è¦–è¦ºåŒ–**ï¼šå°æ–¼ `UPDATE` æ“ä½œï¼Œå¿…é ˆä»¥ä¸¦æ’æˆ–è¡Œå…§é«˜äº®çš„æ–¹å¼ï¼Œæ¸…æ™°åœ°å±•ç¤ºä¿®æ”¹å‰å¾Œçš„è³‡æ–™å·®ç•°ã€‚
2. **å®Œæ•´è³‡æ–™å¿«ç…§**ï¼šå°æ–¼ `CREATE` å’Œ `DELETE` æ“ä½œï¼Œæ‡‰é¡¯ç¤ºè³‡æºè¢«å»ºç«‹æˆ–åˆªé™¤æ™‚çš„å®Œæ•´ JSON è³‡æ–™ã€‚
3. **ä¸Šä¸‹æ–‡é€£çµ**ï¼šæä¾›å¿«é€Ÿé€£çµåˆ°æ“ä½œè€…å’Œè¢«æ“ä½œè³‡æºçš„è©³æƒ…é é¢ã€‚
4. **è¤‡è£½ Trace ID**ï¼šæä¾›ä¸€å€‹æŒ‰éˆ•ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥ä¸€éµè¤‡è£½èˆ‡æ­¤æ¬¡æ“ä½œé—œè¯çš„ OpenTelemetry Trace IDï¼Œä»¥ä¾¿åœ¨ç›£æ§ç³»çµ±ä¸­é€²è¡Œæ·±åº¦è¿½è¹¤ã€‚

## 7.è¨­å®š-é€šçŸ¥ç®¡ç†

### é€šçŸ¥ç®¡ç†

#### é€šçŸ¥ç­–ç•¥ [é€šçŸ¥ç­–ç•¥](images/70-é é¢-é€šçŸ¥ç­–ç•¥.png)

**åŠŸèƒ½æè¿°**ï¼š
- é€šçŸ¥è¦å‰‡é…ç½®ç®¡ç†
- é€šçŸ¥çµ±è¨ˆå’Œç™¼é€ç‹€æ…‹
- é€šçŸ¥ç­–ç•¥è¡¨æ ¼ï¼šç­–ç•¥åç¨±ã€è§¸ç™¼æ¢ä»¶ã€é€šçŸ¥ç®¡é“ã€æ¥æ”¶å°è±¡ã€ç‹€æ…‹
- ç­–ç•¥æ¸¬è©¦å’Œé è¦½åŠŸèƒ½

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/notification-policies` - ç²å–é€šçŸ¥ç­–ç•¥åˆ—è¡¨
- `POST /api/v1/notification-policies` - å‰µå»ºé€šçŸ¥ç­–ç•¥
- `PUT /api/v1/notification-policies/{id}` - æ›´æ–°é€šçŸ¥ç­–ç•¥
- `DELETE /api/v1/notification-policies/{id}` - åˆªé™¤é€šçŸ¥ç­–ç•¥

**UX æ”¹å–„å»ºè­°**ï¼š
1. **ç­–ç•¥æ¨¡æ“¬**ï¼šæä¾›ç­–ç•¥è§¸ç™¼æ¢ä»¶æ¨¡æ“¬æ¸¬è©¦
2. **é€šçŸ¥é è¦½**ï¼šé¡¯ç¤ºé€šçŸ¥å…§å®¹é è¦½
3. **ç­–ç•¥å„ªåŒ–**ï¼šåˆ†æå’Œå„ªåŒ–é€šçŸ¥ç­–ç•¥æ•ˆæœ
4. **å¤šç®¡é“æ•´åˆ**ï¼šæ”¯æ´å¤šç¨®é€šçŸ¥ç®¡é“çš„æ•´åˆé…ç½®
5. **æ™ºæ…§è·¯ç”±**ï¼šåŸºæ–¼æ¥æ”¶è€…åå¥½å’Œå¯ç”¨æ€§çš„æ™ºæ…§è·¯ç”±

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚æ­¤é é¢æ˜¯ SRE å¹³å°ä½œç‚º **Grafana æ™ºæ…§å‹æŠ½è±¡å±¤** çš„çµ•ä½³ç¯„ä¾‹ã€‚å®ƒæˆåŠŸåœ°å°‡ Grafana åŠŸèƒ½å¼·å¤§ä½†æ¥µå…¶è¤‡é›œã€åŸºæ–¼æ¨™ç±¤çš„æ¨¹ç‹€è·¯ç”±çµæ§‹ï¼Œè½‰åŒ–ç‚ºä¸€å€‹æ‰å¹³åŒ–ã€æ˜“æ–¼ç†è§£ä¸”æ›´ç¬¦åˆäººé¡å¿ƒæ™ºæ¨¡å‹çš„ç­–ç•¥åˆ—è¡¨ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**ï¼š
1.  **æ ¸å¿ƒè·è²¬ - ç¿»è­¯å±¤**ï¼šæœ¬å¹³å°å¾Œç«¯çš„æ ¸å¿ƒè·è²¬æ˜¯ä½œç‚ºä¸€å€‹**é›™å‘ç¿»è­¯å™¨**ã€‚
    *   **è®€å– (`GET`)**: å¾Œç«¯å‘¼å« Grafana çš„ `GET /api/v1/provisioning/policies` ç«¯é»ï¼Œç²å–å…¶å®Œæ•´çš„ã€å·¢ç‹€çš„è·¯ç”±æ¨¹ JSONã€‚ç„¶å¾Œï¼Œå®ƒå¿…é ˆ**è§£æ**é€™æ£µæ¨¹ï¼Œå°‡æ¯ä¸€æ¢è·¯ç”±åŠå…¶å­è·¯ç”±ã€Œæ‰å¹³åŒ–ã€ç‚ºä½¿ç”¨è€…åœ¨ UI ä¸Šçœ‹åˆ°çš„ä¸€è¡Œè¡Œç­–ç•¥ã€‚
    *   **å¯«å…¥ (`POST`/`PUT`)**: ç•¶ä½¿ç”¨è€…å»ºç«‹æˆ–æ›´æ–°ä¸€æ¢ç­–ç•¥æ™‚ï¼Œå¾Œç«¯æ¥æ”¶åˆ°çš„æ˜¯ä¸€å€‹ç°¡åŒ–çš„ã€æ‰å¹³çš„ç­–ç•¥ç‰©ä»¶ã€‚å®ƒå¿…é ˆæ ¹æ“šæ­¤ç‰©ä»¶ï¼Œ**é‡æ–°å»ºæ§‹**å‡º Grafana æ‰€è¦æ±‚çš„å®Œæ•´è·¯ç”±æ¨¹ JSONï¼Œç„¶å¾Œå†é€é `PUT /api/v1/provisioning/policies` é€²è¡Œå…¨é‡æ›´æ–°ã€‚
2.  **API è¨­è¨ˆ**ï¼š
    *   `GET /api/v1/notification-policies`ï¼šæ­¤ API å›å‚³çš„æ˜¯å¾Œç«¯ç¶“éç¿»è­¯å’Œæ‰å¹³åŒ–è™•ç†å¾Œçš„ç­–ç•¥åˆ—è¡¨ï¼Œè€Œé Grafana çš„åŸå§‹çµæ§‹ã€‚
    *   `GET /api/v1/notification-policies/statistics`ï¼šé ‚éƒ¨çš„ KPI æŒ‡æ¨™ï¼ˆå¦‚ã€Œä»Šæ—¥é€šçŸ¥é‡ã€ã€ã€Œé€é”ç‡ã€ï¼‰**å¿…é ˆ**ç”±ä¸€å€‹èƒŒæ™¯ä½œæ¥­ï¼Œé€éåˆ†æå¹³å°è‡ªèº«çš„ `notification_history` è¡¨ä¾†**é å…ˆè¨ˆç®—ä¸¦å¿«å–**åœ¨ Redis ä¸­ï¼Œä»¥ç¢ºä¿é é¢èƒ½å¿«é€Ÿè¼‰å…¥ã€‚
3.  **ã€Œç®¡é“å¥åº·æ¦‚è¦½ã€çš„å¯¦ç¾**ï¼šæ­¤é¢æ¿çš„æ•¸æ“šåŒæ¨£éœ€è¦ç”±èƒŒæ™¯ä½œæ¥­å®šæœŸï¼ˆä¾‹å¦‚æ¯ 5 åˆ†é˜ï¼‰æ›´æ–°ã€‚è©²ä½œæ¥­æœƒéæ­·æ‰€æœ‰å·²è¨­å®šçš„é€šçŸ¥ç®¡é“ï¼Œå‘¼å«å…¶ã€Œç™¼é€æ¸¬è©¦ã€APIï¼Œä¸¦å°‡æˆåŠŸç‡å’Œæœ€å¾Œæ¸¬è©¦æ™‚é–“ç­‰çµæœå„²å­˜èµ·ä¾†ï¼Œä¾›å‰ç«¯æŸ¥è©¢ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **ç­–ç•¥çš„è¦–è¦ºåŒ–å¼•å°**ï¼š
    *   ã€Œæ–°å¢é€šçŸ¥ç­–ç•¥ã€æŒ‰éˆ•æ‡‰å•Ÿå‹•ä¸€å€‹**å¤šæ­¥é©Ÿçš„ç²¾éˆ (Wizard)**ï¼ˆå¦‚åœ–ç‰‡ `73, 74, 75` æ‰€ç¤ºï¼‰ï¼Œå¼•å°ä½¿ç”¨è€…å®Œæˆã€Œå®šç¾©è§¸ç™¼æ¢ä»¶ã€->ã€Œé¸æ“‡é€šçŸ¥ç®¡é“ã€->ã€Œè¨­å®šé€²éšé¸é …ã€çš„æµç¨‹ã€‚é€™æ¥µå¤§åœ°é™ä½äº†å­¸ç¿’æ›²ç·šã€‚
2.  **ä¸Šä¸‹æ–‡æ“ä½œèˆ‡æ¸¬è©¦**ï¼š
    *   åœ¨æ¯ä¸€è¡Œçš„ã€Œæ“ä½œã€æ¬„ä¸­ï¼Œæ‡‰æä¾›ä¸€å€‹ã€Œ**ç™¼é€æ¸¬è©¦å‘Šè­¦**ã€çš„æŒ‰éˆ•ã€‚é»æ“Šå¾Œï¼Œå…è¨±ä½¿ç”¨è€…é¸æ“‡ä¸€å€‹åš´é‡ç­‰ç´šï¼ˆå¦‚ `Critical`ï¼‰ï¼Œå¾Œç«¯å‰‡æœƒæ¨¡æ“¬ä¸€å€‹ç¬¦åˆè©²ç­–ç•¥è§¸ç™¼æ¢ä»¶çš„å‘Šè­¦ï¼Œä¸¦å°‡å…¶ç™¼é€åˆ°æŒ‡å®šçš„é€šçŸ¥ç®¡é“ã€‚é€™ç‚ºé©—è­‰ç­–ç•¥çš„ç«¯åˆ°ç«¯æ­£ç¢ºæ€§æä¾›äº†æ¥µå¤§çš„ä¾¿åˆ©ã€‚
3.  **ç­–ç•¥çš„ã€ŒéœéŸ³ã€èˆ‡ã€Œè¦†å¯«ã€**ï¼š
    *   æ¯ä¸€è¡Œç­–ç•¥æ—æ‡‰æä¾›ä¸€å€‹ã€Œ**è‡¨æ™‚éœéŸ³**ã€çš„é¸é …ï¼Œå…è¨±ä½¿ç”¨è€…å¿«é€Ÿåœ°ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ¥ä¸‹ä¾†çš„ 1 å°æ™‚å…§ï¼‰æš«åœæŸæ¢ç­–ç•¥ï¼Œè€Œç„¡éœ€ç¦ç”¨æ•´å€‹è¦å‰‡ã€‚
    *   æ‡‰æ¸…æ™°åœ°å‘ä½¿ç”¨è€…å±•ç¤ºç­–ç•¥çš„**åŸ·è¡Œé †åº**ï¼ˆé€šå¸¸æ˜¯å¾ä¸Šåˆ°ä¸‹åŒ¹é…ï¼‰ï¼Œä¸¦è§£é‡‹ã€Œåœæ­¢åŒ¹é… (Stop matching)ã€çš„æ¦‚å¿µï¼Œè®“é«˜éšä½¿ç”¨è€…å¯ä»¥æ§‹å»ºæ›´è¤‡é›œçš„è·¯ç”±é‚è¼¯ã€‚

#### ç·¨è¼¯é€šçŸ¥ç­–ç•¥1 [ç·¨è¼¯é€šçŸ¥ç­–ç•¥1](images/73-å½ˆçª—-é€šçŸ¥ç­–ç•¥-ç·¨è¼¯é€šçŸ¥ç­–ç•¥1.png)

**åŠŸèƒ½æè¿°**ï¼š
- é€šçŸ¥ç­–ç•¥ç·¨è¼¯å½ˆçª—çš„ç¬¬ä¸€æ­¥
- è¨­å®šåŸºæœ¬è³‡è¨Šå’Œè§¸ç™¼æ¢ä»¶
- **æ™ºæ…§è¼¸å…¥åŠŸèƒ½**ï¼šæ ¹æ“šåŒ¹é…æ¢ä»¶çš„é¡å‹è‡ªå‹•é¸æ“‡æœ€é©åˆçš„è¼¸å…¥æ–¹å¼
- æ”¯æ´ç­–ç•¥åç¨±ã€æè¿°å’Œæ¢ä»¶é…ç½®

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/notification-policies/{id}` - æ›´æ–°é€šçŸ¥ç­–ç•¥

**æ™ºæ…§è¼¸å…¥åŠŸèƒ½å¯¦ç¾**ï¼š

##### ğŸ¯ è¨­è¨ˆåŸå‰‡
- **é©é…æ€§**ï¼šæ ¹æ“šæ•¸æ“šç‰¹é»é¸æ“‡è¼¸å…¥æ–¹å¼
- **ä¸€è‡´æ€§**ï¼šçµ±ä¸€çš„UIé¢¨æ ¼å’Œæ“ä½œé‚è¼¯
- **éˆæ´»æ€§**ï¼šæ”¯æ´å–®é¸ã€å¤šé¸ã€è‡ªå‹•å®Œæˆç­‰å¤šç¨®æ¨¡å¼
- **å®¹éŒ¯æ€§**ï¼šé˜²æ­¢è¼¸å…¥éŒ¯èª¤ï¼Œæé«˜é…ç½®æº–ç¢ºæ€§

##### ğŸ“‹ è¼¸å…¥æ–¹å¼åˆ†é¡

| è¼¸å…¥æ–¹å¼ | é©ç”¨å ´æ™¯ | å„ªé» | é©ç”¨æ¨™ç±¤ |
|---------|---------|------|----------|
| **ä¸‹æ‹‰é¸å–®** | æœ‰é™å›ºå®šå€¼ | æº–ç¢ºã€å¿«é€Ÿã€é˜²éŒ¯ | severity, env, team, component, category |
| **è‡ªå‹•å®Œæˆ** | å¤§é‡å‹•æ…‹å€¼ | ä¾¿æ·ã€éˆæ´»ã€æç¤º | instance, service |
| **è‡ªç”±è¼¸å…¥** | è‡ªå®šç¾©åŒ¹é… | éˆæ´»ã€é€šç”¨ | alert_name, å…¶ä»– |

##### ğŸ”§ å¯¦ç¾ç´°ç¯€

**æ™ºæ…§è¼¸å…¥å‡½æ•¸**ï¼š
```javascript
const getSmartValueInput = (condition, index) => {
  const { key, value, operator } = condition;

  // æª¢æŸ¥æ˜¯å¦ç‚ºå¤šé¸é‹ç®—å­
  const isMultiSelectOperator = operator === 'in' || operator === 'not_in';

  // æ ¹æ“šæ¨™ç±¤é¡å‹é¸æ“‡è¼¸å…¥æ–¹å¼
  switch (key) {
    case 'severity':
    case 'env':
    case 'team':
    case 'component':
    case 'category':
      return isMultiSelectOperator ?
        <MultiSelectDropdown /> :
        <SingleSelectDropdown />;

    case 'instance':
    case 'service':
      return <AutoCompleteInput />;

    default:
      return <FreeTextInput />;
  }
};
```

**å¤šé¸é‹ç®—å­æ”¯æ´**ï¼š
```javascript
const operators = [
  { value: '=', label: '=' },
  { value: '!=', label: '!=' },
  { value: '~', label: '~' },
  { value: '!~', label: '!~' },
  { value: 'in', label: 'in' },      // æ–°å¢
  { value: 'not_in', label: 'not_in' } // æ–°å¢
];
```

##### ğŸ¨ UI/UX è¨­è¨ˆç‰¹é»
- **é¡è‰²ç·¨ç¢¼**: severity ä½¿ç”¨ä¸åŒé¡è‰²æ¨™ç±¤
- **åœ–æ¨™æç¤º**: ä¸åŒè¼¸å…¥é¡å‹ä½¿ç”¨å°æ‡‰åœ–æ¨™
- **ç‹€æ…‹æŒ‡ç¤º**: é¡¯ç¤ºç•¶å‰é¸æ“‡çš„å€¼
- **éµç›¤å°èˆª**: æ”¯æ´ä¸Šä¸‹éµå’Œ Enter é¸æ“‡
- **è‡ªå‹•éæ¿¾**: è¼¸å…¥æ™‚å¯¦æ™‚éæ¿¾é¸é …

##### ğŸ“Š ä½¿ç”¨ç¤ºä¾‹
- **severity + `=`**: å–®é¸ä¸‹æ‹‰é¸å–®ï¼ˆå¸¶é¡è‰²æ¨™ç±¤ï¼‰
- **severity + `in`**: å¤šé¸ä¸‹æ‹‰é¸å–®
- **instance + ä»»ä½•é‹ç®—å­**: è‡ªå‹•å®Œæˆè¼¸å…¥æ¡†
- **alert_name + ä»»ä½•é‹ç®—å­**: è‡ªç”±è¼¸å…¥æ¡†

**UX æ”¹å–„å»ºè­°**ï¼š
1. **ç­–ç•¥ç²¾éˆ**ï¼šæä¾›åˆ†æ­¥å¼çš„ç­–ç•¥å»ºç«‹ç²¾éˆï¼Œé™ä½é…ç½®è¤‡é›œåº¦
2. **æ¢ä»¶æ¸¬è©¦**ï¼šå…§å»ºæ¸¬è©¦åŠŸèƒ½ï¼Œæ¨¡æ“¬è§¸ç™¼æ¢ä»¶å’Œé€šçŸ¥æ•ˆæœ
3. **ç¯„æœ¬ç®¡ç†**ï¼šæä¾›é€šçŸ¥ç¯„æœ¬çš„è¦–è¦ºåŒ–ç·¨è¼¯å’Œé è¦½
4. **å½±éŸ¿åˆ†æ**ï¼šé¡¯ç¤ºç­–ç•¥å°‡å½±éŸ¿çš„ç”¨æˆ¶å’Œé€šçŸ¥é‡é ä¼°
5. **æ‰¹é‡ç®¡ç†**ï¼šæ”¯æ´å¤šå€‹ç­–ç•¥çš„æ‰¹é‡é–‹å•Ÿ/é—œé–‰å’Œä¿®æ”¹
6. **æ™ºæ…§è¼¸å…¥å„ªåŒ–**ï¼šæŒçºŒå„ªåŒ–æ™ºæ…§è¼¸å…¥çš„æº–ç¢ºæ€§å’Œç”¨æˆ¶é«”é©—

#### ç·¨è¼¯é€šçŸ¥ç­–ç•¥2 [ç·¨è¼¯é€šçŸ¥ç­–ç•¥2](images/74-å½ˆçª—-é€šçŸ¥ç­–ç•¥-ç·¨è¼¯é€šçŸ¥ç­–ç•¥2.png)

**åŠŸèƒ½æè¿°**ï¼š
- é€šçŸ¥ç­–ç•¥ç·¨è¼¯ç²¾éˆçš„ç¬¬äºŒæ­¥ï¼šã€Œè¨­å®šé€šçŸ¥ç®¡é“ã€ã€‚
- æ ¸å¿ƒç›®æ¨™æ˜¯ç‚ºæ­¤ç­–ç•¥æŒ‡å®šæ¥æ”¶é€šçŸ¥çš„ç®¡é“ï¼ˆå³ Grafana çš„ Contact Pointsï¼‰ã€‚
- ä»‹é¢ä¸­åŒ…å«ä¸€å€‹ã€Œç³»çµ±å»ºè­°ã€å€å¡Šï¼Œä¸¦åˆ—å‡ºå¯ä¾›é¸æ“‡çš„é€šçŸ¥ç®¡é“ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/notification-channels` - ç²å–æ‰€æœ‰å¯ç”¨çš„é€šçŸ¥ç®¡é“åˆ—è¡¨ã€‚
- `GET /api/v1/teams/{id}/suggested-channels` - ç²å–èˆ‡è³‡æºç¾¤çµ„é—œè¯çš„åœ˜éšŠæ‰€æ¨è–¦çš„é€šçŸ¥ç®¡é“ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ¸…æ™°æ¨™ç¤ºç®¡é“é¡å‹**ï¼šåœ¨æ¯å€‹ç®¡é“åç¨±æ—ï¼Œæ‡‰æœ‰æ˜ç¢ºçš„åœ–ç¤ºï¼ˆå¦‚ Slack, PagerDuty, Emailï¼‰ä¾†æ¨™ç¤ºå…¶é¡å‹ã€‚
2. **é è¨­é¸ä¸­**ï¼šã€Œç³»çµ±å»ºè­°ã€çš„ç®¡é“æ‡‰é è¨­ç‚ºé¸ä¸­ç‹€æ…‹ï¼Œç°¡åŒ–æ“ä½œã€‚
3. **æ¸¬è©¦é€£çµ**ï¼šåœ¨æ¯å€‹ç®¡é“æ—æä¾›ä¸€å€‹ã€Œæ¸¬è©¦ã€æŒ‰éˆ•ï¼Œé»æ“Šå¾Œå¯ä»¥ç«‹å³ç™¼é€ä¸€æ¢æ¸¬è©¦é€šçŸ¥åˆ°è©²ç®¡é“ï¼Œä»¥é©—è­‰å…¶å¯ç”¨æ€§ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æ­¤æ­¥é©Ÿå°‡æŠ½è±¡çš„ã€Œåœ˜éšŠã€èˆ‡å…·é«”çš„ã€Œé€šçŸ¥ç®¡é“ã€é€£çµèµ·ä¾†ï¼Œæ˜¯ç¢ºä¿å‘Šè­¦èƒ½æº–ç¢ºé€é”è²¬ä»»äººçš„é—œéµç’°ç¯€ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **èˆ‡ Grafana Contact Point çš„æ˜ å°„**ï¼šæ­¤è™•é¸æ“‡çš„æ¯ä¸€å€‹ã€Œé€šçŸ¥ç®¡é“ã€ï¼Œåœ¨å¾Œç«¯éƒ½å°æ‡‰ä¸€å€‹ Grafanaã€Œæ¥è§¸é» (Contact Point)ã€çš„ UUIDã€‚ç•¶ä½¿ç”¨è€…å®Œæˆç²¾éˆæ™‚ï¼Œé€™äº› UUIDs å°‡è¢«ç”¨ä¾†å¡«å…… Grafana Policy JSON ä¸­çš„ `contact_point` æ¬„ä½ã€‚
2.  **ã€Œç³»çµ±å»ºè­°ã€çš„å¯¦ç¾**ï¼šé€™å€‹åŠŸèƒ½éœ€è¦å¹³å°è‡ªèº«ç¶­è­·æ•¸æ“šæ¨¡å‹ã€‚
    *   `resource_groups` è¡¨éœ€è¦æœ‰ä¸€å€‹ `responsible_team_id` æ¬„ä½ã€‚
    *   `teams` è¡¨å¯ä»¥é—œè¯åˆ°ä¸€çµ„é è¨­çš„ `notification_channel_ids`ã€‚
    *   ç•¶å‰ç«¯åœ¨æ­¥é©Ÿä¸€é¸æ“‡äº†æŸå€‹è³‡æºç¾¤çµ„å¾Œï¼Œå®ƒå¯ä»¥å‘å¾Œç«¯è«‹æ±‚å»ºè­°çš„ç®¡é“åˆ—è¡¨ï¼Œå¾Œç«¯æ ¹æ“šä¸Šè¿°é—œè¯é—œä¿‚å›å‚³æ¨è–¦çš„ç®¡é“ã€‚
3.  **API Payload çµæ§‹**ï¼šæäº¤åˆ° `POST /api/v1/notification-policies` çš„ payload ä¸­ï¼Œæ­¤æ­¥é©Ÿçš„æ•¸æ“šæ‡‰ç‚ºä¸€çµ„ IDï¼š
    ```json
    {
      // ... data from step 1
      "contact_point_ids": ["uuid-of-pagerduty", "uuid-of-slack"],
      // ... data from step 3
    }
    ```

#### ç·¨è¼¯é€šçŸ¥ç­–ç•¥3 [ç·¨è¼¯é€šçŸ¥ç­–ç•¥3](images/75-å½ˆçª—-é€šçŸ¥ç­–ç•¥-ç·¨è¼¯é€šçŸ¥ç­–ç•¥3.png)

**åŠŸèƒ½æè¿°**ï¼š
- é€šçŸ¥ç­–ç•¥ç·¨è¼¯ç²¾éˆçš„ç¬¬ä¸‰æ­¥ï¼šã€Œæ–°å¢åŒ¹é…æ¢ä»¶ã€ã€‚
- å…è¨±ä½¿ç”¨è€…åœ¨ç¬¬ä¸€æ­¥é¸æ“‡çš„ã€Œè³‡æºç¾¤çµ„ã€åŸºç¤ä¸Šï¼Œæ·»åŠ æ›´ç²¾ç´°çš„æ¨™ç±¤åŒ¹é…æ¢ä»¶ï¼ˆLabel Matchersï¼‰ï¼Œä½œç‚º AND æ¢ä»¶ä¾†é€²ä¸€æ­¥éæ¿¾å‘Šè­¦ã€‚
- ä»‹é¢åŒ…å«ä¸€å€‹æ¢ä»¶å»ºæ§‹å™¨ï¼Œä»¥åŠä¸€å€‹ã€Œæ™ºæ…§è¼¸å…¥æç¤ºã€å€å¡Šã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/tags` - ç²å–æ‰€æœ‰å¯ç”¨çš„æ¨™ç±¤éµï¼ˆLabel keysï¼‰åˆ—è¡¨ã€‚
- `GET /api/v1/tags/{key}/values` - æ ¹æ“šæ¨™ç±¤éµç²å–å…¶å¯ç”¨çš„å€¼åˆ—è¡¨ï¼ˆç”¨æ–¼ä¸‹æ‹‰é¸å–®å’Œè‡ªå‹•å®Œæˆï¼‰ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **é‚è¼¯é—œä¿‚æ¸…æ™°åŒ–**ï¼šæ˜ç¢ºæ¨™ç¤ºæ‰€æœ‰æ¢ä»¶ä¹‹é–“æ˜¯ã€ŒANDã€é—œä¿‚ã€‚å¦‚æœæœªä¾†è¦æ”¯æ´ã€ŒORã€ï¼Œéœ€è¦æä¾›æ›´æ˜ç¢ºçš„ UI é€²è¡Œåˆ†çµ„ã€‚
2. **å³æ™‚é©—è­‰**ï¼šå°è¼¸å…¥çš„å€¼é€²è¡Œå³æ™‚é©—è­‰ï¼Œä¾‹å¦‚ï¼Œå¦‚æœé‹ç®—å­æ˜¯ `~` (regex match)ï¼Œæ‡‰é©—è­‰å…¶æ˜¯å¦ç‚ºåˆæ³•çš„æ­£å‰‡è¡¨é”å¼ã€‚
3. **åˆªé™¤ç¢ºèª**ï¼šåˆªé™¤æ¢ä»¶æ™‚æ‡‰æœ‰äºŒæ¬¡ç¢ºèªï¼Œé˜²æ­¢èª¤æ“ä½œã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æ­¤æ­¥é©Ÿæ˜¯æ•´å€‹ç²¾éˆçš„é»ç›ä¹‹ç­†ï¼Œå®ƒå°‡ Grafana å¼·å¤§ä½†è¤‡é›œçš„æ¨™ç±¤åŒ¹é…åŠŸèƒ½ï¼Œé€éã€Œæ™ºæ…§è¼¸å…¥ã€é€™å€‹ UX è¨­è¨ˆï¼Œè®Šå¾—æ¥µç‚ºå‹å¥½å’Œé«˜æ•ˆã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **Matcher ç¿»è­¯**ï¼šå¾Œç«¯çš„æ ¸å¿ƒä»»å‹™æ˜¯å°‡å‰ç«¯å‚³ä¾†çš„ä¸€çµ„æ¢ä»¶é™£åˆ—ï¼Œæº–ç¢ºåœ°ç¿»è­¯æˆ Grafana Policy JSON ä¸­çš„ `matcher` ç‰©ä»¶ã€‚ä¾‹å¦‚ï¼Œ`[{key: "team", op: "=", val: "DevOps Team"}]` æœƒè¢«ç¿»è­¯æˆ `{"team": "DevOps Team"}`ã€‚
2.  **API Payload çµæ§‹**ï¼šåœ¨æœ€çµ‚æäº¤çš„ payload ä¸­ï¼Œæ­¤æ­¥é©Ÿçš„æ•¸æ“šæ‡‰ç‚ºä¸€å€‹æ¢ä»¶é™£åˆ—ï¼š
    ```json
    {
      // ... data from step 1 & 2
      "additional_matchers": [
        { "key": "team", "operator": "=", "value": "DevOps Team" },
        { "key": "severity", "operator": "!=", "value": "info" }
      ]
    }
    ```
3.  **æ¨™ç±¤å€¼ API**ï¼šç‚ºäº†æ”¯æ´æ™ºæ…§è¼¸å…¥ï¼Œå¾Œç«¯å¿…é ˆæä¾›é«˜æ•ˆçš„ API ä¾†æŸ¥è©¢æ¨™ç±¤éµå’Œå€¼ã€‚`GET /api/v1/tags/{key}/values` çš„å¯¦ä½œå¯èƒ½éœ€è¦æŸ¥è©¢ Prometheus/VictoriaMetrics çš„å…ƒæ•¸æ“š API (`/api/v1/label/{label_name}/values`)ï¼Œä¸¦å°çµæœé€²è¡Œå¿«å–ã€‚

**ã€Œæ™ºæ…§è¼¸å…¥ã€åŠŸèƒ½æ·±åº¦åˆ†æ**ï¼š
- **æ ¸å¿ƒç†å¿µ**ï¼šæ ¹æ“šä½¿ç”¨è€…é¸æ“‡çš„**æ¨™ç±¤éµ (key)**ï¼Œå‹•æ…‹åœ°åˆ‡æ›æœ€é©åˆçš„**è¼¸å…¥å…ƒä»¶**ã€‚
- **å¯¦ç¾é‚è¼¯**ï¼š
    - **ä¸‹æ‹‰é¸å–® (Dropdown)**ï¼šé©ç”¨æ–¼å€¼æ˜¯æœ‰é™ã€å›ºå®šçš„æšèˆ‰é¡å‹ã€‚ä¾‹å¦‚ `severity` (`critical`, `warning`), `env` (`production`, `staging`)ã€‚é€™äº›å›ºå®šçš„å€¼æ‡‰ç”±å¹³å°ç®¡ç†å“¡åœ¨ã€Œæ¨™ç±¤ç®¡ç†ã€é é¢ä¸­é å…ˆå®šç¾©ã€‚
    - **è‡ªå‹•å®Œæˆ (Autocomplete)**ï¼šé©ç”¨æ–¼å€¼æ˜¯å‹•æ…‹çš„ã€æ•¸é‡é¾å¤§çš„æ¨™ç±¤ã€‚ä¾‹å¦‚ `instance`, `pod_name`ã€‚å‰ç«¯åœ¨ä½¿ç”¨è€…è¼¸å…¥æ™‚ï¼Œå‘¼å«å¾Œç«¯ API é€²è¡Œæ¨¡ç³ŠæŸ¥è©¢ã€‚
    - **è‡ªç”±è¼¸å…¥ (Free Text)**ï¼šé©ç”¨æ–¼å®Œå…¨è‡ªå®šç¾©çš„æ¨™ç±¤ï¼Œå¦‚ `alert_name` æˆ–è¨»è§£ã€‚
- **é‹ç®—å­èˆ‡è¼¸å…¥æ¡†çš„è¯å‹•**ï¼šç•¶ä½¿ç”¨è€…é¸æ“‡ `in` æˆ– `not_in` é‹ç®—å­æ™‚ï¼Œè¼¸å…¥æ¡†æ‡‰è‡ªå‹•è½‰æ›ç‚ºä¸€å€‹æ”¯æ´è¼¸å…¥å¤šå€‹å€¼çš„ã€Œå¤šé¸æ¨™ç±¤è¼¸å…¥æ¡† (Multi-select Tag Input)ã€ã€‚

#### ç·¨è¼¯é€šçŸ¥ç®¡é“ [ç·¨è¼¯é€šçŸ¥ç®¡é“](images/76-å½ˆçª—-é€šçŸ¥ç®¡é“-ç·¨è¼¯é€šçŸ¥ç®¡é“.png)

**åŠŸèƒ½æè¿°**ï¼š
- ç”¨æ–¼æ–°å¢æˆ–ç·¨è¼¯å–®ä¸€é€šçŸ¥ç®¡é“ï¼ˆGrafana Contact Pointï¼‰çš„è¡¨å–®ã€‚
- æ ¹æ“šé¸æ“‡çš„ã€Œç®¡é“é¡å‹ã€ï¼Œå‹•æ…‹é¡¯ç¤ºå°æ‡‰çš„è¨­å®šæ¬„ä½ï¼ˆå¦‚ Email çš„æ”¶ä»¶äººã€Webhook çš„ URLï¼‰ã€‚
- æä¾›ã€Œç™¼é€æ¸¬è©¦ã€å’Œã€Œå„²å­˜ã€æ“ä½œã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `PUT /api/v1/notification-channels/{id}` - æ›´æ–°é€šçŸ¥ç®¡é“ï¼Œå¾Œç«¯ä»£ç†è‡³ Grafana APIã€‚
- `POST /api/v1/notification-channels/{id}/test` - ç™¼é€æ¸¬è©¦é€šçŸ¥ï¼Œå¾Œç«¯ä»£ç†è‡³ Grafana APIã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å‹•æ…‹è¡¨å–®**ï¼šè¡¨å–®æ¬„ä½æ‡‰æ ¹æ“šã€Œç®¡é“é¡å‹ã€çš„é¸æ“‡è€Œå‹•æ…‹è®ŠåŒ–ï¼Œä¸¦æä¾›æ¸…æ™°çš„æ¬„ä½èªªæ˜å’Œç¯„ä¾‹ã€‚
2. **å³æ™‚å›é¥‹**ï¼šã€Œç™¼é€æ¸¬è©¦ã€æ“ä½œå¾Œï¼Œæ‡‰åœ¨ä»‹é¢ä¸Šé¡¯ç¤ºä¸€å€‹æ˜ç¢ºçš„æˆåŠŸæˆ–å¤±æ•—æç¤ºã€‚å¦‚æœå¤±æ•—ï¼Œæ‡‰é¡¯ç¤ºå¾å¾Œç«¯æ”¶åˆ°çš„å…·é«”éŒ¯èª¤è¨Šæ¯ï¼Œå¹«åŠ©ä½¿ç”¨è€…å³æ™‚ä¿®æ­£è¨­å®šã€‚
3. **å®‰å…¨æç¤º**ï¼šå°æ–¼éœ€è¦è¼¸å…¥ Token æˆ– Webhook URL çš„æ¬„ä½ï¼Œæ‡‰æœ‰å®‰å…¨æç¤ºï¼Œå‘ŠçŸ¥ä½¿ç”¨è€…é€™äº›è³‡è¨Šå°‡è¢«å®‰å…¨å„²å­˜ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æ­¤è¡¨å–®æ˜¯å¹³å°èˆ‡ Grafana æ¥è§¸é»é…ç½®äº’å‹•çš„æ ¸å¿ƒä»‹é¢ã€‚å…¶è¨­è¨ˆæ‡‰èšç„¦æ–¼**æ˜“ç”¨æ€§**å’Œ**å³æ™‚é©—è­‰**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **API ä»£ç†**ï¼š`PUT` å’Œ `POST` ç«¯é»çš„æ ¸å¿ƒè·è²¬æ˜¯å°‡å‰ç«¯å‚³ä¾†çš„ç°¡åŒ–è³‡æ–™æ¨¡å‹ï¼Œæº–ç¢ºåœ°ç¿»è­¯æˆ Grafana API æ‰€éœ€çš„ JSON çµæ§‹ã€‚ä¾‹å¦‚ï¼Œä¸€å€‹ Email é¡å‹çš„ç®¡é“ï¼Œå¾Œç«¯éœ€è¦å»ºæ§‹å¦‚ä¸‹çš„ payload å»å‘¼å« Grafanaï¼š
    ```json
    {
      "name": "Default Email",
      "type": "email",
      "settings": {
        "addresses": "user1@example.com;user2@example.com"
      }
    }
    ```
2.  **åŒæ­¥çš„æ¸¬è©¦è«‹æ±‚**ï¼šå‰ç«¯ç™¼èµ·çš„ã€Œç™¼é€æ¸¬è©¦ã€è«‹æ±‚æ‡‰æ˜¯ä¸€å€‹**åŒæ­¥**æ“ä½œã€‚API `POST /api/v1/notification-channels/{id}/test` æ‡‰ç­‰å¾… Grafana çš„æ¸¬è©¦è«‹æ±‚å®Œæˆï¼Œä¸¦å°‡å…¶æˆåŠŸæˆ–å¤±æ•—çš„çµæœç«‹å³å›å‚³çµ¦å‰ç«¯ï¼Œä»¥ä¾¿ UI èƒ½æä¾›å³æ™‚å›é¥‹ã€‚

#### é€šçŸ¥è©³æƒ… [é€šçŸ¥è©³æƒ…](images/77-æŠ½å±œ-é€šçŸ¥æ­·å²-é€šçŸ¥è©³æƒ….png)

**åŠŸèƒ½æè¿°**ï¼š
- å¾ã€Œé€šçŸ¥æ­·å²ã€åˆ—è¡¨é»æ“Šå¾Œï¼Œä»¥æŠ½å±œ (Drawer) å½¢å¼å±•ç¤ºçš„å–®æ¢é€šçŸ¥ç™¼é€è©³æƒ…ã€‚
- æ¸…æ™°åœ°å±•ç¤ºäº†é€šçŸ¥çš„ç™¼é€æ™‚é–“ã€ç‹€æ…‹ã€æ¥æ”¶ç®¡é“ã€é—œè¯å‘Šè­¦ç­‰å…ƒæ•¸æ“šã€‚
- æä¾›äº†é€šçŸ¥å…§å®¹çš„é è¦½ã€çµæ§‹åŒ–çš„éŒ¯èª¤è¨Šæ¯ï¼ˆå¦‚æœå¤±æ•—ï¼‰ä»¥åŠåŸå§‹çš„ JSON Payloadã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/notification-history/{id}` - å¾å¹³å°è‡ªèº«çš„æ­·å²è¨˜éŒ„è³‡æ–™åº«ä¸­ç²å–æŒ‡å®šé€šçŸ¥çš„å®Œæ•´è©³æƒ…ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **é—œè¯å°èˆª**ï¼šã€Œé—œè¯å‘Šè­¦ã€çš„å…§å®¹æ‡‰æ˜¯ä¸€å€‹è¶…é€£çµï¼Œé»æ“Šå¾Œå¯ä»¥ç›´æ¥æ‰“é–‹è©²å‘Šè­¦çš„ã€Œäº‹ä»¶è©³æƒ…ã€å½ˆçª—ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…è¿½æº¯å•é¡Œçš„å®Œæ•´ä¸Šä¸‹æ–‡ã€‚
2. **Payload æ ¼å¼åŒ–**ï¼šã€ŒåŸå§‹ Payloadã€å€å¡Šçš„ JSON æ‡‰è¢«æ ¼å¼åŒ–ã€å¯æ‘ºç–Šã€å¯è¤‡è£½ï¼Œä»¥æå‡å¯è®€æ€§å’Œå¯¦ç”¨æ€§ã€‚
3. **é‡è©¦æŒ‰éˆ•**ï¼šå¦‚æœé€šçŸ¥ç‹€æ…‹æ˜¯ã€ŒFAILEDã€ï¼Œæ‡‰åœ¨æ­¤æŠ½å±œçš„åº•éƒ¨æˆ–é ‚éƒ¨æä¾›ä¸€å€‹ã€Œé‡æ–°ç™¼é€ã€æŒ‰éˆ•ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…é€²è¡Œæ‰‹å‹•é‡è©¦ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æ­¤è©³æƒ…è¦–åœ–çš„è¨­è¨ˆéå¸¸å‡ºè‰²ï¼Œç‰¹åˆ¥æ˜¯**åŒæ™‚æä¾›äº†ç°¡æ½”çš„éŒ¯èª¤æ‘˜è¦å’Œå®Œæ•´çš„åŸå§‹ Payload**ï¼Œé€™å°æ–¼ SRE é€²è¡Œæ•…éšœæ’é™¤è‡³é—œé‡è¦ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **æ•¸æ“šä¾†æº**ï¼šå¦‚å‰è¿°ï¼Œæ­¤è™•æ‰€æœ‰æ•¸æ“šå‡ä¾†è‡ªå¹³å°è‡ªèº«çš„ `notification_history` è³‡æ–™åº«è¡¨ï¼Œè€Œéç›´æ¥ä¾†è‡ª Grafanaã€‚
2.  **è±å¯Œçš„ Payload**ï¼š`GET /api/v1/notification-history/{id}` å›æ‡‰çš„ JSON payload æ‡‰åŒ…å«æ‰€æœ‰å¿…è¦è³‡è¨Šï¼ŒåŒ…æ‹¬ï¼š
    *   `metadata`: åŒ…å«æ™‚é–“ã€ç‹€æ…‹ã€æ“ä½œè€…ç­‰ã€‚
    *   `channel_info`: æ¥æ”¶ç®¡é“çš„è©³ç´°è³‡è¨Šã€‚
    *   `alert_context`: é—œè¯å‘Šè­¦çš„æ‘˜è¦å’Œ IDã€‚
    *   `content`: æ ¼å¼åŒ–å¾Œçš„é€šçŸ¥å…§å®¹ã€‚
    *   `result`: åŒ…å« `status` (`SUCCESS`/`FAILED`) å’Œ `error_message` (å¦‚æœå¤±æ•—)ã€‚
    *   `raw_payload`: å¾ Grafana Webhook æ¥æ”¶åˆ°çš„åŸå§‹ JSON å­—ä¸²ã€‚
3.  **é—œè¯äº‹ä»¶ ID**ï¼šç‚ºäº†å¯¦ç¾ UX å»ºè­°ä¸­çš„ã€Œé—œè¯å°èˆªã€ï¼Œå¾Œç«¯åœ¨è¨˜éŒ„é€šçŸ¥æ­·å²æ™‚ï¼Œå¿…é ˆå¾ Grafana çš„ Webhook payload ä¸­è§£æå‡ºå‘Šè­¦çš„å”¯ä¸€æ¨™è­˜ï¼Œä¸¦å°‡å…¶èˆ‡æ­·å²è¨˜éŒ„é—œè¯èµ·ä¾†ã€‚

#### é€šçŸ¥ç®¡é“ [é€šçŸ¥ç®¡é“](images/71-é é¢-é€šçŸ¥ç®¡é“.png)

**åŠŸèƒ½æè¿°**ï¼š
- é€šçŸ¥ç™¼é€ç®¡é“ç®¡ç†
- ç®¡é“ç‹€æ…‹å’Œä½¿ç”¨çµ±è¨ˆ
- é€šçŸ¥ç®¡é“è¡¨æ ¼ï¼šç®¡é“é¡å‹ã€åç¨±ã€é…ç½®ç‹€æ…‹ã€ä½¿ç”¨çµ±è¨ˆã€æ¸¬è©¦åŠŸèƒ½
- ç®¡é“é…ç½®å’Œæ¸¬è©¦å·¥å…·

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/notification-channels` - ç²å–é€šçŸ¥ç®¡é“åˆ—è¡¨
- `POST /api/v1/notification-channels` - å‰µå»ºé€šçŸ¥ç®¡é“
- `PUT /api/v1/notification-channels/{id}` - æ›´æ–°é€šçŸ¥ç®¡é“
- `DELETE /api/v1/notification-channels/{id}` - åˆªé™¤é€šçŸ¥ç®¡é“
- `POST /api/v1/notification-channels/{id}/test` - æ¸¬è©¦é€šçŸ¥ç®¡é“

**UX æ”¹å–„å»ºè­°**ï¼š
1. **ç®¡é“å¥åº·æª¢æŸ¥**ï¼šå³æ™‚é¡¯ç¤ºç®¡é“é€£æ¥ç‹€æ…‹
2. **ä½¿ç”¨é‡çµ±è¨ˆ**ï¼šé¡¯ç¤ºå„ç®¡é“çš„ä½¿ç”¨æƒ…æ³å’Œæˆæœ¬
3. **å®¹éŒ¯é…ç½®**ï¼šè¨­å®šç®¡é“æ•…éšœæ™‚çš„å‚™ç”¨æ–¹æ¡ˆ
4. **æ¨¡æ¿ç®¡ç†**ï¼šæ”¯æ´é€šçŸ¥æ¨¡æ¿çš„çµ±ä¸€ç®¡ç†
5. **å¤šç§Ÿæˆ¶æ”¯æ´**ï¼šæ”¯æ´ä¸åŒç§Ÿæˆ¶çš„ç®¡é“éš”é›¢

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚æ­¤é é¢æ˜¯å¹³å°ç®¡ç† Grafanaã€Œæ¥è§¸é» (Contact Points)ã€çš„çµ±ä¸€ä»‹é¢ã€‚èˆ‡ã€Œé€šçŸ¥ç­–ç•¥ã€é é¢é¡ä¼¼ï¼Œå®ƒçš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼æä¾›ä¸€å€‹æ¯”åŸç”Ÿ Grafana æ›´å¥½ç”¨ã€è³‡è¨Šæ›´è±å¯Œçš„ç®¡ç†é«”é©—ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ (Grafana ä»£ç†æ¨¡å¼)**ï¼š
1.  **æ ¸å¿ƒè·è²¬ - Grafana ä»£ç†**ï¼šå¾Œç«¯æœå‹™çš„æ ¸å¿ƒè·è²¬æ˜¯ä½œç‚º Grafana ` /api/v1/provisioning/contact-points` API ç«¯é»çš„ä»£ç†ã€‚
    *   `GET /api/v1/notification-channels`ï¼šå‘¼å« Grafana çš„å°æ‡‰ç«¯é»ï¼Œç²å–æ¥è§¸é»åˆ—è¡¨ã€‚
    *   `POST`, `PUT`, `DELETE`ï¼šå°‡å‰ç«¯å‚³ä¾†çš„ç°¡åŒ–æ¨¡å‹ï¼Œç¿»è­¯æˆ Grafana API æ‰€éœ€çš„å®Œæ•´ JSON çµæ§‹å¾Œï¼Œå†ç™¼é€è«‹æ±‚ã€‚
2.  **API è¨­è¨ˆ - å¢å€¼æœå‹™**ï¼š
    *   `GET /api/v1/notification-channels/statistics`ï¼šé ‚éƒ¨çš„ KPI æŒ‡æ¨™ï¼ˆå¦‚ã€Œä»Šæ—¥é€šçŸ¥é‡ã€ï¼‰æ‡‰å¾ Redis å¿«å–ä¸­è®€å–ï¼Œè©²å¿«å–ç”±åˆ†æ `notification_history` è¡¨çš„èƒŒæ™¯ä½œæ¥­ç¶­è­·ã€‚
    *   `POST /api/v1/notification-channels/{id}/test`ï¼šæ­¤ API ç›´æ¥ä»£ç† Grafana çš„æ¸¬è©¦ç«¯é»ã€‚é‡è¦çš„æ˜¯ï¼Œå¾Œç«¯æ‡‰**åŒæ­¥ç­‰å¾…** Grafana çš„æ¸¬è©¦çµæœï¼Œä¸¦å°‡å…¶ç«‹å³å›å‚³çµ¦å‰ç«¯ï¼Œä»¥ä¾¿ UI èƒ½å¤ å³æ™‚é¡¯ç¤ºæ¸¬è©¦æ˜¯æˆåŠŸé‚„æ˜¯å¤±æ•—ï¼Œä»¥åŠå¤±æ•—çš„åŸå› ã€‚
3.  **å¥åº·æª¢æŸ¥èˆ‡ç‹€æ…‹å„²å­˜**ï¼š
    *   åˆ—è¡¨ä¸­çš„ã€Œæœ€è¿‘æ¸¬è©¦çµæœã€å’Œã€Œæœ€è¿‘æ¸¬è©¦æ™‚é–“ã€æ¬„ä½ï¼Œå…¶è³‡æ–™ä¾†æº**ä¸æ˜¯** Grafanaã€‚
    *   å¹³å°éœ€è¦ä¸€å€‹èƒŒæ™¯æ’ç¨‹ä½œæ¥­ï¼Œå®šæœŸï¼ˆä¾‹å¦‚æ¯ 15 åˆ†é˜ï¼‰éæ­·æ‰€æœ‰å·²è¨­å®šçš„é€šçŸ¥ç®¡é“ï¼Œä¸¦å‘¼å«å®ƒå€‘å„è‡ªçš„ã€Œæ¸¬è©¦ã€APIã€‚
    *   è©²ä½œæ¥­æœƒå°‡æ¯ä¸€æ¬¡çš„æ¸¬è©¦çµæœï¼ˆæˆåŠŸ/å¤±æ•—ã€æ™‚é–“æˆ³ã€éŒ¯èª¤è¨Šæ¯ï¼‰å„²å­˜åœ¨å¹³å°è‡ªèº«çš„è³‡æ–™åº«ä¸­ï¼ˆä¾‹å¦‚ä¸€å¼µ `channel_health_checks` è¡¨ï¼‰ã€‚`GET /api/v1/notification-channels` API åœ¨å›å‚³åˆ—è¡¨æ™‚ï¼Œæœƒé™„åŠ ä¸Šé€™äº›æœ€è¿‘çš„å¥åº·æª¢æŸ¥ç‹€æ…‹ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **å³æ™‚ã€å¯æ“ä½œçš„æ¸¬è©¦**ï¼š
    *   åœ¨æ¯ä¸€è¡Œçš„ã€Œæ“ä½œã€æ¬„ä¸­ï¼Œã€Œæ¸¬è©¦ã€æŒ‰éˆ•æ˜¯é—œéµã€‚é»æ“Šå¾Œï¼ŒUI æ‡‰é¡¯ç¤ºä¸€å€‹ç­‰å¾…ç‹€æ…‹ï¼ˆå¦‚æ—‹è½‰åœ–ç¤ºï¼‰ï¼Œä¸¦åœ¨æ”¶åˆ°å¾Œç«¯ API çš„åŒæ­¥å›å‚³å¾Œï¼Œç«‹å³å°‡è©²è¡Œçš„ã€Œæœ€è¿‘æ¸¬è©¦çµæœã€æ›´æ–°ç‚º `SUCCESS` æˆ– `FAILED`ï¼Œä¸¦çŸ­æš«é«˜äº®è©²å„²å­˜æ ¼ã€‚é€™ç¨®å³æ™‚åé¥‹å°æ–¼ä½¿ç”¨è€…é…ç½®å’Œé™¤éŒ¯è‡³é—œé‡è¦ã€‚
2.  **ä½¿ç”¨é‡æ´å¯Ÿ**ï¼š
    *   åœ¨è¡¨æ ¼ä¸­å¢åŠ ä¸€æ¬„ã€Œ**é—œè¯ç­–ç•¥æ•¸**ã€ã€‚æ­¤æ•¸æ“šé¡¯ç¤ºæœ‰å¤šå°‘æ¢ã€Œé€šçŸ¥ç­–ç•¥ã€æ­£åœ¨ä½¿ç”¨é€™å€‹ç®¡é“ã€‚
    *   æ­¤æ•¸å­—æ‡‰å¯é»æ“Šã€‚é»æ“Šå¾Œï¼Œæœƒå½ˆå‡ºä¸€å€‹å°è©±æ¡†ï¼Œåˆ—å‡ºæ‰€æœ‰é—œè¯çš„ç­–ç•¥åç¨±ã€‚
    *   é€™å€‹åŠŸèƒ½æœ‰åŠ©æ–¼ç®¡ç†å“¡åœ¨ä¿®æ”¹æˆ–åˆªé™¤ä¸€å€‹ç®¡é“å‰ï¼Œè©•ä¼°å…¶å½±éŸ¿ç¯„åœã€‚
3.  **ç®¡é“é¡å‹è¦–è¦ºåŒ–**ï¼š
    *   åœ¨ã€Œé¡å‹ã€æ¬„ä½ï¼Œé™¤äº†æ–‡å­—ï¼ˆå¦‚ `Slack`, `Email`ï¼‰ï¼Œé‚„æ‡‰é¡¯ç¤ºå°æ‡‰æœå‹™çš„å®˜æ–¹åœ–ç¤ºã€‚é€™èƒ½è®“ä½¿ç”¨è€…æ›´å¿«åœ°æƒæå’Œè­˜åˆ¥ç®¡é“é¡å‹ã€‚
4.  **ç¯„æœ¬åŒ–èˆ‡æ¨™æº–åŒ–**ï¼š
    *   æä¾›ã€Œå¾ç¯„æœ¬å»ºç«‹ã€çš„åŠŸèƒ½ã€‚ç®¡ç†å“¡å¯ä»¥é å…ˆè¨­å®šå¥½é©ç”¨æ–¼æ•´å€‹çµ„ç¹”çš„æ¨™æº–ç®¡é“ï¼ˆä¾‹å¦‚ï¼Œä¸€å€‹æŒ‡å‘å…¬å¸æ¨™æº– PagerDuty æœå‹™çš„ç®¡é“ï¼‰ï¼Œæ™®é€šä½¿ç”¨è€…å¯ä»¥ç›´æ¥é¸ç”¨ï¼Œç„¡éœ€é—œå¿ƒå…¶å…·é«”è¨­å®šç´°ç¯€ã€‚

#### é€šçŸ¥æ­·å² [é€šçŸ¥æ­·å²](images/72-é é¢-é€šçŸ¥æ­·å².png)

**åŠŸèƒ½æè¿°**ï¼š
- é€šçŸ¥ç™¼é€æ­·å²è¨˜éŒ„
- é€šçŸ¥çµ±è¨ˆå’ŒæŠ•éç‹€æ…‹
- é€šçŸ¥æ­·å²è¡¨æ ¼ï¼šç™¼é€æ™‚é–“ã€æ¥æ”¶è€…ã€ç®¡é“ã€ç‹€æ…‹ã€ä¸»é¡Œã€å…§å®¹æ‘˜è¦
- æ­·å²è¨˜éŒ„æŸ¥è©¢å’Œéæ¿¾

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/notification-history` - ç²å–é€šçŸ¥æ­·å²
- `GET /api/v1/notification-history/{id}` - ç²å–é€šçŸ¥è©³æƒ…
- `POST /api/v1/notification-history/resend` - é‡æ–°ç™¼é€é€šçŸ¥

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æŠ•éè¿½è¹¤**ï¼šé¡¯ç¤ºé€šçŸ¥çš„å®Œæ•´æŠ•éè·¯å¾‘
2. **å¤±æ•—åˆ†æ**ï¼šåˆ†æé€šçŸ¥å¤±æ•—çš„åŸå› å’Œè§£æ±ºæ–¹æ¡ˆ
3. **æ‰¹é‡é‡ç™¼**ï¼šæ”¯æ´æ‰¹é‡é‡æ–°ç™¼é€å¤±æ•—çš„é€šçŸ¥
4. **çµ±è¨ˆå ±è¡¨**ï¼šç”Ÿæˆé€šçŸ¥æ•ˆæœçµ±è¨ˆå ±è¡¨
5. **å³æ™‚æ›´æ–°**ï¼šæ”¯æ´å¯¦æ™‚é€šçŸ¥ç‹€æ…‹æ›´æ–°

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤é é¢è¨­è¨ˆã€‚é€šçŸ¥æ­·å²æ˜¯å¹³å°**è¶…è¶Š Grafana åŸç”ŸåŠŸèƒ½çš„æ ¸å¿ƒåƒ¹å€¼ä¹‹ä¸€**ã€‚å®ƒå°‡ç„¡ç‹€æ…‹çš„é€šçŸ¥ç™¼é€ï¼Œè½‰åŒ–ç‚ºä¸€å€‹**å¯è¿½è¹¤ã€å¯å¯©è¨ˆã€å¯é™¤éŒ¯**çš„æ­·å²è¨˜éŒ„ã€‚æ­¤åŠŸèƒ½çš„å¯¦ç¾ï¼Œæ˜¯å¹³å°ä½œç‚ºã€Œçµ±ä¸€ç®¡ç†å¹³é¢ã€çš„é—œéµè­‰æ˜ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡è³‡æ–™æµç¨‹**ï¼š
1.  **æ ¸å¿ƒå¼•æ“ - Webhook æ””æˆªå™¨**ï¼š
    *   ç‚ºäº†å»ºç«‹é€™ä»½æ­·å²è¨˜éŒ„ï¼Œå¹³å°**å¿…é ˆ**è¨­å®šä¸€å€‹çµ±ä¸€çš„ Webhook ç«¯é» (e.g., `/api/v1/webhooks/receiver`)ã€‚
    *   åœ¨ Grafana ä¸­ï¼Œ**æ‰€æœ‰**çš„é€šçŸ¥ç®¡é“ (Contact Points) éƒ½**ä¸æ‡‰**ç›´æ¥æŒ‡å‘ Slackã€PagerDuty ç­‰çµ‚ç«¯ï¼Œè€Œæ˜¯**å…¨éƒ¨æŒ‡å‘é€™å€‹å¹³å°çµ±ä¸€çš„ Webhook ç«¯é»**ã€‚
    *   ç•¶å‘Šè­¦è§¸ç™¼æ™‚ï¼ŒGrafana æœƒå°‡ä¸€å€‹åŒ…å«æ‰€æœ‰å‘Šè­¦è³‡è¨Šçš„ Payload ç™¼é€åˆ°é€™å€‹ Webhookã€‚
2.  **éåŒæ­¥è™•ç†èˆ‡å„²å­˜**ï¼š
    *   Webhook ç«¯é»åœ¨æ¥æ”¶åˆ°è«‹æ±‚å¾Œï¼Œæ‡‰åªåšæœ€å°‘çš„é©—è­‰ï¼Œç„¶å¾Œç«‹å³å°‡å®Œæ•´çš„ Payload æ¨é€åˆ°ä¸€å€‹**è¨Šæ¯ä½‡åˆ— (Message Queue)** ä¸­ï¼ˆå¦‚ Redis Streams æˆ– Kafkaï¼‰ï¼Œä¸¦å›å‚³ `200 OK` çµ¦ Grafanaã€‚
    *   ä¸€å€‹ç¨ç«‹çš„**é€šçŸ¥è™•ç†æœå‹™ (Notification Processor)** æœƒæ¶ˆè²»ä½‡åˆ—ä¸­çš„è¨Šæ¯ã€‚å®ƒè² è²¬ï¼š
        a.  è§£æ Payloadï¼Œæå–é—œéµè³‡è¨Šï¼ˆå‘Šè­¦åç¨±ã€æ¨™ç±¤ã€ç›®æ¨™ç®¡é“ç­‰ï¼‰ã€‚
        b.  å°‡ä¸€ç­†åŒ…å« `raw_payload` çš„è¨˜éŒ„å¯«å…¥**å¹³å°è‡ªèº«çš„æ­·å²è³‡æ–™åº«** (`notification_history` è¡¨)ï¼Œåˆå§‹ç‹€æ…‹ç‚º `PENDING`ã€‚
        c.  æ ¹æ“šé€šçŸ¥ç­–ç•¥ï¼Œå°‡é€šçŸ¥è½‰ç™¼åˆ°çœŸæ­£çš„ç›®æ¨™ç®¡é“ï¼ˆå¦‚ Slack APIï¼‰ã€‚
        d.  ç­‰å¾…ç¬¬ä¸‰æ–¹ç®¡é“çš„å›æ‡‰å¾Œï¼Œæ›´æ–°æ­·å²è¨˜éŒ„çš„ç‹€æ…‹ç‚º `SUCCESS` æˆ– `FAILED`ï¼Œä¸¦è¨˜éŒ„éŒ¯èª¤è¨Šæ¯ã€‚
3.  **API è¨­è¨ˆ**ï¼š
    *   `GET /api/v1/notification-history`ï¼šæ­¤ API æ‡‰æŸ¥è©¢å¹³å°è‡ªèº«çš„ `notification_history` è³‡æ–™åº«ï¼Œä¸¦æ”¯æ´åŸºæ–¼ç‹€æ…‹ã€ç®¡é“ã€æ™‚é–“ç¯„åœå’Œé—œéµå­—çš„å¾Œç«¯ç¯©é¸ã€‚
    *   `POST /api/v1/notification-history/{id}/resend`ï¼šæ­¤ API æ‡‰è®€å–æŒ‡å®šæ­·å²è¨˜éŒ„çš„ `raw_payload`ï¼Œä¸¦é‡æ–°å°‡å…¶æ¨é€åˆ°è¨Šæ¯ä½‡åˆ—ä¸­é€²è¡Œè™•ç†ï¼Œå¾è€Œå¯¦ç¾ã€Œé‡æ–°ç™¼é€ã€åŠŸèƒ½ã€‚

**UX/UI å¼·åŒ–å»ºè­°**ï¼š
1.  **ç„¡ç¸«çš„ä¸Šä¸‹æ–‡é‘½å– (Contextual Drill-Down)**ï¼š
    *   è¡¨æ ¼ä¸­çš„ã€Œé—œè¯å‘Šè­¦ã€æ¬„ä½**å¿…é ˆ**æ˜¯ä¸€å€‹è¶…é€£çµã€‚é»æ“Šå¾Œï¼Œæ‡‰åœ¨ä¸€å€‹æŠ½å±œæˆ–å½ˆçª—ä¸­ï¼Œæ‰“é–‹è§¸ç™¼æ­¤é€šçŸ¥çš„**åŸå§‹äº‹ä»¶çš„è©³æƒ…**ã€‚é€™ç‚ºä½¿ç”¨è€…æä¾›äº†å¾ã€Œé€šçŸ¥çµæœã€å›æº¯åˆ°ã€Œå•é¡Œæ ¹æºã€çš„é—œéµè·¯å¾‘ã€‚
2.  **å¼·åŒ–çš„æ—¥èªŒè©³æƒ…**ï¼š
    *   é»æ“Šä»»ä¸€æ­·å²è¨˜éŒ„ï¼Œæ‡‰æ‰“é–‹ä¸€å€‹è©³æƒ…æŠ½å±œ (å¦‚ `images/77...` æ‰€ç¤º)ã€‚
    *   æ­¤æŠ½å±œä¸­ï¼Œå¦‚æœç‹€æ…‹ç‚º `FAILED`ï¼Œ**å¿…é ˆ**æ¸…æ™°åœ°å±•ç¤ºå¾ç¬¬ä¸‰æ–¹ç®¡é“ï¼ˆå¦‚ Slack APIï¼‰è¿”å›çš„**å®Œæ•´éŒ¯èª¤è¨Šæ¯**ï¼Œè€Œä¸åªæ˜¯ä¸€å€‹é€šç”¨çš„ã€Œå¤±æ•—ã€ç‹€æ…‹ã€‚
    *   è©³æƒ…ä¸­æ‡‰åŒ…å«ä¸€å€‹ç¶“éæ ¼å¼åŒ–ã€å¯æ‘ºç–Šã€å¯è¤‡è£½çš„**åŸå§‹ Webhook Payload** å€å¡Šï¼Œé€™å°æ–¼é€²éšé™¤éŒ¯è‡³é—œé‡è¦ã€‚
3.  **æ™ºæ…§åŒ–ç¯©é¸**ï¼š
    *   é™¤äº†ç¾æœ‰çš„ç¯©é¸å™¨ï¼Œæ‡‰å¢åŠ ä¸€å€‹åŸºæ–¼ã€Œ**å‘Šè­¦è¦å‰‡åç¨±**ã€çš„ç¯©é¸å™¨ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å¿«é€ŸæŸ¥çœ‹ç”±æŸä¸€å€‹ç‰¹å®šè¦å‰‡è§¸ç™¼çš„æ‰€æœ‰é€šçŸ¥æ­·å²ã€‚

---

## 8.è¨­å®š-å¹³å°ç®¡ç†

#### æ¨™ç±¤ç®¡ç† [æ¨™ç±¤ç®¡ç†](images/80-é é¢-æ¨™ç±¤ç®¡ç†.png)

*é—œè¯åœ–ç‰‡: [æ–°å¢æ¨™ç±¤](images/83-å½ˆçª—-æ¨™ç±¤ç®¡ç†-æ–°å¢æ¨™ç±¤.png), [ç®¡ç†æ¨™ç±¤å€¼](images/84-å½ˆçª—-æ¨™ç±¤ç®¡ç†-ç®¡ç†æ¨™ç±¤å€¼.png), [ç·¨è¼¯æ¨™ç±¤](images/85-å½ˆçª—-æ¨™ç±¤ç®¡ç†-ç·¨è¼¯æ¨™ç±¤.png)*

**åŠŸèƒ½æè¿°**ï¼š
- ä¸€å€‹é›†ä¸­çš„**æ¨™ç±¤æ²»ç† (Tag Governance)** æ¨¡çµ„ï¼Œç”¨æ–¼å®šç¾©å’Œç®¡ç†æ•´å€‹å¹³å°çš„å…ƒæ•¸æ“šæ¨™æº–ã€‚
- ä¸»é é¢ (80) æä¾›å·²å®šç¾©æ¨™ç±¤çš„åˆ—è¡¨ï¼ŒåŒ…å«å…¶åˆ†é¡ã€å…è¨±çš„å€¼ã€æ˜¯å¦å¿…å¡«ä»¥åŠåœ¨ç³»çµ±ä¸­çš„ä½¿ç”¨æ¬¡æ•¸ã€‚
- å½ˆå‡ºè¦–çª—æ”¯æ´æ¨™ç±¤çš„å®Œæ•´ç”Ÿå‘½é€±æœŸç®¡ç†ï¼š
    - (83) æ–°å¢æ¨™ç±¤ï¼šå®šç¾©ä¸€å€‹æ–°çš„æ¨™ç±¤éµ (key) çš„ç¶±è¦ (schema)ã€‚
    - (85) ç·¨è¼¯æ¨™ç±¤ï¼šä¿®æ”¹æ¨™ç±¤éµçš„ç¶±è¦ã€‚
    - (84) ç®¡ç†æ¨™ç±¤å€¼ï¼šç‚ºä¸€å€‹æ¨™ç±¤éµå®šç¾©ä¸€çµ„é è¨­çš„ã€å…è¨±çš„å€¼ (values)ï¼Œä¸¦å¯ç‚ºæ¯å€‹å€¼æŒ‡å®šé¡è‰²ã€‚

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/tags`: ç²å–æ‰€æœ‰å·²å®šç¾©çš„æ¨™ç±¤ç¶±è¦åˆ—è¡¨ã€‚
- `POST /api/v1/tags`: å»ºç«‹ä¸€å€‹æ–°çš„æ¨™ç±¤ç¶±è¦ã€‚
- `PUT /api/v1/tags/{id}`: æ›´æ–°ä¸€å€‹æ¨™ç±¤ç¶±è¦ã€‚
- `GET /api/v1/tags/{id}/values`: ç²å–æŒ‡å®šæ¨™ç±¤çš„æ‰€æœ‰å…è¨±å€¼ã€‚
- `POST /api/v1/tags/{id}/values`: ç‚ºæŒ‡å®šæ¨™ç±¤æ–°å¢ä¸€å€‹å…è¨±å€¼ã€‚

**UX æ”¹å–„å»ºè­°**ï¼š
1. **æ¨™ç±¤åˆè¦æ€§å ±å‘Š**ï¼šå¢åŠ ä¸€å€‹ã€Œåˆè¦å ±å‘Šã€åˆ†é ï¼Œé¡¯ç¤ºæ‰€æœ‰é•åæ¨™ç±¤è¦å‰‡ï¼ˆå¦‚ç¼ºå°‘å¿…å¡«æ¨™ç±¤ã€ä½¿ç”¨äº†æœªå®šç¾©çš„å€¼ï¼‰çš„è³‡æºåˆ—è¡¨ã€‚
2. **è¦–è¦ºåŒ–ä½¿ç”¨åˆ†ä½ˆ**ï¼šã€Œä½¿ç”¨æ¬¡æ•¸ã€æ‡‰å¯é»æ“Šï¼Œé»æ“Šå¾Œé¡¯ç¤ºè©²æ¨™ç±¤åŠå…¶å€¼çš„è©³ç´°åˆ†ä½ˆåœ–è¡¨å’Œä½¿ç”¨è©²æ¨™ç±¤çš„è³‡æºåˆ—è¡¨ã€‚
3. **è‡ªå‹•åŒ–æ¨™ç±¤å»ºè­°**ï¼šæ•´åˆ AI åŠŸèƒ½ï¼Œæƒæè³‡æºå±¬æ€§ä¸¦è‡ªå‹•å»ºè­°æ‡‰ç”¨çš„æ¨™æº–åŒ–æ¨™ç±¤ï¼ŒåŠ é€Ÿæ¨™ç±¤çš„è½åœ°å’Œæ¨™æº–åŒ–éç¨‹ã€‚

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æ­¤åŠŸèƒ½æ˜¯å¹³å°å¾ä¸€å€‹å–®ç´”çš„ã€Œç›£æ§å·¥å…·ã€æå‡ç‚ºä¸€å€‹ã€Œç‡Ÿé‹æ²»ç†å¹³å°ã€çš„æ ¸å¿ƒã€‚ä¸€å€‹æ··äº‚çš„æ¨™ç±¤ç³»çµ±æœƒè®“å‘Šè­¦è·¯ç”±ã€æˆæœ¬åˆ†æ”¤ã€æ¬Šé™ç®¡ç†ç­‰æ‰€æœ‰ä¸Šå±¤å»ºç¯‰éƒ½ç„¡æ³•æœ‰æ•ˆå»ºç«‹ã€‚å› æ­¤ï¼Œé€™å€‹æ¨¡çµ„çš„å®šä½æ˜¯**å¹³å°å…ƒæ•¸æ“šçš„å–®ä¸€äº‹å¯¦ä¾†æº (SSOT)**ã€‚

**å¾Œç«¯æ¶æ§‹èˆ‡ API è¨­è¨ˆ**ï¼š
1.  **ç¨ç«‹çš„æ•¸æ“šæ¨¡å‹**ï¼šå¾Œç«¯å¿…é ˆæœ‰ç¨ç«‹çš„è³‡æ–™åº«è¡¨ï¼ˆå¦‚ `tags`, `tag_values`ï¼‰ä¾†å„²å­˜é€™äº›æ²»ç†è¦å‰‡ã€‚é€™èˆ‡ç›£æ§ç³»çµ±ä¸­å¯¦éš›å­˜åœ¨çš„æ¨™ç±¤æ˜¯åˆ†é›¢çš„ï¼Œå‰è€…æ˜¯ã€Œè¦ç¯„ã€ï¼Œå¾Œè€…æ˜¯ã€Œç¾å¯¦ã€ã€‚
2.  **æ•¸æ“šé©…å‹•çš„æ™ºæ…§è¼¸å…¥**ï¼šæ­¤æ¨¡çµ„æ˜¯ã€Œç·¨è¼¯é€šçŸ¥ç­–ç•¥ã€ä¸­ã€Œæ™ºæ…§è¼¸å…¥ã€åŠŸèƒ½çš„**æ•¸æ“šä¾†æº**ã€‚ç•¶ä½¿ç”¨è€…åœ¨å…¶ä»–åœ°æ–¹éœ€è¦è¼¸å…¥æ¨™ç±¤æ™‚ï¼Œå‰ç«¯æ‡‰å‘¼å«æ­¤è™•çš„ API (`GET /api/v1/tags/{key}/values`) ä¾†ç²å–ä¸‹æ‹‰é¸å–®æˆ–è‡ªå‹•å®Œæˆçš„é¸é …ã€‚
3.  **éåŒæ­¥çš„åˆ†æä»»å‹™**ï¼š
    *   **ä½¿ç”¨æ¬¡æ•¸è¨ˆç®—**ï¼š`usage_count` æ¬„ä½éœ€è¦ä¸€å€‹**èƒŒæ™¯æ’ç¨‹ä½œæ¥­**ï¼Œå®šæœŸå»æŸ¥è©¢ç›£æ§ç³»çµ±ï¼ˆå¦‚ Prometheus/VictoriaMetrics çš„å…ƒæ•¸æ“š APIï¼‰æˆ–æ—¥èªŒç³»çµ±ï¼Œçµ±è¨ˆå„å€‹æ¨™ç±¤çš„ä½¿ç”¨æƒ…æ³ï¼Œä¸¦å°‡çµæœå¯«å› `tags` è¡¨ã€‚é€™çµ•ä¸èƒ½åœ¨ `GET /api/v1/tags` çš„è«‹æ±‚ä¸­å³æ™‚è¨ˆç®—ã€‚
    *   **åˆè¦æ€§æª¢æŸ¥**ï¼šåŒæ¨£ï¼Œä¸€å€‹èƒŒæ™¯ä½œæ¥­éœ€è¦å®šæœŸå¾ CMDB æˆ–é›²ç«¯ API ç²å–è³‡æºåˆ—è¡¨åŠå…¶æ¨™ç±¤ï¼Œèˆ‡æœ¬æ¨¡çµ„å®šç¾©çš„è¦å‰‡é€²è¡Œæ¯”å°ï¼Œä¸¦å°‡ä¸åˆè¦çš„çµæœå„²å­˜åˆ°ä¸€å¼µ `tag_compliance_violations` è¡¨ä¸­ï¼Œä¾›ã€Œåˆè¦å ±å‘Šã€é é¢æŸ¥è©¢ã€‚

**èˆ‡å…¶ä»–ç³»çµ±çš„æ•´åˆ**ï¼š
- **CMDB åŒæ­¥**ï¼šæ­¤æ¨¡çµ„æ‡‰èƒ½èˆ‡ä¼æ¥­çš„ CMDB é€²è¡Œé›™å‘åŒæ­¥ï¼Œç¢ºä¿æ¨™ç±¤å®šç¾©çš„ä¸€è‡´æ€§ã€‚
- **IaC å·¥å…·æ•´åˆ**ï¼šæä¾› API æˆ–åŒ¯å‡ºåŠŸèƒ½ï¼Œè®“ Terraform/Ansible ç­‰ IaC (Infrastructure as Code) å·¥å…·å¯ä»¥ç›´æ¥æ¶ˆè²»é€™è£¡å®šç¾©çš„æ¨™ç±¤è¦ç¯„ï¼Œå¾æºé ­ä¿è­‰æ–°å»ºè³‡æºçš„æ¨™ç±¤åˆè¦æ€§ã€‚

#### éƒµä»¶è¨­å®š [éƒµä»¶è¨­å®š](images/81-é é¢-éƒµä»¶è¨­å®š.png)

**åŠŸèƒ½æè¿°**ï¼š
- éƒµä»¶ä¼ºæœå™¨é…ç½®ç®¡ç†
- éƒµä»¶ç™¼é€çµ±è¨ˆå’Œç‹€æ…‹ç›£æ§
- SMTP é…ç½®è¡¨å–®ï¼šä¼ºæœå™¨åœ°å€ã€åŸ è™Ÿã€èªè­‰ä¿¡æ¯ã€åŠ å¯†è¨­å®š
- éƒµä»¶æ¸¬è©¦å’Œé…ç½®é©—è­‰

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/settings/email` - ç²å–éƒµä»¶è¨­å®š
- `PUT /api/v1/settings/email` - æ›´æ–°éƒµä»¶è¨­å®š
- `POST /api/v1/settings/email/test` - æ¸¬è©¦éƒµä»¶é…ç½®

**UX æ”¹å–„å»ºè­°**ï¼š
1. **é…ç½®å‘å°**ï¼šæä¾› SMTP é…ç½®çš„é€æ­¥æŒ‡å°
2. **å®‰å…¨æª¢æŸ¥**ï¼šé©—è­‰ SMTP é€£æ¥çš„å®‰å…¨æ€§
3. **ç™¼é€é™åˆ¶**ï¼šé¡¯ç¤ºéƒµä»¶ç™¼é€é™åˆ¶å’Œé…é¡
4. **æ¨¡æ¿é è¦½**ï¼šé è¦½éƒµä»¶æ¨¡æ¿çš„æ•ˆæœ
5. **æ•…éšœæ’é™¤**ï¼šæä¾›å¸¸è¦‹é…ç½®å•é¡Œçš„è§£æ±ºæ–¹æ¡ˆ

#### èº«ä»½é©—è­‰ [èº«ä»½é©—è­‰](images/82-é é¢-èº«ä»½é©—è­‰.png)

**åŠŸèƒ½æè¿°**ï¼š
- ç”¨æˆ¶èªè­‰å’Œæ¬Šé™ç®¡ç†è¨­å®š
- èªè­‰çµ±è¨ˆå’Œå®‰å…¨æ€§æŒ‡æ¨™
- èªè­‰é…ç½®ï¼šå¯†ç¢¼ç­–ç•¥ã€å¤šå› ç´ èªè­‰ã€æœƒè©±ç®¡ç†
- å®‰å…¨æ€§è¨­å®šå’Œåˆè¦æª¢æŸ¥

**ç›¸é—œ API ç«¯é»**ï¼š
- `GET /api/v1/settings/auth` - ç²å–èªè­‰è¨­å®š
- `PUT /api/v1/settings/auth` - æ›´æ–°èªè­‰è¨­å®š
- `GET /api/v1/auth/statistics` - ç²å–èªè­‰çµ±è¨ˆ

**UX æ”¹å–„å»ºè­°**ï¼š
1. **å®‰å…¨æ€§è©•ä¼°**ï¼šé¡¯ç¤ºç•¶å‰å®‰å…¨é…ç½®çš„å®‰å…¨ç­‰ç´š
2. **åˆè¦æª¢æŸ¥**ï¼šæª¢æŸ¥æ˜¯å¦ç¬¦åˆå®‰å…¨æ¨™æº–è¦æ±‚
3. **é¢¨éšªè©•ä¼°**ï¼šåˆ†ææ½›åœ¨çš„å®‰å…¨é¢¨éšª
4. **é…ç½®å»ºè­°**ï¼šæä¾›å®‰å…¨æ€§æœ€ä½³å¯¦è¸å»ºè­°
5. **ç›£æ§å„€è¡¨æ¿**ï¼šé¡¯ç¤ºèªè­‰ç›¸é—œçš„å®‰å…¨æŒ‡æ¨™

---

## 9.å€‹äººè³‡æ–™

### å€‹äººè³‡æ–™

*é—œè¯åœ–ç‰‡: [å€‹äººè³‡è¨Š](images/90-é é¢-å€‹äººè³‡æ–™-å€‹äººè³‡è¨Š.png), [åå¥½è¨­å®š](images/91-é é¢-å€‹äººè³‡æ–™-åå¥½è¨­å®š.png), [å¯†ç¢¼å®‰å…¨](images/92-é é¢-å€‹äººè³‡æ–™-å¯†ç¢¼å®‰å…¨.png)*

**Jules çš„åˆ†æèˆ‡å»ºè­°**ï¼š

æˆ‘å·²å¯©é–±æ­¤å€å¡Šçš„æ‰€æœ‰é é¢ã€‚æ ¹æ“š `docs/architecture.md` ä¸­ã€Œèº«ä»½èªè­‰å§”è¨—çµ¦ Keycloakã€çš„æ ¸å¿ƒåŸå‰‡ï¼Œæ­¤å€å¡Šçš„è¨­è¨ˆå¿…é ˆé€²è¡Œé‡å¤§èª¿æ•´ï¼Œä»¥ç¢ºä¿è·è²¬åˆ†é›¢ï¼Œå°‡èº«ä»½ç®¡ç†å®Œå…¨äº¤ç”± Keycloak è™•ç†ã€‚ç›®å‰çš„ UI è¨­è¨ˆ (åœ–ç‰‡ 90 å’Œ 92) èˆ‡æ­¤æ¶æ§‹å­˜åœ¨ç›´æ¥è¡çªã€‚

---

#### å€‹äººè³‡è¨Š

**åŠŸèƒ½æè¿° (é‡æ§‹å¾Œ)**ï¼š
- **å”¯è®€åœ°**å±•ç¤ºç•¶å‰ç™»å…¥ä½¿ç”¨è€…çš„æ ¸å¿ƒèº«ä»½è³‡è¨Šï¼ˆå§“åã€é›»å­éƒµä»¶ï¼‰ã€‚
- æä¾›ä¸€å€‹æ˜ç¢ºçš„é€£çµï¼Œå¼•å°ä½¿ç”¨è€…åˆ° Keycloak çš„å¸³è™Ÿç®¡ç†ä¸­å¿ƒå»ä¿®æ”¹é€™äº›è³‡è¨Šã€‚

**API è¨­è¨ˆ (é‡æ§‹å¾Œ)**ï¼š
- `GET /api/v1/users/me`: æ­¤ API æ‡‰å¾ä½¿ç”¨è€…è«‹æ±‚ä¸­çš„ JWT (JSON Web Token) çš„å®£å‘Š (claims) ä¸­è§£æå‡º `name` å’Œ `email`ã€‚å¾Œç«¯**ä¸æ‡‰**å¾æœ¬åœ°è³‡æ–™åº«è®€å–é€™äº›è³‡è¨Šã€‚
- **ç§»é™¤** `PUT /api/v1/users/profile` ç«¯é»ï¼Œå› ç‚ºå¹³å°ä¸è² è²¬æ›´æ–°ä½¿ç”¨è€…å€‹äººè³‡æ–™ã€‚

**UX/UI é‡æ–°è¨­è¨ˆ**ï¼š
1.  **æ¬„ä½è®Šæ›´ç‚ºå”¯è®€**ï¼šã€Œå§“åã€å’Œã€Œé›»å­éƒµä»¶ã€çš„è¼¸å…¥æ¡†å¿…é ˆæ”¹ç‚º**ç´”æ–‡å­—é¡¯ç¤º**ï¼Œä¸å¯ç·¨è¼¯ã€‚
2.  **æ“ä½œæŒ‰éˆ•è®Šæ›´ç‚ºé€£çµ**ï¼šç§»é™¤ã€Œæ›´æ–°å€‹äººè³‡è¨Šã€æŒ‰éˆ•ï¼Œæ›¿æ›ç‚ºä¸€å€‹è¶…é€£çµï¼Œæ–‡å­—ç‚ºã€Œ**å‰å¾€ Keycloak ç®¡ç†å€‹äººè³‡æ–™**ã€ã€‚æ­¤é€£çµæ‡‰æŒ‡å‘ Keycloak Account Console çš„ URLã€‚

---

#### åå¥½è¨­å®š

**åŠŸèƒ½æè¿° (ç¬¦åˆæ¶æ§‹)**ï¼š
- ç®¡ç†ä½¿ç”¨è€…åœ¨**æœ¬å¹³å°å…§**çš„å€‹äººåŒ–è¨­å®šï¼Œé€™äº›è¨­å®šèˆ‡å…¶æ ¸å¿ƒèº«ä»½ç„¡é—œã€‚
- ä¾‹å¦‚ï¼šä»‹é¢ä¸»é¡Œã€é è¨­ç™»å…¥é é¢ã€æ™‚å€åå¥½ç­‰ã€‚

**API è¨­è¨ˆ (ç¬¦åˆæ¶æ§‹)**ï¼š
- `GET /api/v1/users/preferences`
- `PUT /api/v1/users/preferences`
- é€™å…©å€‹ API æ‡‰åœ¨å¹³å°è‡ªèº«çš„è³‡æ–™åº«ä¸­è®€å¯«ä¸€å¼µ `user_preferences` è¡¨ï¼Œä¸¦é€éå¾ JWT ä¸­ç²å–çš„ä½¿ç”¨è€… UUID é€²è¡Œé—œè¯ã€‚æ­¤éƒ¨åˆ†çš„è¨­è¨ˆæ˜¯æ­£ç¢ºçš„ã€‚

---

#### å¯†ç¢¼å®‰å…¨

**åŠŸèƒ½æè¿° (é‡æ§‹å¾Œ)**ï¼š
- ä¸æä¾›ä»»ä½•ä¿®æ”¹å¯†ç¢¼çš„è¡¨å–®ã€‚
- æä¾›ä¸€å€‹æ˜ç¢ºçš„é€£çµï¼Œå¼•å°ä½¿ç”¨è€…åˆ° Keycloak å»åŸ·è¡Œæ‰€æœ‰èˆ‡å¯†ç¢¼ç›¸é—œçš„å®‰å…¨æ“ä½œã€‚

**API è¨­è¨ˆ (é‡æ§‹å¾Œ)**ï¼š
- **ç§»é™¤** `POST /api/v1/users/change-password` ç«¯é»ã€‚å¹³å°å¾Œç«¯çµ•ä¸èƒ½è™•ç†ä»»ä½•èˆ‡å¯†ç¢¼ç›¸é—œçš„é‚è¼¯ã€‚

**UX/UI é‡æ–°è¨­è¨ˆ**ï¼š
1.  **ç§»é™¤æ•´å€‹è¡¨å–®**ï¼šå¿…é ˆ**å®Œå…¨ç§»é™¤**ã€Œç›®å‰å¯†ç¢¼ã€ã€ã€Œæ–°å¯†ç¢¼ã€ã€ã€Œç¢ºèªæ–°å¯†ç¢¼ã€ä¸‰å€‹è¼¸å…¥æ¡†ä»¥åŠã€Œæ›´æ–°å¯†ç¢¼ã€æŒ‰éˆ•ã€‚
2.  **æ›¿æ›ç‚ºå¼•å°é€£çµ**ï¼šåœ¨é é¢ä¸Šæ”¾ç½®ä¸€å€‹é†’ç›®çš„æŒ‰éˆ•æˆ–é€£çµï¼Œæ–‡å­—ç‚ºã€Œ**å‰å¾€ Keycloak ä¿®æ”¹å¯†ç¢¼æˆ–è¨­å®š 2FA**ã€ã€‚æ­¤é€£çµæ‡‰å°‡ä½¿ç”¨è€…é‡å®šå‘åˆ° Keycloak Account Console çš„ã€ŒSecurityã€åˆ†é ã€‚

---

## ğŸ”— å°èˆªçµæ§‹

```
SRE å¹³å°
â”œâ”€â”€ ğŸ“‹ äº‹ä»¶ (Incidents) - Tab ç®¡ç† (äº‹ä»¶åˆ—è¡¨ | å‘Šè­¦è¦å‰‡ | éœéŸ³è¦å‰‡)
â”œâ”€â”€ ğŸ’½ è³‡æº (Resources) - Tab ç®¡ç† (è³‡æºåˆ—è¡¨ | è³‡æºç¾¤çµ„)
â”œâ”€â”€ ğŸ“Š å„€è¡¨æ¿ (Dashboards) - Tab ç®¡ç† (è³‡æºç¸½è¦½)
â”œâ”€â”€ ğŸ“ˆ åˆ†æ (Analysis) - Tab ç®¡ç† (å®¹é‡è¦åŠƒ)
â”œâ”€â”€ ğŸ¤– è‡ªå‹•åŒ– (Automation) - Tab ç®¡ç† (è…³æœ¬åº« | æ’ç¨‹ç®¡ç† | åŸ·è¡Œæ—¥èªŒ)
â””â”€â”€ âš™ï¸ è¨­å®š (Settings) [çˆ¶é¸å–® - é è¨­å±•é–‹]
    â”œâ”€â”€ ğŸ‘¥ èº«ä»½èˆ‡å­˜å–ç®¡ç† - Tab ç®¡ç† (äººå“¡ç®¡ç† | åœ˜éšŠç®¡ç† | è§’è‰²ç®¡ç†)
    â”œâ”€â”€ ğŸ“¢ é€šçŸ¥ç®¡ç† - Tab ç®¡ç† (é€šçŸ¥ç®¡é“ | é€šçŸ¥ç­–ç•¥)
    â”œâ”€â”€ âš™ï¸ å¹³å°è¨­å®š - Tab ç®¡ç† (æ¨™ç±¤ç®¡ç† | éƒµä»¶è¨­å®š | èº«ä»½é©—è­‰)
    â””â”€â”€ ğŸ–¥ï¸ å¹³å°ç¶­é‹ - Tab ç®¡ç† (å¹³å°è¨ºæ–· | å¯©è¨ˆæ—¥èªŒ)

```

---

## ğŸ¯ æ¶æ§‹ç‰¹é»

### **è¨­è¨ˆå“²å­¸ - ã€Œåˆ†å±¤èšç„¦ã€èšåˆé«”é©—ã€**:
- **åˆ†å±¤èšç„¦**: å·¦å´ä¸»å°èˆªçš„æ¯å€‹å…¥å£éƒ½å°æ‡‰å–®ä¸€SREå·¥ä½œé ˜åŸŸ
- **èšåˆé«”é©—**: ç­–ç•¥æ€§ä½¿ç”¨Tabé ç±¤ï¼Œå°‡ç›¸é—œæ“ä½œèšåˆåœ¨å–®ä¸€å·¥ä½œå€

### **åˆ†å±¤æ¶æ§‹**:
- **æ¥­å‹™å±¤**: äº‹ä»¶ã€è³‡æºã€åˆ†æã€è‡ªå‹•åŒ– - æ ¸å¿ƒé‹ç‡ŸåŠŸèƒ½
- **ç®¡ç†å±¤**: äººå“¡æ¬Šé™ã€é€šçŸ¥ç®¡ç†ã€å¹³å°è¨­å®š - ç³»çµ±æ²»ç†
- **é‹ç‡Ÿå±¤**: å¹³å°ç¶­é‹ - å¹³å°é‹ç¶­
- **å€‹äººå±¤**: å€‹äººè¨­å®šã€åå¥½é…ç½® - äººå“¡é«”é©—

### **Tab é ç±¤æ¶æ§‹**:
- **äº‹ä»¶ä¸­å¿ƒ**: å‘Šè­¦åˆ—è¡¨ | å‘Šè­¦è¦å‰‡ | éœéŸ³è¦å‰‡
- **è‡ªå‹•åŒ–ä¸­å¿ƒ**: è…³æœ¬åº« | æ’ç¨‹ç®¡ç† | åŸ·è¡Œæ—¥èªŒ
- **æ¬Šé™ä¸­å¿ƒ**: äººå“¡ç®¡ç† | åœ˜éšŠç®¡ç† | è§’è‰²ç®¡ç†
- **å¹³å°è¨­å®š**: æ¨™ç±¤ç®¡ç† | éƒµä»¶è¨­å®š | èº«ä»½é©—è­‰
- **é€šçŸ¥ä¸­å¿ƒ**: é€šçŸ¥ç®¡é“ | é€šçŸ¥ç­–ç•¥
- **å¹³å°é‹ç‡Ÿä¸­å¿ƒ**: å¹³å°è¨ºæ–· | å¯©è¨ˆæ—¥èªŒ
- **å€‹äººè³‡æ–™èˆ‡åå¥½è¨­å®š**: å€‹äººè³‡è¨Š | å¯†ç¢¼å®‰å…¨ | åå¥½è¨­å®š

### **åŠŸèƒ½å®Œæ•´æ€§**:
- **æ ¸å¿ƒåŠŸèƒ½**: 100% å¯¦ç¾ (äº‹ä»¶ã€è³‡æºã€è‡ªå‹•åŒ–)
- **åˆ†æåŠŸèƒ½**: 89% å¯¦ç¾ (8/9å€‹é é¢)
- **ç®¡ç†åŠŸèƒ½**: 100% å¯¦ç¾ (äººå“¡ã€é€šçŸ¥ã€å¹³å°è¨­å®š)
- **å€‹äººåŠŸèƒ½**: 100% å¯¦ç¾ (å€‹äººåŒ–è¨­å®š)

---

## ğŸ¨ UI/UX è¨­è¨ˆåŸå‰‡èˆ‡è¦ç¯„

### æ ¸å¿ƒè¨­è¨ˆåŸå‰‡

1. **ä¸€è‡´æ€§**: æ‰€æœ‰çµ„ä»¶éµå¾ªçµ±ä¸€çš„è¦–è¦ºèªè¨€å’Œäº¤äº’æ¨¡å¼
2. **å¯è¨ªå•æ€§**: æ”¯æ´éµç›¤å°èˆªå’Œå±å¹•é–±è®€å™¨
3. **éŸ¿æ‡‰å¼**: é©æ‡‰ä¸åŒè¢å¹•å°ºå¯¸
4. **æ•ˆèƒ½å„ªåŒ–**: ä½¿ç”¨ React.memo å„ªåŒ–æ¸²æŸ“æ€§èƒ½

### åˆ†å±¤æ¶æ§‹è¨­è¨ˆ

- **æ¥­å‹™å±¤**: äº‹ä»¶ã€è³‡æºã€åˆ†æã€è‡ªå‹•åŒ– - æ ¸å¿ƒé‹ç‡ŸåŠŸèƒ½
- **ç®¡ç†å±¤**: äººå“¡æ¬Šé™ã€é€šçŸ¥ç®¡ç†ã€å¹³å°è¨­å®š - ç³»çµ±æ²»ç†
- **é‹ç‡Ÿå±¤**: å¹³å°ç¶­é‹ - å¹³å°é‹ç¶­
- **å€‹äººå±¤**: å€‹äººè¨­å®šã€åå¥½é…ç½® - äººå“¡é«”é©—

### è¨­è¨ˆç³»çµ±å…ƒä»¶

#### æŒ‰éˆ•è¨­è¨ˆè¦ç¯„
```jsx
// ä¸»è¦æ“ä½œ (æ–°å¢ã€ä¿å­˜ç­‰)
<Button type="primary">ä¸»è¦æ“ä½œ</Button>

// è¡¨æ ¼è¡Œå…§æ“ä½œ
<Button type="text" icon={<Icon />} />

// å±éšªæ“ä½œ (åˆªé™¤ç­‰)
<Button type="text" danger icon={<DeleteOutlined />} />
```

#### Tab é ç±¤è¦ç¯„
```jsx
// æ¨™é¡Œæ ¼å¼: "ä¸­å¿ƒåç¨±"
<Tabs defaultActiveKey="tab1">
  <TabPane tab="åŠŸèƒ½ä¸€" key="tab1">å…§å®¹1</TabPane>
  <TabPane tab="åŠŸèƒ½äºŒ" key="tab2">å…§å®¹2</TabPane>
</Tabs>
```

#### è¡¨æ ¼è¨­è¨ˆè¦ç¯„
```jsx
<Table
  size="small"
  rowSelection={rowSelection}
  columns={optimizedColumns}
  scroll={{ y: 'calc(100vh - 300px)' }}
/>
```

### ğŸ“Š å¹³å°åŠŸèƒ½çµ±è¨ˆ

#### **è·¯ç”±é é¢ç¸½æ•¸**: 7 å€‹
- âœ… **å·²å¯¦ç¾**: 7 å€‹ (100%)
- ğŸ”„ **åŠŸèƒ½å®Œå–„ä¸­**: éƒ¨åˆ†é é¢çš„å­åŠŸèƒ½

#### **ä¸»è¦åŠŸèƒ½å€å¡Š** (Tab æ•´åˆæ¶æ§‹):
1. **å„€è¡¨æ¿**: 1 å€‹è·¯ç”±é é¢ (å¤šå€‹å„€è¡¨æ¿è¦–åœ–)
2. **äº‹ä»¶ç®¡ç†**: 1 å€‹è·¯ç”±é é¢ (3 å€‹ Tab: äº‹ä»¶åˆ—è¡¨ã€è¦å‰‡ç®¡ç†ã€éœéŸ³è¦å‰‡)
3. **è³‡æºç®¡ç†**: 1 å€‹è·¯ç”±é é¢ (2 å€‹ Tab: è³‡æºåˆ—è¡¨ã€è³‡æºç¾¤çµ„)
4. **åˆ†æ**: 1 å€‹è·¯ç”±é é¢ (å®¹é‡è¦åŠƒç­‰åˆ†æåŠŸèƒ½)
5. **è‡ªå‹•åŒ–**: 1 å€‹è·¯ç”±é é¢ (3 å€‹ Tab: è…³æœ¬åº«ã€æ’ç¨‹ç®¡ç†ã€åŸ·è¡Œæ—¥èªŒ)
6. **ç³»çµ±ç®¡ç†**: 1 å€‹è·¯ç”±é é¢ (å¤šå€‹ç®¡ç† Tab)
7. **å€‹äººä¸­å¿ƒ**: 1 å€‹è·¯ç”±é é¢ (å€‹äººè¨­å®šç›¸é—œ)

#### **Tab é ç±¤çµ±è¨ˆ**:
- **äº‹ä»¶ä¸­å¿ƒ**: 2 å€‹ Tab (å»é™¤å‘Šè­¦åˆ—è¡¨)
- **è‡ªå‹•åŒ–ä¸­å¿ƒ**: 3 å€‹ Tab
- **æ¬Šé™ä¸­å¿ƒ**: 3 å€‹ Tab
- **é€šçŸ¥ä¸­å¿ƒ**: 2 å€‹ Tab
- **å¹³å°é‹ç‡Ÿä¸­å¿ƒ**: 2 å€‹ Tab
- **å€‹äººè³‡æ–™**: 3 å€‹ Tab

#### **äººå“¡è§’è‰²æ¬Šé™**:
- **è¶…ç´šç®¡ç†å“¡**: å…¨éƒ¨åŠŸèƒ½è¨ªå•
- **åœ˜éšŠç®¡ç†å“¡**: å¤§éƒ¨åˆ†åŠŸèƒ½ (é™¤äººå“¡ç®¡ç†)
- **åœ˜éšŠæˆå“¡**: åŸºæœ¬åŠŸèƒ½ (è³‡æºã€äº‹ä»¶ã€è‡ªå‹•åŒ–)

#### **æœ€æ–°æ›´æ–°** ğŸ“…:
- **æ™‚é–“ç¯„åœç¯©é¸åŠŸèƒ½**: é€šçŸ¥æ­·å²é é¢å’ŒåŸ·è¡Œæ—¥èªŒé é¢æ·»åŠ æ™‚é–“ç¯„åœç¯©é¸åŠŸèƒ½
- **å´é‚Šé¸å–®å„ªåŒ–**: è¨­å®šçˆ¶é¸å–®é è¨­å±•é–‹ï¼Œæå‡äººå“¡é«”é©—
- **UI åŠŸèƒ½å¢å¼·**: å¤šå€‹é é¢å·¥å…·æ¬„åŠŸèƒ½å®Œå–„ï¼ŒåŒ…å«æ™‚é–“ç¯„åœé¸æ“‡å™¨
- **å„€è¡¨æ¿æ¨¡çµ„æ–°å¢**: æ–°å¢å„€è¡¨æ¿ä¸»é é¢ï¼Œè³‡æºç¸½è¦½ä½œç‚ºå­é é¢
- **è³‡è¨Šæ¶æ§‹é‡æ§‹**: å„€è¡¨æ¿æå‡ç‚ºé ‚ç´šæ¨¡çµ„ï¼Œæä¾›å…¨å±€é‹ç‡Ÿè¦–é‡
- **è³‡æºç®¡ç†å„ªåŒ–**: ç§»é™¤è³‡æºç®¡ç†é ç±¤ä¸­çš„è³‡æºç¸½è¦½ï¼Œå¯¦ç¾åŠŸèƒ½åˆ†é›¢
- **äº‹ä»¶ç®¡ç†å„ªåŒ–**: ç§»é™¤å‘Šè­¦åˆ—è¡¨é ç±¤ï¼Œç°¡åŒ–äº‹ä»¶ç®¡ç†æµç¨‹
- **Tab é ç±¤æ¶æ§‹**: å…¨é¢æ¡ç”¨èšåˆé«”é©—è¨­è¨ˆ
- **å¯¦ç¾ç‡æå‡**: å¾77%æå‡åˆ°77%ï¼Œé é¢çµæ§‹æ›´åŠ ç²¾ç°¡

### å¾…å„ªåŒ–å»ºè­°æ¸…å–®

#### é«˜å„ªå…ˆç´šæ”¹é€²ï¼ˆç«‹å³å¯¦æ–½ï¼‰

##### 1. è¨­è¨ˆç³»çµ±å®Œå–„
- **è‰²å½©ç³»çµ±å„ªåŒ–**: å¼·åŒ–èªæ„è‰²å½©å’Œç‹€æ…‹è‰²å½©ç´°åˆ†
- **å‹•æ•ˆç³»çµ±å»ºç«‹**: çµ±ä¸€å‹•æ•ˆæ™‚é•·å’Œç·©å‹•å‡½æ•¸
- **åœ–ç¤ºç³»çµ±çµ±ä¸€**: å»ºç«‹çµ±ä¸€çš„åœ–ç¤ºä½¿ç”¨è¦ç¯„

##### 2. äº’å‹•é«”é©—å„ªåŒ–
- **éµç›¤å¿«æ·éµç³»çµ±**: å¯¦ç¾å…¨åŸŸå’Œé é¢ç´šå¿«æ·éµ
- **æ·±è‰²/æ·ºè‰²ä¸»é¡Œåˆ‡æ›**: å®Œå–„ä¸»é¡Œåˆ‡æ›åŠŸèƒ½
- **è¼‰å…¥ç‹€æ…‹å„ªåŒ–**: çµ±ä¸€Skeletonå’ŒSpinçš„ä½¿ç”¨è¦ç¯„

##### 3. åŠŸèƒ½å¢å¼·
- **å…ƒä»¶åº«æ–‡æª”**: å»ºç«‹å®Œæ•´çš„ä½¿ç”¨æŒ‡å—å’Œç¯„ä¾‹
- **ç©ºç‹€æ…‹è¨­è¨ˆçµ±ä¸€**: è¨­è¨ˆçµ±ä¸€çš„ç©ºç‹€æ…‹ä»‹é¢
- **éŒ¯èª¤è™•ç†å„ªåŒ–**: çµ±ä¸€éŒ¯èª¤æç¤ºå’Œæ¢å¾©æ©Ÿåˆ¶

#### ä¸­å„ªå…ˆç´šæ”¹é€²ï¼ˆ2é€±å…§ï¼‰

##### 1. è¡¨å–®é«”é©—å„ªåŒ–
- **è¡¨å–®è‡ªå‹•å„²å­˜è‰ç¨¿**: å¯¦ç¾è¡¨å–®è‰ç¨¿è‡ªå‹•å„²å­˜
- **å¤šæ­¥é©Ÿè¡¨å–®é«”é©—**: å„ªåŒ–ç²¾éˆå¼è¡¨å–®çš„å°èˆªå’Œé©—è­‰
- **è¡¨å–®é©—è­‰è¦–è¦ºåé¥‹**: å¢å¼·è¡¨å–®é©—è­‰çš„è¦–è¦ºæç¤º

##### 2. åœ–è¡¨äº’å‹•å„ªåŒ–
- **åœ–è¡¨é…è‰²æ–¹æ¡ˆçµ±ä¸€**: å»ºç«‹çµ±ä¸€çš„åœ–è¡¨è‰²å½©ç³»çµ±
- **åœ–è¡¨è¼‰å…¥å‹•ç•«**: å„ªåŒ–åœ–è¡¨è¼‰å…¥é«”é©—
- **åœ–è¡¨åŒ¯å‡ºåŠŸèƒ½**: æ”¯æ´åœ–è¡¨è³‡æ–™åŒ¯å‡º

##### 3. æ•ˆèƒ½å„ªåŒ–
- **è™›æ“¬æ»¾å‹•å¯¦ç¾**: é‡å°å¤§è³‡æ–™é‡è¡¨æ ¼å¯¦ç¾è™›æ“¬æ»¾å‹•
- **å…ƒä»¶æ¸²æŸ“å„ªåŒ–**: ä½¿ç”¨React.memoå’ŒuseMemoå„ªåŒ–æ€§èƒ½
- **åœ–ç‰‡æ‡¶è¼‰å…¥**: å¯¦ç¾åœ–ç‰‡å’Œé‡è³‡æºçš„æ‡¶è¼‰å…¥

#### ä½å„ªå…ˆç´šæ”¹é€²ï¼ˆ1æœˆå…§ï¼‰

##### 1. é€²éšåŠŸèƒ½
- **å€‹äººåŒ–è¨­å®šå„²å­˜**: ç”¨æˆ¶åå¥½è¨­å®šæŒä¹…åŒ–
- **åœ‹éš›åŒ–æº–å‚™**: å»ºç«‹å¤šèªè¨€æ”¯æ´æ¶æ§‹
- **å¯åŠæ€§æå‡**: å¢å¼·è¢å¹•é–±è®€å™¨æ”¯æ´

##### 2. é–‹ç™¼é«”é©—
- **è¨­è¨ˆç³»çµ±ç¶²ç«™**: å»ºç«‹ç·šä¸Šå…ƒä»¶å±•ç¤ºå’Œæ–‡æª”
- **è‡ªå‹•åŒ–UIæ¸¬è©¦**: å¯¦ç¾UIå…ƒä»¶è‡ªå‹•åŒ–æ¸¬è©¦
- **æ•ˆèƒ½ç›£æ§**: å»ºç«‹UIæ•ˆèƒ½ç›£æ§æ©Ÿåˆ¶

### å¯¦æ–½é€²åº¦è¿½è¹¤

#### å·²å®Œæˆ âœ…
- PlatformButton å’Œ PlatformModal å…ƒä»¶å»ºç«‹
- æ™ºèƒ½è¼¸å…¥åŠŸèƒ½å¯¦ç¾
- è¡¨æ ¼å¯†åº¦ç³»çµ±å¯¦ç¾
- Modal æ¨™æº–åŒ–é…ç½®
- éŸ¿æ‡‰å¼è¨­è¨ˆå¯¦ç¾
- æ¨¡æ“¬è³‡æ–™çœŸå¯¦æ€§æå‡

#### é€²è¡Œä¸­ ğŸ”„
- è¨­è¨ˆç³»çµ±è‰²å½©å„ªåŒ–
- å‹•æ•ˆç³»çµ±å»ºç«‹
- éµç›¤å¿«æ·éµå¯¦ç¾

#### å¾…å¯¦æ–½ ğŸ“‹
- è¡¨å–®è‡ªå‹•å„²å­˜è‰ç¨¿
- è™›æ“¬æ»¾å‹•å„ªåŒ–
- å€‹äººåŒ–è¨­å®šå„²å­˜
- åœ‹éš›åŒ–åŸºç¤è¨­æ–½

---

## ğŸš€ ç™¼å±•å»ºè­°

### **å„ªå…ˆå¯¦ç¾ (Phase 1)**:
1. **Tab é ç±¤å¯¦ç¾**: å°‡ç¾æœ‰é é¢é‡æ§‹æˆTabæ¶æ§‹
2. **æ‰¹æ¬¡æ“ä½œåŠŸèƒ½**: å¯¦ç¾å‘Šè­¦å’Œè³‡æºåˆ—è¡¨çš„æ‰¹æ¬¡è™•ç†
3. **å°å‡ºåŠŸèƒ½**: æ·»åŠ æ•¸æ“šå°å‡ºèƒ½åŠ›
4. **æŒ‰éˆ•è¦ç¯„åŒ–**: çµ±ä¸€æ‰€æœ‰æ“ä½œæŒ‰éˆ•çš„æ¨£å¼å’Œåœ–ç¤º

### **åŠŸèƒ½å¢å¼· (Phase 2)**:
1. **ç§»å‹•ç«¯å„ªåŒ–**: éŸ¿æ‡‰å¼è¨­è¨ˆå’Œè§¸æ‘¸å‹å¥½ç•Œé¢
2. **æ€§èƒ½å„ªåŒ–**: åœ–è¡¨æ¸²æŸ“å„ªåŒ–å’Œæ•¸æ“šåŠ è¼‰å„ªåŒ–
3. **äººå“¡é«”é©—**: åŠ è¼‰ç‹€æ…‹ã€é€²åº¦æŒ‡ç¤ºå™¨ã€ç©ºç‹€æ…‹è™•ç†

### **æ¶æ§‹æ“´å±• (Phase 3)**:
1. **API ç®¡ç†**: RESTful API æ–‡æª”å’Œæ¸¬è©¦å·¥å…·æ•´åˆ
2. **æ—¥èªŒç®¡ç†**: é›†ä¸­å¼æ—¥èªŒæ”¶é›†å’Œåˆ†æç³»çµ±
3. **ç½é›£æ¢å¾©**: é«˜å¯ç”¨æ€§å’Œæ•¸æ“šå‚™ä»½ç­–ç•¥

### **æŠ€è¡“å„ªåŒ–**:
1. **å…ƒä»¶æŠ½è±¡**: å»ºç«‹é€šç”¨å…ƒä»¶åº« (ActionButton, BatchActionBarç­‰)
2. **è¨­è¨ˆç³»çµ±**: çµ±ä¸€çš„é¡è‰²ã€é–“è·ã€å­—é«”è¦ç¯„
3. **ä»£ç¢¼é‡æ§‹**: æ¸…ç†é‡è¤‡ä»£ç¢¼ï¼Œæå‡ç¶­è­·æ€§

---

## ğŸ“ˆ å¯¦æ–½é€²åº¦è¿½è¹¤

### **å·²å®Œæˆ âœ…**:
- **è³‡è¨Šæ¶æ§‹è¨­è¨ˆ**: åˆ†å±¤èšç„¦ã€èšåˆé«”é©—çš„è¨­è¨ˆå“²å­¸
- **ç¶²ç«™åœ°åœ–é‡æ§‹**: å®Œæ•´çš„Tabé ç±¤æ¶æ§‹å’Œå°èˆªçµæ§‹
- **åŠŸèƒ½çµ±è¨ˆæ›´æ–°**: æ¡ç”¨ Tab æ•´åˆæ¶æ§‹ï¼Œ7 å€‹è·¯ç”±é é¢å…¨éƒ¨å¯¦ç¾ï¼Œå¯¦ç¾ç‡ 100%

### **é€²è¡Œä¸­ ğŸ”„**:
- **ä»£ç¢¼é‡æ§‹ä»»å‹™**: 7å€‹æ ¸å¿ƒå„ªåŒ–ä»»å‹™çš„è¦åŠƒå’Œæº–å‚™
- **è¨­è¨ˆè¦ç¯„å»ºç«‹**: æ“ä½œæŒ‰éˆ•å’Œåœ–ç¤ºçš„çµ±ä¸€æ¨™æº–

### **å¾…å¯¦æ–½ ğŸ“‹**:
- **å…·é«”åŠŸèƒ½å¯¦ç¾**: Tabé ç±¤ã€æ‰¹æ¬¡æ“ä½œã€å°å‡ºåŠŸèƒ½ç­‰
- **äººå“¡é«”é©—å„ªåŒ–**: è¼‰å…¥ç‹€æ…‹ã€éŒ¯èª¤è™•ç†ã€ç©ºç‹€æ…‹ç­‰
- **æ€§èƒ½å’Œå¯ç¶­è­·æ€§**: ä»£ç¢¼é‡æ§‹ã€å…ƒä»¶æŠ½è±¡ç­‰

---

## ğŸ¨ è¨­è¨ˆè¦ç¯„ç¸½çµ

### **æŒ‰éˆ•è¨­è¨ˆè¦ç¯„**:
```jsx
// ä¸»è¦æ“ä½œ (æ–°å¢ã€ä¿å­˜ç­‰)
<Button type="primary">ä¸»è¦æ“ä½œ</Button>

// è¡¨æ ¼è¡Œå…§æ“ä½œ
<Button type="text" icon={<Icon />} />

// å±éšªæ“ä½œ (åˆªé™¤ç­‰)
<Button type="text" danger icon={<DeleteOutlined />} />
```

### **Tab é ç±¤è¦ç¯„**:
```jsx
// æ¨™é¡Œæ ¼å¼: "ä¸­å¿ƒåç¨±"
<Tabs defaultActiveKey="tab1">
  <TabPane tab="åŠŸèƒ½ä¸€" key="tab1">å…§å®¹1</TabPane>
  <TabPane tab="åŠŸèƒ½äºŒ" key="tab2">å…§å®¹2</TabPane>
</Tabs>
```

### **è¡¨æ ¼è¨­è¨ˆè¦ç¯„**:
```jsx
<Table
  size="small"
  rowSelection={rowSelection}
  columns={optimizedColumns}
  scroll={{ y: 'calc(100vh - 300px)' }}
/>
```

---

*æ›´æ–°æ™‚é–“: 2025å¹´æ™‚é–“ç¯„åœç¯©é¸èˆ‡é¸å–®å„ªåŒ– | å¯¦ç¾ç‡: 78% | è¨­è¨ˆå“²å­¸: åˆ†å±¤èšç„¦ã€èšåˆé«”é©—* ğŸŒŸ